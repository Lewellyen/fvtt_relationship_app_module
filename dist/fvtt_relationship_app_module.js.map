{"version":3,"file":"fvtt_relationship_app_module.js","sources":["../src/polyfills/cytoscape-assign-fix.ts","../src/constants.ts","../src/utils/result.ts","../src/di_infrastructure/tokenutilities.ts","../src/foundry/foundrytokens.ts","../src/tokens/tokenindex.ts","../src/di_infrastructure/types/api-safe-token.ts","../src/di_infrastructure/types/servicelifecycle.ts","../src/di_infrastructure/types/serviceregistration.ts","../src/di_infrastructure/registry/ServiceRegistry.ts","../src/di_infrastructure/validation/ContainerValidator.ts","../src/di_infrastructure/cache/InstanceCache.ts","../src/observability/metrics-collector.ts","../src/config/environment.ts","../src/di_infrastructure/resolution/ServiceResolver.ts","../src/di_infrastructure/scope/ScopeManager.ts","../src/di_infrastructure/container.ts","../src/services/consolelogger.ts","../node_modules/valibot/dist/index.js","../src/foundry/errors/FoundryErrors.ts","../src/foundry/validation/schemas.ts","../src/services/JournalVisibilityService.ts","../src/foundry/versioning/versiondetector.ts","../src/core/performance-constants.ts","../src/foundry/versioning/portselector.ts","../src/foundry/versioning/portregistry.ts","../src/foundry/services/FoundryGameService.ts","../src/foundry/services/FoundryHooksService.ts","../src/foundry/services/FoundryDocumentService.ts","../src/foundry/services/FoundryUIService.ts","../src/foundry/services/FoundrySettingsService.ts","../src/foundry/validation/input-validators.ts","../src/foundry/ports/v13/FoundryGamePort.ts","../src/foundry/ports/v13/FoundryHooksPort.ts","../src/foundry/ports/v13/FoundryDocumentPort.ts","../src/foundry/ports/v13/FoundryUIPort.ts","../src/foundry/ports/v13/FoundrySettingsPort.ts","../src/config/dependencyconfig.ts","../src/core/composition-root.ts","../src/core/module-hook-registrar.ts","../src/core/module-settings-registrar.ts","../src/core/bootstrap-error-handler.ts","../src/core/init-solid.ts"],"sourcesContent":["/**\r\n * Polyfill f√ºr Cytoscape: Object.assign readonly 'equals' fix\r\n *\r\n * ‚ö†Ô∏è WICHTIG: Dieser Polyfill ist ein Legacy-Patch f√ºr die Cytoscape-Bibliothek.\r\n * NIEMALS √ÑNDERN - k√∂nnte das Verhalten der Cytoscape-Integration beeintr√§chtigen.\r\n */\r\n/* c8 ignore file -- Legacy polyfill, schwer testbar ohne Browser-Integration */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// Legacy polyfill: `any` required for low-level Object.assign patching\r\n\r\n// Patch Object.assign only once and keep original semantics wherever possible\r\nconst originalAssignRef = Object.assign as any;\r\nif (!(originalAssignRef && originalAssignRef.__cy_careful_patch)) {\r\n  const patched = function (target: any, ...sources: any[]) {\r\n    const filteredSources = sources.map((source) => {\r\n      if (source == null) return source;\r\n      // Create a shallow copy excluding the problematic 'equals' key\r\n      const out: any = {};\r\n      for (const key in source) {\r\n        if (Object.prototype.hasOwnProperty.call(source, key) && key !== \"equals\") {\r\n          out[key] = (source as any)[key];\r\n        }\r\n      }\r\n      return out;\r\n    });\r\n    try {\r\n      return originalAssignRef(target, ...filteredSources);\r\n    } catch {\r\n      // Fallback to naive assignment filtering readonly errors\r\n      for (const src of filteredSources) {\r\n        if (src != null) {\r\n          for (const k in src) {\r\n            try {\r\n              (target as any)[k] = (src as any)[k];\r\n            } catch {}\r\n          }\r\n        }\r\n      }\r\n      return target;\r\n    }\r\n  } as typeof Object.assign & { __cy_careful_patch?: boolean };\r\n  (patched as any).__cy_careful_patch = true;\r\n  Object.assign = patched as any;\r\n}\r\n","/**\r\n * Module-wide constants for the Foundry VTT Relationship App Module.\r\n * Contains metadata and configuration values used throughout the application.\r\n *\r\n * @constant\r\n *\r\n * @note ENCODING REQUIREMENT\r\n * All source files in this project MUST be saved as UTF-8 without BOM.\r\n * This ensures proper display of German text (√§, √∂, √º, √ü) and prevents mojibake.\r\n * Configure your editor to use UTF-8 encoding for all .ts, .js, and .svelte files.\r\n */\r\n/* c8 ignore file -- Reine Konstanten-Definition, keine ausf√ºhrbare Logik */\r\nexport const MODULE_CONSTANTS = {\r\n  MODULE: {\r\n    ID: \"fvtt_relationship_app_module\",\r\n    NAME: \"Beziehungsnetzwerke f√ºr Foundry\",\r\n    AUTHOR: \"Andreas Rothe\",\r\n    AUTHOR_EMAIL: \"forenadmin.tir@gmail.com\",\r\n    AUTHOR_DISCORD: \"lewellyen\",\r\n  },\r\n  LOG_PREFIX: \"Foundry VTT Relationship App Module |\",\r\n  FLAGS: {\r\n    HIDDEN: \"hidden\",\r\n  },\r\n  HOOKS: {\r\n    RENDER_JOURNAL_DIRECTORY: \"renderJournalDirectory\",\r\n    INIT: \"init\",\r\n    READY: \"ready\",\r\n  },\r\n  SETTINGS: {\r\n    LOG_LEVEL: \"logLevel\",\r\n  },\r\n  DEFAULTS: {\r\n    UNKNOWN_NAME: \"Unknown\",\r\n    NO_VERSION_SELECTED: -1,\r\n    CACHE_NOT_INITIALIZED: -1,\r\n    CACHE_TTL_MS: 5000,\r\n  },\r\n} as const;\r\n","/**\r\n * Utility functions for working with the Result pattern.\r\n * Provides functional error handling with type safety.\r\n *\r\n * This module contains only runtime functions - types are imported from \"../types/result\"\r\n */\r\nimport type { Ok, Err, Result, AsyncResult } from \"../types/result\";\r\n\r\n/**\r\n * Creates a successful Result with a value.\r\n *\r\n * @template SuccessType - The type of the successful value\r\n * @param value - The successful value to wrap\r\n * @returns A Result indicating success with the provided value\r\n *\r\n * @example\r\n * ```typescript\r\n * const success = ok(42);\r\n * // { ok: true, value: 42 }\r\n * ```\r\n */\r\nexport function ok<SuccessType>(value: SuccessType): Ok<SuccessType> {\r\n  return { ok: true, value };\r\n}\r\n\r\n/**\r\n * Creates an error Result with an error value.\r\n *\r\n * @template ErrorType - The type of the error value\r\n * @param error - The error to wrap\r\n * @returns A Result indicating failure with the provided error\r\n *\r\n * @example\r\n * ```typescript\r\n * const failure = err(\"Not found\");\r\n * // { ok: false, error: \"Not found\" }\r\n * ```\r\n */\r\nexport function err<ErrorType>(error: ErrorType): Err<ErrorType> {\r\n  return { ok: false, error };\r\n}\r\n\r\n/**\r\n * Type guard to check if a Result is successful.\r\n *\r\n * @template SuccessType - The type of the successful value\r\n * @template ErrorType - The type of the error value\r\n * @param result - The Result to check\r\n * @returns True if the Result is successful, narrowing the type to Ok<SuccessType>\r\n *\r\n * @example\r\n * ```typescript\r\n * const result = someOperation();\r\n * if (isOk(result)) {\r\n *   console.log(result.value); // Type-safe access to value\r\n * }\r\n * ```\r\n */\r\nexport function isOk<SuccessType, ErrorType>(\r\n  result: Result<SuccessType, ErrorType>\r\n): result is Ok<SuccessType> {\r\n  return result.ok;\r\n}\r\n\r\n/**\r\n * Type guard to check if a Result is an error.\r\n *\r\n * @template SuccessType - The type of the successful value\r\n * @template ErrorType - The type of the error value\r\n * @param result - The Result to check\r\n * @returns True if the Result is an error, narrowing the type to Err<ErrorType>\r\n *\r\n * @example\r\n * ```typescript\r\n * const result = someOperation();\r\n * if (isErr(result)) {\r\n *   console.error(result.error); // Type-safe access to error\r\n * }\r\n * ```\r\n */\r\nexport function isErr<SuccessType, ErrorType>(\r\n  result: Result<SuccessType, ErrorType>\r\n): result is Err<ErrorType> {\r\n  return !result.ok;\r\n}\r\n\r\n/**\r\n * Transforms the value of a successful Result.\r\n * If the Result is an error, it is returned unchanged.\r\n *\r\n * @template SuccessType - The current success type\r\n * @template NewSuccessType - The new success type after transformation\r\n * @template ErrorType - The error type\r\n * @param result - The Result to transform\r\n * @param transform - Function to transform the success value\r\n * @returns A new Result with the transformed value, or the original error\r\n *\r\n * @example\r\n * ```typescript\r\n * const num = ok(5);\r\n * const doubled = map(num, x => x * 2);\r\n * // { ok: true, value: 10 }\r\n * ```\r\n */\r\nexport function map<SuccessType, NewSuccessType, ErrorType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  transform: (value: SuccessType) => NewSuccessType\r\n): Result<NewSuccessType, ErrorType> {\r\n  return result.ok ? ok(transform(result.value)) : result;\r\n}\r\n\r\n/**\r\n * Transforms the error of a failed Result.\r\n * If the Result is successful, it is returned unchanged.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The current error type\r\n * @template NewErrorType - The new error type after transformation\r\n * @param result - The Result to transform\r\n * @param transform - Function to transform the error value\r\n * @returns A new Result with the transformed error, or the original success\r\n *\r\n * @example\r\n * ```typescript\r\n * const failure = err(\"404\");\r\n * const formatted = mapError(failure, msg => `Error: ${msg}`);\r\n * // { ok: false, error: \"Error: 404\" }\r\n * ```\r\n */\r\nexport function mapError<SuccessType, ErrorType, NewErrorType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  transform: (error: ErrorType) => NewErrorType\r\n): Result<SuccessType, NewErrorType> {\r\n  return result.ok ? result : err(transform(result.error));\r\n}\r\n\r\n/**\r\n * Chains Result operations. If the Result is successful, applies the function to the value.\r\n * Otherwise, returns the error unchanged. This is also known as \"flatMap\" or \"bind\".\r\n *\r\n * @template SuccessType - The current success type\r\n * @template ErrorType - The error type\r\n * @template NextSuccessType - The next success type after chaining\r\n * @param result - The Result to chain\r\n * @param next - Function that returns a new Result from the success value\r\n * @returns The next Result, or the original error\r\n *\r\n * @example\r\n * ```typescript\r\n * const parseNumber = (str: string): Result<number, string> => {\r\n *   const num = parseInt(str);\r\n *   return isNaN(num) ? err(\"Invalid number\") : ok(num);\r\n * };\r\n *\r\n * const doubled = ok(\"5\").pipe(parseNumber).pipe(x => ok(x * 2));\r\n * ```\r\n */\r\nexport function andThen<SuccessType, ErrorType, NextSuccessType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  next: (value: SuccessType) => Result<NextSuccessType, ErrorType>\r\n): Result<NextSuccessType, ErrorType> {\r\n  return result.ok ? next(result.value) : result;\r\n}\r\n\r\n/**\r\n * Unwraps a successful Result or returns a fallback value if it's an error.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param result - The Result to unwrap\r\n * @param fallbackValue - The value to return if the Result is an error\r\n * @returns The success value, or the fallback value\r\n *\r\n * @example\r\n * ```typescript\r\n * const num = ok(42);\r\n * unwrapOr(num, 0); // 42\r\n *\r\n * const err = err(\"Failed\");\r\n * unwrapOr(err, 0); // 0\r\n * ```\r\n */\r\nexport function unwrapOr<SuccessType, ErrorType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  fallbackValue: SuccessType\r\n): SuccessType {\r\n  return result.ok ? result.value : fallbackValue;\r\n}\r\n\r\n/**\r\n * Unwraps a successful Result or computes a fallback value from the error.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param result - The Result to unwrap\r\n * @param getFallback - Function that computes a fallback from the error\r\n * @returns The success value, or the computed fallback value\r\n *\r\n * @example\r\n * ```typescript\r\n * const num = err(\"Not found\");\r\n * unwrapOrElse(num, error => 0); // 0\r\n * ```\r\n */\r\nexport function unwrapOrElse<SuccessType, ErrorType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  getFallback: (error: ErrorType) => SuccessType\r\n): SuccessType {\r\n  return result.ok ? result.value : getFallback(result.error);\r\n}\r\n\r\n/**\r\n * Unwraps a successful Result or throws an error if it's a failure.\r\n * Use with caution - this defeats the purpose of using Result pattern.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @template ThrownError - The type of error to throw (must extend Error)\r\n * @param result - The Result to unwrap\r\n * @param toError - Optional function to convert the error to a thrown Error\r\n * @returns The success value\r\n * @throws ThrownError if the Result is an error\r\n *\r\n * @example\r\n * ```typescript\r\n * const num = ok(42);\r\n * getOrThrow(num); // 42\r\n *\r\n * const failure = err(\"Not found\");\r\n * getOrThrow(failure); // throws Error(\"Not found\")\r\n * ```\r\n */\r\nexport function getOrThrow<SuccessType, ErrorType, ThrownError extends Error = Error>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  toError?: (error: ErrorType) => ThrownError\r\n): SuccessType {\r\n  if (result.ok) return result.value;\r\n  const e = toError ? toError(result.error) : (new Error(String(result.error)) as ThrownError);\r\n  throw e;\r\n}\r\n\r\n/**\r\n * Executes a function and wraps the result in a Result, catching any thrown errors.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param fn - The function to execute\r\n * @param mapUnknownError - Function to convert caught errors to the ErrorType\r\n * @returns A Result containing either the return value or the caught error\r\n *\r\n * @example\r\n * ```typescript\r\n * const parsed = tryCatch(\r\n *   () => JSON.parse(\"{ invalid json\"),\r\n *   (e) => `Parse error: ${e}`\r\n * );\r\n * // { ok: false, error: \"Parse error: ...\" }\r\n * ```\r\n */\r\nexport function tryCatch<SuccessType, ErrorType>(\r\n  fn: () => SuccessType,\r\n  mapUnknownError: (unknownError: unknown) => ErrorType\r\n): Result<SuccessType, ErrorType> {\r\n  try {\r\n    return ok(fn());\r\n  } catch (unknownError) {\r\n    return err(mapUnknownError(unknownError));\r\n  }\r\n}\r\n\r\n/**\r\n * Combines multiple Results into a single Result containing an array of values.\r\n * If any Result is an error, returns that error immediately (short-circuits).\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param results - Array of Results to combine\r\n * @returns A Result containing an array of values, or the first error encountered\r\n *\r\n * @example\r\n * ```typescript\r\n * const nums = [ok(1), ok(2), ok(3)];\r\n * all(nums); // { ok: true, value: [1, 2, 3] }\r\n *\r\n * const mixed = [ok(1), err(\"error\"), ok(3)];\r\n * all(mixed); // { ok: false, error: \"error\" }\r\n * ```\r\n */\r\nexport function all<SuccessType, ErrorType>(\r\n  results: Array<Result<SuccessType, ErrorType>>\r\n): Result<SuccessType[], ErrorType> {\r\n  const out: SuccessType[] = [];\r\n  for (const r of results) {\r\n    if (!r.ok) return r;\r\n    out.push(r.value);\r\n  }\r\n  return ok(out);\r\n}\r\n\r\n/**\r\n * Pattern matching for Results. Executes different handlers based on success or failure.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @template ReturnType - The return type of both handlers\r\n * @param result - The Result to match\r\n * @param handlers - Object with onOk and onErr handlers\r\n * @returns The result of the executed handler\r\n *\r\n * @example\r\n * ```typescript\r\n * const result = ok(42);\r\n * match(result, {\r\n *   onOk: value => console.log(`Success: ${value}`),\r\n *   onErr: error => console.error(`Error: ${error}`)\r\n * });\r\n * ```\r\n */\r\nexport function match<SuccessType, ErrorType, ReturnType>(\r\n  result: Result<SuccessType, ErrorType>,\r\n  handlers: { onOk: (value: SuccessType) => ReturnType; onErr: (error: ErrorType) => ReturnType }\r\n): ReturnType {\r\n  return result.ok ? handlers.onOk(result.value) : handlers.onErr(result.error);\r\n}\r\n\r\n/**\r\n * Lifts a regular function to work with Results by wrapping it with error handling.\r\n *\r\n * @template ParamType - The function parameter type\r\n * @template SuccessType - The function return type (success type)\r\n * @template ErrorType - The error type\r\n * @param fn - The function to lift\r\n * @param mapUnknownError - Function to convert thrown errors to the ErrorType\r\n * @returns A function that returns a Result\r\n *\r\n * @example\r\n * ```typescript\r\n * const parseJSON = lift(\r\n *   (str: string) => JSON.parse(str),\r\n *   (e) => `Invalid JSON: ${e}`\r\n * );\r\n *\r\n * const result = parseJSON(\"{ invalid }\");\r\n * // { ok: false, error: \"Invalid JSON: ...\" }\r\n * ```\r\n */\r\nexport function lift<ParamType, SuccessType, ErrorType>(\r\n  fn: (param: ParamType) => SuccessType,\r\n  mapUnknownError: (unknownError: unknown) => ErrorType\r\n): (param: ParamType) => Result<SuccessType, ErrorType> {\r\n  return (param) => tryCatch(() => fn(param), mapUnknownError);\r\n}\r\n\r\n/**\r\n * Transforms the value of an async Result.\r\n * If the Result is an error, returns it unchanged.\r\n *\r\n * @template SuccessType - The current success type\r\n * @template NewSuccessType - The new success type after transformation\r\n * @template ErrorType - The error type\r\n * @param asyncResult - The async Result to transform\r\n * @param transform - Async or sync function to transform the success value\r\n * @returns A promise that resolves to a Result with the transformed value or error\r\n *\r\n * @example\r\n * ```typescript\r\n * const asyncNum = Promise.resolve(ok(5));\r\n * const doubled = await asyncMap(asyncNum, x => x * 2);\r\n * // { ok: true, value: 10 }\r\n * ```\r\n */\r\nexport async function asyncMap<SuccessType, NewSuccessType, ErrorType>(\r\n  asyncResult: AsyncResult<SuccessType, ErrorType>,\r\n  transform: (value: SuccessType) => Promise<NewSuccessType> | NewSuccessType\r\n): AsyncResult<NewSuccessType, ErrorType> {\r\n  const result = await asyncResult;\r\n  return result.ok ? ok(await transform(result.value)) : result;\r\n}\r\n\r\n/**\r\n * Chains async Result operations.\r\n * If the Result is successful, applies the async function to the value.\r\n *\r\n * @template SuccessType - The current success type\r\n * @template ErrorType - The error type\r\n * @template NextSuccessType - The next success type after chaining\r\n * @param asyncResult - The async Result to chain\r\n * @param next - Async function that returns a new async Result\r\n * @returns A promise that resolves to the chained Result or the original error\r\n *\r\n * @example\r\n * ```typescript\r\n * const fetchAndProcess = async (url: string) => {\r\n *   const data = await fromPromise(fetch(url).then(r => r.json()), e => String(e));\r\n *   return asyncAndThen(data, processDataAsync);\r\n * };\r\n * ```\r\n */\r\nexport async function asyncAndThen<SuccessType, ErrorType, NextSuccessType>(\r\n  asyncResult: AsyncResult<SuccessType, ErrorType>,\r\n  next: (value: SuccessType) => AsyncResult<NextSuccessType, ErrorType>\r\n): AsyncResult<NextSuccessType, ErrorType> {\r\n  const result = await asyncResult;\r\n  return result.ok ? next(result.value) : result;\r\n}\r\n\r\n/**\r\n * Converts a Promise into an async Result.\r\n * Catches any rejection and converts it to an error Result.\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param promise - The Promise to convert\r\n * @param mapUnknownError - Function to convert unknown errors to the ErrorType\r\n * @returns A promise that resolves to a Result\r\n *\r\n * @example\r\n * ```typescript\r\n * const result = await fromPromise(\r\n *   fetch(\"/api/data\").then(r => r.json()),\r\n *   (e) => `Fetch failed: ${e}`\r\n * );\r\n * ```\r\n */\r\nexport async function fromPromise<SuccessType, ErrorType>(\r\n  promise: Promise<SuccessType>,\r\n  mapUnknownError: (unknownError: unknown) => ErrorType\r\n): AsyncResult<SuccessType, ErrorType> {\r\n  try {\r\n    return ok(await promise);\r\n  } catch (unknownError) {\r\n    return err(mapUnknownError(unknownError));\r\n  }\r\n}\r\n\r\n/**\r\n * Combines multiple async Results into a single Result containing an array of values.\r\n * If any Result is an error, returns that error (short-circuits).\r\n *\r\n * @template SuccessType - The success type\r\n * @template ErrorType - The error type\r\n * @param asyncResults - Array of async Results to combine\r\n * @returns A promise that resolves to a Result containing an array of values or the first error\r\n *\r\n * @example\r\n * ```typescript\r\n * const results = [\r\n *   Promise.resolve(ok(1)),\r\n *   Promise.resolve(ok(2)),\r\n *   Promise.resolve(ok(3))\r\n * ];\r\n * const combined = await asyncAll(results);\r\n * // { ok: true, value: [1, 2, 3] }\r\n * ```\r\n */\r\nexport async function asyncAll<SuccessType, ErrorType>(\r\n  asyncResults: Array<AsyncResult<SuccessType, ErrorType>>\r\n): AsyncResult<SuccessType[], ErrorType> {\r\n  const results: Result<SuccessType, ErrorType>[] = await Promise.all(asyncResults);\r\n  return all(results);\r\n}\r\n","/**\r\n * Utility function to create type-safe injection tokens for dependency injection.\r\n */\r\nimport type { InjectionToken } from \"./types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\n\r\n/**\r\n * Creates a unique, type-safe injection token for dependency injection.\r\n * Each call creates a new Symbol, ensuring uniqueness even with the same description.\r\n *\r\n * @template ServiceType - The type of service this token represents\r\n * @param description - A descriptive name for debugging purposes (appears in DevTools)\r\n * @returns A unique Symbol branded with the service type\r\n *\r\n * @example\r\n * // Create tokens for different services\r\n * const LoggerToken = createInjectionToken<Logger>('Logger');\r\n * const DatabaseToken = createInjectionToken<Database>('Database');\r\n *\r\n * // Tokens can be used with a DI container\r\n * container.register(LoggerToken, new Logger());\r\n */\r\nexport function createInjectionToken<TServiceType extends ServiceType>(\r\n  description: string\r\n): InjectionToken<TServiceType> {\r\n  return Symbol(description) as InjectionToken<TServiceType>;\r\n}\r\n","/**\r\n * Injection tokens for the Foundry abstraction layer and its versioned ports.\r\n * These tokens allow services to be resolved via the DI container without\r\n * directly depending on concrete implementations.\r\n */\r\nimport type { InjectionToken } from \"@/di_infrastructure/types/injectiontoken\";\r\nimport { createInjectionToken } from \"@/di_infrastructure/tokenutilities\";\r\nimport type { FoundryGame } from \"./interfaces/FoundryGame\";\r\nimport type { FoundryHooks } from \"./interfaces/FoundryHooks\";\r\nimport type { FoundryDocument } from \"./interfaces/FoundryDocument\";\r\nimport type { FoundryUI } from \"./interfaces/FoundryUI\";\r\nimport type { FoundrySettings } from \"./interfaces/FoundrySettings\";\r\nimport type { PortSelector } from \"./versioning/portselector\";\r\nimport type { PortRegistry } from \"./versioning/portregistry\";\r\n\r\n/**\r\n * Injection token for FoundryGame service.\r\n *\r\n * Provides access to Foundry's game API, specifically journal entries.\r\n * Automatically selects version-appropriate port implementation.\r\n *\r\n * @example\r\n * ```typescript\r\n * const game = container.resolve(foundryGameToken);\r\n * const entries = game.getJournalEntries();\r\n * if (entries.ok) {\r\n *   console.log(`Found ${entries.value.length} journal entries`);\r\n * }\r\n * ```\r\n */\r\nexport const foundryGameToken: InjectionToken<FoundryGame> =\r\n  createInjectionToken<FoundryGame>(\"FoundryGame\");\r\n\r\n/**\r\n * Injection token for FoundryHooks service.\r\n *\r\n * Provides access to Foundry's hook system for event registration.\r\n * Automatically selects version-appropriate port implementation.\r\n *\r\n * @example\r\n * ```typescript\r\n * const hooks = container.resolve(foundryHooksToken);\r\n * hooks.on(\"renderJournalDirectory\", (app, html) => {\r\n *   console.log(\"Journal directory rendered\");\r\n * });\r\n * ```\r\n */\r\nexport const foundryHooksToken: InjectionToken<FoundryHooks> =\r\n  createInjectionToken<FoundryHooks>(\"FoundryHooks\");\r\n\r\n/**\r\n * Injection token for FoundryDocument service.\r\n *\r\n * Provides access to Foundry's document API for flag management.\r\n * Automatically selects version-appropriate port implementation.\r\n *\r\n * @example\r\n * ```typescript\r\n * const doc = container.resolve(foundryDocumentToken);\r\n * const flag = doc.getFlag(journal, \"my-module\", \"my-flag\");\r\n * if (flag.ok) {\r\n *   console.log(\"Flag value:\", flag.value);\r\n * }\r\n * ```\r\n */\r\nexport const foundryDocumentToken: InjectionToken<FoundryDocument> =\r\n  createInjectionToken<FoundryDocument>(\"FoundryDocument\");\r\n\r\n/**\r\n * Injection token for FoundryUI service.\r\n *\r\n * Provides access to Foundry's UI manipulation API for notifications\r\n * and DOM element management.\r\n *\r\n * @example\r\n * ```typescript\r\n * const ui = container.resolve(foundryUIToken);\r\n * ui.notify(\"Operation successful\", \"info\");\r\n * ```\r\n */\r\nexport const foundryUIToken: InjectionToken<FoundryUI> =\r\n  createInjectionToken<FoundryUI>(\"FoundryUI\");\r\n\r\n/**\r\n * Injection token for PortSelector.\r\n *\r\n * Selects the appropriate port implementation based on the current\r\n * Foundry VTT version. Uses factory-based selection to prevent crashes\r\n * from incompatible port constructors.\r\n *\r\n * @remarks\r\n * This is a core infrastructure service used internally by Foundry services.\r\n * Typically not accessed directly by application code.\r\n */\r\nexport const portSelectorToken: InjectionToken<PortSelector> =\r\n  createInjectionToken<PortSelector>(\"PortSelector\");\r\n\r\n/**\r\n * Injection token for FoundryGame PortRegistry.\r\n */\r\nexport const foundryGamePortRegistryToken: InjectionToken<PortRegistry<FoundryGame>> =\r\n  createInjectionToken<PortRegistry<FoundryGame>>(\"FoundryGamePortRegistry\");\r\n\r\n/**\r\n * Injection token for FoundryHooks PortRegistry.\r\n */\r\nexport const foundryHooksPortRegistryToken: InjectionToken<PortRegistry<FoundryHooks>> =\r\n  createInjectionToken<PortRegistry<FoundryHooks>>(\"FoundryHooksPortRegistry\");\r\n\r\n/**\r\n * Injection token for FoundryDocument PortRegistry.\r\n */\r\nexport const foundryDocumentPortRegistryToken: InjectionToken<PortRegistry<FoundryDocument>> =\r\n  createInjectionToken<PortRegistry<FoundryDocument>>(\"FoundryDocumentPortRegistry\");\r\n\r\n/**\r\n * Injection token for FoundryUI PortRegistry.\r\n */\r\nexport const foundryUIPortRegistryToken: InjectionToken<PortRegistry<FoundryUI>> =\r\n  createInjectionToken<PortRegistry<FoundryUI>>(\"FoundryUIPortRegistry\");\r\n\r\n/**\r\n * Injection token for FoundrySettings service.\r\n *\r\n * Provides access to Foundry's settings system for module configuration.\r\n * Automatically selects version-appropriate port implementation.\r\n *\r\n * @example\r\n * ```typescript\r\n * const settings = container.resolve(foundrySettingsToken);\r\n * const logLevel = settings.get(\"my-module\", \"logLevel\");\r\n * if (logLevel.ok) {\r\n *   console.log(\"Current log level:\", logLevel.value);\r\n * }\r\n * ```\r\n */\r\nexport const foundrySettingsToken: InjectionToken<FoundrySettings> =\r\n  createInjectionToken<FoundrySettings>(\"FoundrySettings\");\r\n\r\n/**\r\n * Injection token for FoundrySettings PortRegistry.\r\n */\r\nexport const foundrySettingsPortRegistryToken: InjectionToken<PortRegistry<FoundrySettings>> =\r\n  createInjectionToken<PortRegistry<FoundrySettings>>(\"FoundrySettingsPortRegistry\");\r\n","import { createInjectionToken } from \"@/di_infrastructure/tokenutilities\";\r\nimport type { Logger } from \"@/interfaces/logger\";\r\nimport type { JournalVisibilityService } from \"@/services/JournalVisibilityService\";\r\n\r\n/**\r\n * Injection token for the application logger service.\r\n *\r\n * Resolves to ConsoleLoggerService, providing structured logging\r\n * with configurable log levels (DEBUG, INFO, WARN, ERROR).\r\n *\r\n * @example\r\n * ```typescript\r\n * const logger = container.resolve(loggerToken);\r\n * logger.info(\"Application started\");\r\n * logger.error(\"Error occurred\", { code: 500, details: error });\r\n * ```\r\n */\r\nexport const loggerToken = createInjectionToken<Logger>(\"Logger\");\r\n\r\n/**\r\n * Injection token for the JournalVisibilityService.\r\n *\r\n * Manages visibility of journal entries based on module flags.\r\n * Handles hiding/showing entries in the Foundry UI and processes\r\n * journal directory rendering.\r\n *\r\n * @example\r\n * ```typescript\r\n * const service = container.resolve(journalVisibilityServiceToken);\r\n * const hidden = service.getHiddenJournalEntries();\r\n * if (hidden.ok) {\r\n *   console.log(`Found ${hidden.value.length} hidden entries`);\r\n * }\r\n * ```\r\n */\r\nexport const journalVisibilityServiceToken = createInjectionToken<JournalVisibilityService>(\r\n  \"JournalVisibilityService\"\r\n);\r\n\r\n/**\r\n * Re-export port-related tokens for convenience.\r\n * These are defined in @/foundry/foundrytokens but exported here for easier access.\r\n */\r\nexport { portSelectorToken } from \"@/foundry/foundrytokens\";\r\n","import type { InjectionToken } from \"./injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\n\r\n/**\r\n * Compile-time brand marker for API-safe tokens.\r\n *\r\n * This symbol only exists at the type level and is erased at runtime.\r\n * It's used to mark tokens that are safe for external module consumption via the public API.\r\n *\r\n * @internal This is a type-level-only marker\r\n */\r\ndeclare const API_SAFE_BRAND: unique symbol;\r\n\r\n/**\r\n * Runtime registry of API-safe tokens.\r\n *\r\n * Uses Set for O(1) lookups. Since symbols are primitives (not objects),\r\n * WeakSet cannot be used. This is safe because tokens are compile-time constants\r\n * and never get garbage collected anyway.\r\n *\r\n * @internal\r\n */\r\nconst apiSafeTokens = new Set<symbol>();\r\n\r\n/**\r\n * InjectionToken branded as \"API-safe\" for external module consumption.\r\n *\r\n * Only tokens marked via `markAsApiSafe()` can be used with the throwing\r\n * `container.resolve()` method. This enforces that internal code uses\r\n * `resolveWithError()` for Result-based error handling.\r\n *\r\n * **Enforcement:**\r\n * - Compile-time: TypeScript enforces ApiSafeToken type (prevents `container.resolve(regularToken)`)\r\n * - Runtime: Symbol marker validates token was marked via markAsApiSafe()\r\n *\r\n * **Design rationale:**\r\n * - External modules (unfamiliar with Result pattern) get exception-based API\r\n * - Internal code (uses Result pattern) cannot accidentally use throwing API\r\n * - Defense-in-depth: Type system + runtime guard\r\n *\r\n * @template T - The service type this token resolves to\r\n *\r\n * @see markAsApiSafe - Function to mark tokens as API-safe\r\n * @see https://github.com/tc39/proposal-type-annotations (future TC39 standard alignment)\r\n */\r\nexport type ApiSafeToken<T extends ServiceType> = InjectionToken<T> & {\r\n  readonly [API_SAFE_BRAND]: true;\r\n};\r\n\r\n/**\r\n * Marks an injection token as safe for API exposure.\r\n *\r\n * **üîí RESTRICTED: Only call this in composition-root.ts**\r\n *\r\n * This function should ONLY be used when creating the public ModuleApi\r\n * to mark tokens that external modules can safely use with `api.resolve()`.\r\n *\r\n * Internal code should never call this function - it should always use\r\n * `resolveWithError()` with regular InjectionToken types.\r\n *\r\n * **Implementation:**\r\n * 1. Adds token to Set registry\r\n * 2. Returns token cast as ApiSafeToken (compile-time brand)\r\n *\r\n * **Performance:**\r\n * - Minimal runtime overhead (Set.add is O(1))\r\n * - Compile-time type checking prevents misuse\r\n *\r\n * @param token - The injection token to mark as API-safe\r\n * @returns The same token, branded as ApiSafeToken with runtime marker\r\n *\r\n * @example\r\n * ```typescript\r\n * // ‚úÖ CORRECT: In composition-root.ts\r\n * const api: ModuleApi = {\r\n *   tokens: {\r\n *     loggerToken: markAsApiSafe(loggerToken),\r\n *     gameToken: markAsApiSafe(foundryGameToken),\r\n *   }\r\n * };\r\n *\r\n * // ‚ùå WRONG: In service code\r\n * const logger = container.resolve(markAsApiSafe(loggerToken));\r\n * // Use resolveWithError() instead!\r\n * ```\r\n */\r\nexport function markAsApiSafe<T extends ServiceType>(token: InjectionToken<T>): ApiSafeToken<T> {\r\n  // Add to Set registry (O(1) lookup)\r\n  apiSafeTokens.add(token);\r\n\r\n  // Return with compile-time brand (type cast)\r\n  return token as ApiSafeToken<T>;\r\n}\r\n\r\n/**\r\n * Runtime validation that a token is API-safe.\r\n *\r\n * Checks if the token is in the Set registry.\r\n * Used by container.resolve() to enforce API boundary at runtime.\r\n *\r\n * This provides defense-in-depth against:\r\n * - @ts-ignore comments bypassing type checks\r\n * - Type assertions (`token as ApiSafeToken`)\r\n * - JavaScript consumers (no type checking)\r\n *\r\n * **Performance:**\r\n * - O(1) Set lookup (~1-2 nanoseconds)\r\n * - Negligible impact (~0.4% of resolve() time)\r\n * - Safe: Tokens are compile-time constants, never GC'd\r\n *\r\n * @param token - The token to validate\r\n * @returns True if token was marked via markAsApiSafe(), false otherwise\r\n *\r\n * @internal Used by ServiceContainer, not intended for external use\r\n *\r\n * @example\r\n * ```typescript\r\n * // Container.resolve() implementation:\r\n * resolve(token) {\r\n *   if (!isApiSafeTokenRuntime(token)) {\r\n *     throw new Error(\"Use resolveWithError() in internal code\");\r\n *   }\r\n *   // ...\r\n * }\r\n * ```\r\n */\r\nexport function isApiSafeTokenRuntime<T extends ServiceType>(\r\n  token: InjectionToken<T>\r\n): token is ApiSafeToken<T> {\r\n  // Check Set registry\r\n  return apiSafeTokens.has(token);\r\n}\r\n","/**\r\n * Enum for service lifecycle strategies in dependency injection.\r\n *\r\n * - SINGLETON: One shared instance across the entire application\r\n * - TRANSIENT: New instance created on each resolution\r\n * - SCOPED: One instance per container scope\r\n *\r\n * @enum {string}\r\n * @property {string} SINGLETON - One instance for all\r\n * @property {string} TRANSIENT - New instance for each resolve()\r\n * @property {string} SCOPED - One instance per scope\r\n */\r\nexport enum ServiceLifecycle {\r\n  SINGLETON = \"singleton\",\r\n  TRANSIENT = \"transient\",\r\n  SCOPED = \"scoped\",\r\n}\r\n","import type { ServiceLifecycle } from \"./servicelifecycle\";\r\nimport type { InjectionToken } from \"./injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport type { ServiceClass } from \"./serviceclass\";\r\nimport type { FactoryFunction } from \"./servicefactory\";\r\nimport type { Result } from \"@/types/result\";\r\nimport type { ContainerError } from \"../interfaces/containererror\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { ServiceLifecycle as SL } from \"./servicelifecycle\";\r\n\r\n/**\r\n * Represents a service registration in the DI container.\r\n * Stores all metadata required to create and manage service instances.\r\n *\r\n * Design: Uses separate optional fields instead of union type to:\r\n * - Prevent accidental calls to placeholder alias factories\r\n * - Make provider type clear and type-safe\r\n * - Support proper cloning for child scopes\r\n *\r\n * Use static factory methods to create instances:\r\n * - ServiceRegistration.createClass()\r\n * - ServiceRegistration.createFactory()\r\n * - ServiceRegistration.createValue()\r\n * - ServiceRegistration.createAlias()\r\n */\r\nexport class ServiceRegistration {\r\n  /**\r\n   * Private constructor - use static factory methods instead.\r\n   * This prevents direct construction with invalid parameters\r\n   * and ensures Result-based error handling.\r\n   */\r\n  private constructor(\r\n    public readonly lifecycle: ServiceLifecycle,\r\n    public readonly dependencies: readonly InjectionToken<ServiceType>[], // Immutable array\r\n    public readonly providerType: \"class\" | \"factory\" | \"value\" | \"alias\",\r\n\r\n    // Exactly one of these must be set based on providerType:\r\n    public readonly serviceClass?: ServiceClass<ServiceType>,\r\n    public readonly factory?: FactoryFunction<ServiceType>,\r\n    public readonly value?: ServiceType,\r\n    public readonly aliasTarget?: InjectionToken<ServiceType>\r\n  ) {\r\n    // NO validation here - trust factory methods to provide valid data\r\n  }\r\n\r\n  /**\r\n   * Creates a class-based registration.\r\n   * @param lifecycle - Service lifecycle (SINGLETON, TRANSIENT, SCOPED)\r\n   * @param dependencies - Array of dependency tokens\r\n   * @param serviceClass - The class to instantiate\r\n   * @returns Result with registration or validation error\r\n   */\r\n  static createClass(\r\n    lifecycle: ServiceLifecycle,\r\n    dependencies: readonly InjectionToken<ServiceType>[],\r\n    serviceClass: ServiceClass<ServiceType>\r\n  ): Result<ServiceRegistration, ContainerError> {\r\n    if (!serviceClass) {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"serviceClass is required for class registration\",\r\n      });\r\n    }\r\n\r\n    return ok(\r\n      new ServiceRegistration(\r\n        lifecycle,\r\n        dependencies,\r\n        \"class\",\r\n        serviceClass,\r\n        undefined,\r\n        undefined,\r\n        undefined\r\n      )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates a factory-based registration.\r\n   * @param lifecycle - Service lifecycle (SINGLETON, TRANSIENT, SCOPED)\r\n   * @param dependencies - Array of dependency tokens\r\n   * @param factory - Factory function that creates instances\r\n   * @returns Result with registration or validation error\r\n   */\r\n  static createFactory(\r\n    lifecycle: ServiceLifecycle,\r\n    dependencies: readonly InjectionToken<ServiceType>[],\r\n    factory: FactoryFunction<ServiceType>\r\n  ): Result<ServiceRegistration, ContainerError> {\r\n    if (!factory) {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"factory is required for factory registration\",\r\n      });\r\n    }\r\n\r\n    return ok(\r\n      new ServiceRegistration(\r\n        lifecycle,\r\n        dependencies,\r\n        \"factory\",\r\n        undefined,\r\n        factory,\r\n        undefined,\r\n        undefined\r\n      )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates a value-based registration (always SINGLETON).\r\n   * @param value - The value to register\r\n   * @returns Result with registration or validation error\r\n   */\r\n  static createValue(value: ServiceType): Result<ServiceRegistration, ContainerError> {\r\n    if (value === undefined) {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"value cannot be undefined for value registration\",\r\n      });\r\n    }\r\n\r\n    if (typeof value === \"function\") {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message:\r\n          \"registerValue() only accepts plain values, not functions or classes. Use registerClass() or registerFactory() instead.\",\r\n      });\r\n    }\r\n\r\n    return ok(\r\n      new ServiceRegistration(SL.SINGLETON, [], \"value\", undefined, undefined, value, undefined)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates an alias registration (always SINGLETON).\r\n   * @param targetToken - The token to resolve instead\r\n   * @returns Result with registration or validation error\r\n   */\r\n  static createAlias(\r\n    targetToken: InjectionToken<ServiceType>\r\n  ): Result<ServiceRegistration, ContainerError> {\r\n    if (!targetToken) {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"targetToken is required for alias registration\",\r\n      });\r\n    }\r\n\r\n    return ok(\r\n      new ServiceRegistration(\r\n        SL.SINGLETON,\r\n        [targetToken],\r\n        \"alias\",\r\n        undefined,\r\n        undefined,\r\n        undefined,\r\n        targetToken\r\n      )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates a clone of this registration.\r\n   * Used when child containers inherit registrations from parent.\r\n   *\r\n   * @returns A new ServiceRegistration instance with cloned dependencies array\r\n   */\r\n  clone(): ServiceRegistration {\r\n    return new ServiceRegistration(\r\n      this.lifecycle,\r\n      [...this.dependencies], // Clone array to prevent shared mutations\r\n      this.providerType,\r\n      this.serviceClass,\r\n      this.factory,\r\n      this.value,\r\n      this.aliasTarget\r\n    );\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { InjectionToken } from \"../types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport type { ServiceClass } from \"../types/serviceclass\";\r\nimport type { FactoryFunction } from \"../types/servicefactory\";\r\nimport type { ServiceDependencies } from \"../types/servicedependencies\";\r\nimport { ServiceLifecycle } from \"../types/servicelifecycle\";\r\nimport type { ContainerError } from \"../interfaces/containererror\";\r\nimport { ServiceRegistration } from \"../types/serviceregistration\";\r\nimport { ok, err, isErr } from \"@/utils/result\";\r\n\r\n/**\r\n * Type for service classes that declare their dependencies.\r\n */\r\ntype ServiceClassWithDependencies<T extends ServiceType> = ServiceClass<T> & {\r\n  dependencies?: ReadonlyArray<InjectionToken<ServiceType>>;\r\n};\r\n\r\n/**\r\n * Type guard to check if a service class has a dependencies property.\r\n *\r\n * @template T - The service type\r\n * @param cls - The service class to check\r\n * @returns True if the class has a dependencies property\r\n */\r\nfunction hasDependencies<T extends ServiceType>(\r\n  cls: ServiceClass<T>\r\n): cls is ServiceClassWithDependencies<T> {\r\n  return \"dependencies\" in cls;\r\n}\r\n\r\n/**\r\n * Registry for service registrations.\r\n *\r\n * Responsibilities:\r\n * - Manage service registrations (add, retrieve, check existence)\r\n * - Validate registrations (no duplicates, valid values)\r\n * - Support cloning for child containers\r\n * - Enforce registration limits (DoS protection)\r\n *\r\n * This class does NOT handle:\r\n * - Service resolution (that's ServiceResolver's job)\r\n * - Dependency validation (that's ContainerValidator's job)\r\n */\r\nexport class ServiceRegistry {\r\n  private readonly MAX_REGISTRATIONS = 10000; // DoS protection: prevent unlimited registrations\r\n  private registrations = new Map<InjectionToken<ServiceType>, ServiceRegistration>();\r\n  private lifecycleIndex = new Map<ServiceLifecycle, Set<InjectionToken<ServiceType>>>();\r\n\r\n  /**\r\n   * Updates the lifecycle index when a service is registered.\r\n   *\r\n   * @param token - The injection token\r\n   * @param lifecycle - The service lifecycle\r\n   */\r\n  private updateLifecycleIndex(\r\n    token: InjectionToken<ServiceType>,\r\n    lifecycle: ServiceLifecycle\r\n  ): void {\r\n    if (!this.lifecycleIndex.has(lifecycle)) {\r\n      this.lifecycleIndex.set(lifecycle, new Set());\r\n    }\r\n    this.lifecycleIndex.get(lifecycle)!.add(token);\r\n  }\r\n\r\n  /**\r\n   * Registers a service class with automatic dependency injection.\r\n   *\r\n   * @template TServiceType - The type of service to register\r\n   * @param token - The injection token identifying this service\r\n   * @param serviceClass - The class to instantiate\r\n   * @param lifecycle - Service lifecycle (SINGLETON, TRANSIENT, SCOPED)\r\n   * @returns Result indicating success or error\r\n   */\r\n  registerClass<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    serviceClass: ServiceClass<TServiceType>,\r\n    lifecycle: ServiceLifecycle\r\n  ): Result<void, ContainerError> {\r\n    // Check registration limit (DoS protection)\r\n    if (this.registrations.size >= this.MAX_REGISTRATIONS) {\r\n      return err({\r\n        code: \"MaxRegistrationsExceeded\",\r\n        message: `Cannot register more than ${this.MAX_REGISTRATIONS} services`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.registrations.has(token)) {\r\n      return err({\r\n        code: \"DuplicateRegistration\",\r\n        message: `Service ${String(token)} already registered`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    const dependencies = hasDependencies(serviceClass) ? (serviceClass.dependencies ?? []) : [];\r\n\r\n    // Use static factory method for validation\r\n    const registrationResult = ServiceRegistration.createClass(\r\n      lifecycle,\r\n      dependencies,\r\n      serviceClass\r\n    );\r\n\r\n    /* c8 ignore next 3 -- ServiceRegistration.createClass validation tested in serviceregistration.test.ts; error propagation complex to test */\r\n    if (isErr(registrationResult)) {\r\n      return registrationResult;\r\n    }\r\n\r\n    this.registrations.set(token, registrationResult.value);\r\n    this.updateLifecycleIndex(token, lifecycle);\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Registers a factory function for creating service instances.\r\n   *\r\n   * @template TServiceType - The type of service this factory creates\r\n   * @param token - The injection token identifying this service\r\n   * @param factory - Factory function that creates instances\r\n   * @param lifecycle - Service lifecycle (SINGLETON, TRANSIENT, SCOPED)\r\n   * @param dependencies - Array of tokens this factory depends on\r\n   * @returns Result indicating success or error\r\n   */\r\n  registerFactory<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    factory: FactoryFunction<TServiceType>,\r\n    lifecycle: ServiceLifecycle,\r\n    dependencies: ServiceDependencies\r\n  ): Result<void, ContainerError> {\r\n    // Check registration limit (DoS protection)\r\n    if (this.registrations.size >= this.MAX_REGISTRATIONS) {\r\n      return err({\r\n        code: \"MaxRegistrationsExceeded\",\r\n        message: `Cannot register more than ${this.MAX_REGISTRATIONS} services`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.registrations.has(token)) {\r\n      return err({\r\n        code: \"DuplicateRegistration\",\r\n        message: `Service ${String(token)} already registered`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    // Use static factory method for validation\r\n    const registrationResult = ServiceRegistration.createFactory(lifecycle, dependencies, factory);\r\n\r\n    /* c8 ignore next 3 -- ServiceRegistration.createFactory validation tested in serviceregistration.test.ts; error propagation complex to test */\r\n    if (isErr(registrationResult)) {\r\n      return registrationResult;\r\n    }\r\n\r\n    this.registrations.set(token, registrationResult.value);\r\n    this.updateLifecycleIndex(token, lifecycle);\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Registers a constant value (always SINGLETON lifecycle).\r\n   *\r\n   * @template TServiceType - The type of value to register\r\n   * @param token - The injection token identifying this value\r\n   * @param value - The value to register\r\n   * @returns Result indicating success or error\r\n   */\r\n  registerValue<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    value: TServiceType\r\n  ): Result<void, ContainerError> {\r\n    // Check registration limit (DoS protection)\r\n    if (this.registrations.size >= this.MAX_REGISTRATIONS) {\r\n      return err({\r\n        code: \"MaxRegistrationsExceeded\",\r\n        message: `Cannot register more than ${this.MAX_REGISTRATIONS} services`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.registrations.has(token)) {\r\n      return err({\r\n        code: \"DuplicateRegistration\",\r\n        message: `Service ${String(token)} already registered`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    // Use static factory method for validation (includes function check)\r\n    const registrationResult = ServiceRegistration.createValue(value);\r\n\r\n    /* c8 ignore next 3 -- ServiceRegistration.createValue validation tested in serviceregistration.test.ts; error propagation complex to test */\r\n    if (isErr(registrationResult)) {\r\n      return registrationResult;\r\n    }\r\n\r\n    this.registrations.set(token, registrationResult.value);\r\n    this.updateLifecycleIndex(token, ServiceLifecycle.SINGLETON); // Values are always SINGLETON\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Registers an alias that points to another token.\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param aliasToken - The alias token\r\n   * @param targetToken - The token to resolve instead\r\n   * @returns Result indicating success or error\r\n   */\r\n  registerAlias<TServiceType extends ServiceType>(\r\n    aliasToken: InjectionToken<TServiceType>,\r\n    targetToken: InjectionToken<TServiceType>\r\n  ): Result<void, ContainerError> {\r\n    // Check registration limit (DoS protection)\r\n    if (this.registrations.size >= this.MAX_REGISTRATIONS) {\r\n      return err({\r\n        code: \"MaxRegistrationsExceeded\",\r\n        message: `Cannot register more than ${this.MAX_REGISTRATIONS} services`,\r\n        tokenDescription: String(aliasToken),\r\n      });\r\n    }\r\n\r\n    if (this.registrations.has(aliasToken)) {\r\n      return err({\r\n        code: \"DuplicateRegistration\",\r\n        message: `Service ${String(aliasToken)} already registered`,\r\n        tokenDescription: String(aliasToken),\r\n      });\r\n    }\r\n\r\n    // Use static factory method for validation\r\n    const registrationResult = ServiceRegistration.createAlias(targetToken);\r\n\r\n    /* c8 ignore next 3 -- ServiceRegistration.createAlias validation tested in serviceregistration.test.ts; error propagation complex to test */\r\n    if (isErr(registrationResult)) {\r\n      return registrationResult;\r\n    }\r\n\r\n    this.registrations.set(aliasToken, registrationResult.value);\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Retrieves a service registration.\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param token - The injection token identifying the service\r\n   * @returns The registration or undefined if not found\r\n   */\r\n  getRegistration<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>\r\n  ): ServiceRegistration | undefined {\r\n    return this.registrations.get(token);\r\n  }\r\n\r\n  /**\r\n   * Returns all registrations.\r\n   * Used by ContainerValidator for dependency validation.\r\n   *\r\n   * @returns Map of all registrations\r\n   */\r\n  getAllRegistrations(): Map<InjectionToken<ServiceType>, ServiceRegistration> {\r\n    return new Map(this.registrations); // Defensive copy\r\n  }\r\n\r\n  /**\r\n   * Returns all registrations for a specific lifecycle.\r\n   * More efficient than filtering getAllRegistrations() when only one lifecycle is needed.\r\n   *\r\n   * @param lifecycle - The lifecycle to query\r\n   * @returns Array of registrations with the specified lifecycle\r\n   */\r\n  getRegistrationsByLifecycle(lifecycle: ServiceLifecycle): ServiceRegistration[] {\r\n    const tokens = this.lifecycleIndex.get(lifecycle) ?? new Set();\r\n    return Array.from(tokens)\r\n      .map((token) => this.registrations.get(token))\r\n      .filter((reg): reg is ServiceRegistration => reg !== undefined);\r\n  }\r\n\r\n  /**\r\n   * Checks if a service is registered.\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param token - The injection token to check\r\n   * @returns True if registered, false otherwise\r\n   */\r\n  has<TServiceType extends ServiceType>(token: InjectionToken<TServiceType>): boolean {\r\n    return this.registrations.has(token);\r\n  }\r\n\r\n  /**\r\n   * Clears all registrations.\r\n   * Warning: This removes all configured services.\r\n   */\r\n  clear(): void {\r\n    this.registrations.clear();\r\n    this.lifecycleIndex.clear();\r\n  }\r\n\r\n  /**\r\n   * Creates a deep clone of this registry for child containers.\r\n   *\r\n   * Important: Creates a new Map instance with cloned ServiceRegistration objects\r\n   * to prevent child containers from mutating parent registrations.\r\n   *\r\n   * @returns A new ServiceRegistry with cloned registrations\r\n   */\r\n  clone(): ServiceRegistry {\r\n    const clonedRegistry = new ServiceRegistry();\r\n\r\n    // Create new Map with cloned ServiceRegistration objects\r\n    for (const [token, registration] of this.registrations.entries()) {\r\n      clonedRegistry.registrations.set(token, registration.clone());\r\n    }\r\n\r\n    // Clone lifecycle index\r\n    for (const [lifecycle, tokens] of this.lifecycleIndex.entries()) {\r\n      clonedRegistry.lifecycleIndex.set(lifecycle, new Set(tokens));\r\n    }\r\n\r\n    return clonedRegistry;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { ContainerError } from \"../interfaces/containererror\";\r\nimport type { InjectionToken } from \"../types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport type { ServiceRegistry } from \"../registry/ServiceRegistry\";\r\nimport { ok, err } from \"@/utils/result\";\r\n\r\n/**\r\n * Validates service registrations and dependencies.\r\n *\r\n * Responsibilities:\r\n * - Check that all dependencies are registered\r\n * - Detect circular dependencies using DFS\r\n * - Validate alias targets exist\r\n *\r\n * Design:\r\n * - STATEFUL: Maintains cache for performance optimization\r\n * - Cache is cleared on each validate() call for fresh validation\r\n * - Returns aggregated errors for comprehensive feedback\r\n * - Can be extended later with granular validator components\r\n * - Performance optimization: Caches validated sub-graphs for large dependency trees (>500 services)\r\n *\r\n * Note: While this class has internal state, it can be shared between parent and child containers\r\n * because the cache is cleared on each validation run, preventing stale state issues.\r\n */\r\nexport class ContainerValidator {\r\n  // Performance optimization: Cache for validated sub-graphs\r\n  // Prevents redundant DFS traversals in large dependency trees (>500 services)\r\n  private validatedSubgraphs = new Set<InjectionToken<ServiceType>>();\r\n  /**\r\n   * Validates all registrations in the registry.\r\n   *\r\n   * Performs three checks:\r\n   * 1. All dependencies are registered\r\n   * 2. All alias targets exist\r\n   * 3. No circular dependencies\r\n   *\r\n   * @param registry - The service registry to validate\r\n   * @returns Result with void on success, or array of errors\r\n   */\r\n  validate(registry: ServiceRegistry): Result<void, ContainerError[]> {\r\n    // Clear cache for fresh validation\r\n    this.validatedSubgraphs = new Set<InjectionToken<ServiceType>>();\r\n\r\n    const errors: ContainerError[] = [\r\n      ...this.validateDependencies(registry),\r\n      ...this.validateAliasTargets(registry),\r\n      ...this.detectCircularDependencies(registry),\r\n    ];\r\n\r\n    return errors.length > 0 ? err(errors) : ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Checks that all declared dependencies are registered.\r\n   *\r\n   * @param registry - The service registry to check\r\n   * @returns Array of errors for missing dependencies\r\n   */\r\n  private validateDependencies(registry: ServiceRegistry): ContainerError[] {\r\n    const errors: ContainerError[] = [];\r\n    const registrations = registry.getAllRegistrations();\r\n\r\n    for (const [token, registration] of registrations.entries()) {\r\n      for (const dep of registration.dependencies) {\r\n        if (!registry.has(dep)) {\r\n          errors.push({\r\n            code: \"TokenNotRegistered\",\r\n            message: `${String(token)} depends on ${String(dep)} which is not registered`,\r\n            tokenDescription: String(dep),\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n  /**\r\n   * Checks that all alias targets are registered.\r\n   *\r\n   * @param registry - The service registry to check\r\n   * @returns Array of errors for missing alias targets\r\n   */\r\n  private validateAliasTargets(registry: ServiceRegistry): ContainerError[] {\r\n    const errors: ContainerError[] = [];\r\n    const registrations = registry.getAllRegistrations();\r\n\r\n    for (const [token, registration] of registrations.entries()) {\r\n      if (registration.providerType === \"alias\" && registration.aliasTarget) {\r\n        if (!registry.has(registration.aliasTarget)) {\r\n          errors.push({\r\n            code: \"AliasTargetNotFound\",\r\n            message: `Alias ${String(token)} points to ${String(registration.aliasTarget)} which is not registered`,\r\n            tokenDescription: String(registration.aliasTarget),\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n  /**\r\n   * Detects circular dependencies using depth-first search.\r\n   *\r\n   * @param registry - The service registry to check\r\n   * @returns Array of errors for detected cycles\r\n   */\r\n  private detectCircularDependencies(registry: ServiceRegistry): ContainerError[] {\r\n    const errors: ContainerError[] = [];\r\n    const visited = new Set<InjectionToken<ServiceType>>();\r\n    const registrations = registry.getAllRegistrations();\r\n\r\n    for (const token of registrations.keys()) {\r\n      const visiting = new Set<InjectionToken<ServiceType>>();\r\n      const path: InjectionToken<ServiceType>[] = [];\r\n\r\n      const error = this.checkCycleForToken(registry, token, visiting, visited, path);\r\n      if (error) {\r\n        errors.push(error);\r\n      }\r\n    }\r\n\r\n    return errors;\r\n  }\r\n\r\n  /**\r\n   * Recursively checks for cycles starting from a specific token.\r\n   *\r\n   * Uses DFS with visiting/visited sets to detect back edges (cycles).\r\n   * Performance optimization: Uses Set cache to skip already-validated sub-graphs.\r\n   *\r\n   * @param registry - The service registry\r\n   * @param token - Current token being checked\r\n   * @param visiting - Set of tokens in current DFS path\r\n   * @param visited - Set of tokens already fully processed\r\n   * @param path - Current path for error reporting\r\n   * @returns ContainerError if cycle detected, null otherwise\r\n   */\r\n  private checkCycleForToken(\r\n    registry: ServiceRegistry,\r\n    token: InjectionToken<ServiceType>,\r\n    visiting: Set<InjectionToken<ServiceType>>,\r\n    visited: Set<InjectionToken<ServiceType>>,\r\n    path: InjectionToken<ServiceType>[]\r\n  ): ContainerError | null {\r\n    // Cycle detected: token is already in current path\r\n    if (visiting.has(token)) {\r\n      const cyclePath = [...path, token].map(String).join(\" ‚Üí \");\r\n      return {\r\n        code: \"CircularDependency\",\r\n        message: `Circular dependency: ${cyclePath}`,\r\n        tokenDescription: String(token),\r\n      };\r\n    }\r\n\r\n    // Performance optimization: Skip already validated sub-graphs\r\n    if (this.validatedSubgraphs.has(token)) {\r\n      return null;\r\n    }\r\n\r\n    // Already fully processed this token in current validation run\r\n    /* c8 ignore next 3 -- Visited check for graph traversal; tested via circular dependency tests */\r\n    if (visited.has(token)) {\r\n      return null;\r\n    }\r\n\r\n    // Mark as visiting and add to path\r\n    visiting.add(token);\r\n    path.push(token);\r\n\r\n    // Check all dependencies\r\n    const registration = registry.getRegistration(token);\r\n    if (registration) {\r\n      for (const dep of registration.dependencies) {\r\n        const error = this.checkCycleForToken(registry, dep, visiting, visited, path);\r\n        if (error) return error;\r\n      }\r\n    }\r\n\r\n    // Done visiting this token - mark as validated\r\n    visiting.delete(token);\r\n    path.pop();\r\n    visited.add(token);\r\n    this.validatedSubgraphs.add(token); // Cache for performance\r\n\r\n    return null;\r\n  }\r\n}\r\n","import type { InjectionToken } from \"../types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\n\r\n/**\r\n * Cache for service instances (Singleton and Scoped lifecycles).\r\n *\r\n * Responsibilities:\r\n * - Store and retrieve service instances by token\r\n * - Provide access to all instances for disposal\r\n * - Simple get/set/has/clear operations\r\n *\r\n * Note: This class does NOT handle disposal logic - that's ScopeManager's responsibility.\r\n */\r\nexport class InstanceCache {\r\n  private instances = new Map<InjectionToken<ServiceType>, ServiceType>();\r\n\r\n  /**\r\n   * Retrieves a cached service instance.\r\n   *\r\n   * @template TServiceType - The type of service to retrieve\r\n   * @param token - The injection token identifying the service\r\n   * @returns The cached instance or undefined if not found\r\n   */\r\n  get<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>\r\n  ): TServiceType | undefined {\r\n    return this.instances.get(token) as TServiceType | undefined;\r\n  }\r\n\r\n  /**\r\n   * Stores a service instance in the cache.\r\n   *\r\n   * @template TServiceType - The type of service to store\r\n   * @param token - The injection token identifying the service\r\n   * @param instance - The service instance to cache\r\n   */\r\n  set<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    instance: TServiceType\r\n  ): void {\r\n    this.instances.set(token, instance);\r\n  }\r\n\r\n  /**\r\n   * Checks if a service instance is cached.\r\n   *\r\n   * @template TServiceType - The type of service to check\r\n   * @param token - The injection token identifying the service\r\n   * @returns True if the instance is cached, false otherwise\r\n   */\r\n  has<TServiceType extends ServiceType>(token: InjectionToken<TServiceType>): boolean {\r\n    return this.instances.has(token);\r\n  }\r\n\r\n  /**\r\n   * Clears all cached instances.\r\n   * Note: Does not dispose instances - call getAllInstances() first if disposal is needed.\r\n   */\r\n  clear(): void {\r\n    this.instances.clear();\r\n  }\r\n\r\n  /**\r\n   * Returns all cached instances for disposal purposes.\r\n   * Used by ScopeManager to dispose Disposable services.\r\n   *\r\n   * @returns A map of all cached instances\r\n   */\r\n  getAllInstances(): Map<InjectionToken<ServiceType>, ServiceType> {\r\n    return new Map(this.instances);\r\n  }\r\n}\r\n","import type { InjectionToken } from \"@/di_infrastructure/types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\n\r\n/**\r\n * Snapshot of current metrics data.\r\n * Provides read-only access to collected performance metrics.\r\n */\r\nexport interface MetricsSnapshot {\r\n  /** Total number of container service resolutions */\r\n  containerResolutions: number;\r\n  /** Number of failed resolution attempts */\r\n  resolutionErrors: number;\r\n  /** Average resolution time in milliseconds (rolling window) */\r\n  avgResolutionTimeMs: number;\r\n  /** Count of port selections by Foundry version */\r\n  portSelections: Record<number, number>;\r\n  /** Count of port selection failures by Foundry version */\r\n  portSelectionFailures: Record<number, number>;\r\n  /** Cache hit rate as percentage (0-100) */\r\n  cacheHitRate: number;\r\n}\r\n\r\n/**\r\n * Singleton metrics collector for observability and performance tracking.\r\n *\r\n * Collects performance metrics for:\r\n * - Container service resolutions\r\n * - Port selections\r\n * - Cache hit/miss rates\r\n *\r\n * Metrics are only collected when ENV.enablePerformanceTracking is true.\r\n *\r\n * @remarks\r\n * This is a singleton to ensure metrics are collected across the entire\r\n * application lifecycle. Access via MetricsCollector.getInstance().\r\n *\r\n * @example\r\n * ```typescript\r\n * const collector = MetricsCollector.getInstance();\r\n * collector.recordResolution(token, 2.5, true);\r\n *\r\n * const snapshot = collector.getSnapshot();\r\n * console.log(`Avg resolution time: ${snapshot.avgResolutionTimeMs}ms`);\r\n * ```\r\n */\r\nexport class MetricsCollector {\r\n  private static instance: MetricsCollector | null = null;\r\n\r\n  private metrics = {\r\n    containerResolutions: 0,\r\n    resolutionErrors: 0,\r\n    cacheHits: 0,\r\n    cacheMisses: 0,\r\n    portSelections: new Map<number, number>(),\r\n    portSelectionFailures: new Map<number, number>(),\r\n  };\r\n\r\n  // Circular buffer for resolution times (more efficient than array shift)\r\n  private resolutionTimes = new Float64Array(100);\r\n  private resolutionTimesIndex = 0;\r\n  private resolutionTimesCount = 0;\r\n  private readonly MAX_RESOLUTION_TIMES = 100;\r\n\r\n  private constructor() {}\r\n\r\n  /**\r\n   * Gets the singleton instance of MetricsCollector.\r\n   *\r\n   * @returns The singleton MetricsCollector instance\r\n   */\r\n  static getInstance(): MetricsCollector {\r\n    if (!this.instance) {\r\n      this.instance = new MetricsCollector();\r\n    }\r\n    return this.instance;\r\n  }\r\n\r\n  /**\r\n   * Records a service resolution attempt.\r\n   *\r\n   * @param token - The injection token that was resolved\r\n   * @param durationMs - Time taken to resolve in milliseconds\r\n   * @param success - Whether resolution succeeded\r\n   */\r\n  recordResolution(token: InjectionToken<ServiceType>, durationMs: number, success: boolean): void {\r\n    this.metrics.containerResolutions++;\r\n\r\n    if (!success) {\r\n      this.metrics.resolutionErrors++;\r\n    }\r\n\r\n    // Circular buffer: O(1) instead of O(n) with array shift\r\n    this.resolutionTimes[this.resolutionTimesIndex] = durationMs;\r\n    this.resolutionTimesIndex = (this.resolutionTimesIndex + 1) % this.MAX_RESOLUTION_TIMES;\r\n    this.resolutionTimesCount = Math.min(this.resolutionTimesCount + 1, this.MAX_RESOLUTION_TIMES);\r\n  }\r\n\r\n  /**\r\n   * Records a port selection event.\r\n   *\r\n   * @param version - The Foundry version for which a port was selected\r\n   */\r\n  recordPortSelection(version: number): void {\r\n    const count = this.metrics.portSelections.get(version) ?? 0;\r\n    this.metrics.portSelections.set(version, count + 1);\r\n  }\r\n\r\n  /**\r\n   * Records a port selection failure.\r\n   *\r\n   * Useful for tracking when no compatible port is available for a version.\r\n   *\r\n   * @param version - The Foundry version for which port selection failed\r\n   */\r\n  recordPortSelectionFailure(version: number): void {\r\n    const count = this.metrics.portSelectionFailures.get(version) ?? 0;\r\n    this.metrics.portSelectionFailures.set(version, count + 1);\r\n  }\r\n\r\n  /**\r\n   * Records a cache access (hit or miss).\r\n   *\r\n   * @param hit - True if cache hit, false if cache miss\r\n   */\r\n  recordCacheAccess(hit: boolean): void {\r\n    if (hit) {\r\n      this.metrics.cacheHits++;\r\n    } else {\r\n      this.metrics.cacheMisses++;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Gets a snapshot of current metrics.\r\n   *\r\n   * @returns Immutable snapshot of metrics data\r\n   */\r\n  getSnapshot(): MetricsSnapshot {\r\n    // Calculate average from circular buffer\r\n    let sum = 0;\r\n    for (let i = 0; i < this.resolutionTimesCount; i++) {\r\n      sum += this.resolutionTimes[i]!;\r\n    }\r\n    const avgTime = this.resolutionTimesCount > 0 ? sum / this.resolutionTimesCount : 0;\r\n\r\n    const totalCacheAccess = this.metrics.cacheHits + this.metrics.cacheMisses;\r\n    const cacheHitRate =\r\n      totalCacheAccess > 0 ? (this.metrics.cacheHits / totalCacheAccess) * 100 : 0;\r\n\r\n    return {\r\n      containerResolutions: this.metrics.containerResolutions,\r\n      resolutionErrors: this.metrics.resolutionErrors,\r\n      avgResolutionTimeMs: avgTime,\r\n      portSelections: Object.fromEntries(this.metrics.portSelections),\r\n      portSelectionFailures: Object.fromEntries(this.metrics.portSelectionFailures),\r\n      cacheHitRate,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Logs a formatted metrics summary to the console.\r\n   * Uses console.table() for easy-to-read tabular output.\r\n   */\r\n  logSummary(): void {\r\n    const snapshot = this.getSnapshot();\r\n\r\n    /* eslint-disable @typescript-eslint/naming-convention */\r\n    console.table({\r\n      \"Total Resolutions\": snapshot.containerResolutions,\r\n      Errors: snapshot.resolutionErrors,\r\n      \"Avg Time (ms)\": snapshot.avgResolutionTimeMs.toFixed(2),\r\n      \"Cache Hit Rate\": `${snapshot.cacheHitRate.toFixed(1)}%`,\r\n    });\r\n    /* eslint-enable @typescript-eslint/naming-convention */\r\n  }\r\n\r\n  /**\r\n   * Resets all collected metrics.\r\n   * Useful for testing or starting fresh measurements.\r\n   */\r\n  reset(): void {\r\n    this.metrics = {\r\n      containerResolutions: 0,\r\n      resolutionErrors: 0,\r\n      cacheHits: 0,\r\n      cacheMisses: 0,\r\n      portSelections: new Map(),\r\n      portSelectionFailures: new Map(),\r\n    };\r\n    this.resolutionTimes = new Float64Array(100);\r\n    this.resolutionTimesIndex = 0;\r\n    this.resolutionTimesCount = 0;\r\n  }\r\n}\r\n","/**\r\n * Log level enumeration for controlling logging verbosity.\r\n * Lower numeric values = more verbose.\r\n */\r\nexport enum LogLevel {\r\n  DEBUG = 0,\r\n  INFO = 1,\r\n  WARN = 2,\r\n  ERROR = 3,\r\n}\r\n\r\n/**\r\n * Environment configuration for the application.\r\n * Provides environment-specific settings that can be configured via build-time variables.\r\n */\r\nexport interface EnvironmentConfig {\r\n  /** True if running in development mode */\r\n  isDevelopment: boolean;\r\n\r\n  /** True if running in production mode */\r\n  isProduction: boolean;\r\n\r\n  /** Minimum log level to output */\r\n  logLevel: LogLevel;\r\n\r\n  /** Enable performance tracking and metrics */\r\n  enablePerformanceTracking: boolean;\r\n\r\n  /** Enable debug mode features (verbose logging, performance marks, etc.) */\r\n  enableDebugMode: boolean;\r\n}\r\n\r\n/**\r\n * Current environment configuration.\r\n * Reads from Vite environment variables (import.meta.env).\r\n */\r\nexport const ENV: EnvironmentConfig = {\r\n  isDevelopment: import.meta.env.MODE === \"development\",\r\n  isProduction: import.meta.env.MODE === \"production\",\r\n  logLevel: import.meta.env.MODE === \"development\" ? LogLevel.DEBUG : LogLevel.INFO,\r\n  enablePerformanceTracking: import.meta.env.VITE_ENABLE_PERF_TRACKING === \"true\",\r\n  enableDebugMode: import.meta.env.MODE === \"development\",\r\n};\r\n","import type { Result } from \"@/types/result\";\r\nimport type { InjectionToken } from \"../types/injectiontoken\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport type { ContainerError } from \"../interfaces/containererror\";\r\nimport type { ServiceRegistry } from \"../registry/ServiceRegistry\";\r\nimport type { ServiceRegistration } from \"../types/serviceregistration\";\r\nimport { InstanceCache } from \"../cache/InstanceCache\";\r\nimport { ServiceLifecycle } from \"../types/servicelifecycle\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { MetricsCollector } from \"@/observability/metrics-collector\";\r\nimport { ENV } from \"@/config/environment\";\r\n\r\n/**\r\n * Resolves service instances based on lifecycle and registration.\r\n *\r\n * Responsibilities:\r\n * - Resolve services by token\r\n * - Handle lifecycle strategies (Singleton, Transient, Scoped)\r\n * - Handle alias resolution\r\n * - Delegate to parent resolver for Singletons\r\n *\r\n * Design:\r\n * - Works with Result pattern (no throws)\r\n * - Wraps factory errors in FactoryFailedError\r\n * - Parent resolver for Singleton sharing across scopes\r\n */\r\nexport class ServiceResolver {\r\n  constructor(\r\n    private readonly registry: ServiceRegistry,\r\n    private readonly cache: InstanceCache,\r\n    private readonly parentResolver: ServiceResolver | null,\r\n    private readonly scopeName: string\r\n  ) {}\r\n\r\n  /**\r\n   * Resolves a service by token.\r\n   *\r\n   * Handles:\r\n   * - Alias resolution (recursive)\r\n   * - Lifecycle-specific resolution (Singleton/Transient/Scoped)\r\n   * - Parent delegation for Singletons\r\n   * - Factory error wrapping\r\n   *\r\n   * @template TServiceType - The type of service to resolve\r\n   * @param token - The injection token identifying the service\r\n   * @returns Result with service instance or error\r\n   */\r\n  resolve<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>\r\n  ): Result<TServiceType, ContainerError> {\r\n    const startTime = ENV.enablePerformanceTracking ? performance.now() : 0;\r\n\r\n    // Check if service is registered\r\n    const registration = this.registry.getRegistration(token);\r\n    if (!registration) {\r\n      const error: ContainerError = {\r\n        code: \"TokenNotRegistered\",\r\n        message: `Service ${String(token)} not registered`,\r\n        tokenDescription: String(token),\r\n      };\r\n      const result = err(error);\r\n\r\n      /* c8 ignore next 4 -- Performance tracking is optional feature flag tested in integration tests */\r\n      if (ENV.enablePerformanceTracking) {\r\n        const duration = performance.now() - startTime;\r\n        MetricsCollector.getInstance().recordResolution(token, duration, false);\r\n      }\r\n\r\n      return result;\r\n    }\r\n\r\n    // Handle alias resolution\r\n    if (registration.providerType === \"alias\" && registration.aliasTarget) {\r\n      return this.resolve(registration.aliasTarget as InjectionToken<TServiceType>);\r\n    }\r\n\r\n    // Resolve based on lifecycle (all methods already return Result)\r\n    let result: Result<TServiceType, ContainerError>;\r\n\r\n    switch (registration.lifecycle) {\r\n      case ServiceLifecycle.SINGLETON:\r\n        result = this.resolveSingleton(token, registration);\r\n        break;\r\n\r\n      case ServiceLifecycle.TRANSIENT:\r\n        result = this.resolveTransient(token, registration);\r\n        break;\r\n\r\n      case ServiceLifecycle.SCOPED:\r\n        result = this.resolveScoped(token, registration);\r\n        break;\r\n\r\n      /* c8 ignore next 6 -- Defensive: ServiceLifecycle enum ensures only valid values; this default is unreachable */\r\n      default:\r\n        result = err({\r\n          code: \"InvalidLifecycle\",\r\n          message: `Invalid service lifecycle: ${String(registration.lifecycle)}`,\r\n          tokenDescription: String(token),\r\n        });\r\n    }\r\n\r\n    if (ENV.enablePerformanceTracking) {\r\n      const duration = performance.now() - startTime;\r\n      MetricsCollector.getInstance().recordResolution(token, duration, result.ok);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Instantiates a service based on registration type.\r\n   *\r\n   * CRITICAL: Returns Result to preserve error context and avoid breaking Result-Contract.\r\n   * Handles dependency resolution for classes, direct factory calls, and value returns.\r\n   *\r\n   * @template TServiceType - The type of service to instantiate\r\n   * @param token - The injection token (used for error messages)\r\n   * @param registration - The service registration metadata\r\n   * @returns Result with instance or detailed error (DependencyResolveFailed, FactoryFailed, etc.)\r\n   */\r\n  private instantiateService<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    registration: ServiceRegistration\r\n  ): Result<TServiceType, ContainerError> {\r\n    if (registration.serviceClass) {\r\n      // Class: Resolve all dependencies first\r\n      const resolvedDeps: ServiceType[] = [];\r\n\r\n      for (const dep of registration.dependencies) {\r\n        const depResult = this.resolve(dep);\r\n        /* c8 ignore next 9 -- Dependency resolution failures tested via circular dependency and missing dependency tests */\r\n        if (!depResult.ok) {\r\n          // Return structured error with cause chain\r\n          return err({\r\n            code: \"DependencyResolveFailed\",\r\n            message: `Cannot resolve dependency ${String(dep)} for ${String(token)}`,\r\n            tokenDescription: String(dep),\r\n            cause: depResult.error,\r\n          });\r\n        }\r\n        resolvedDeps.push(depResult.value);\r\n      }\r\n\r\n      // Instantiate class with resolved dependencies\r\n      try {\r\n        return ok(new registration.serviceClass(...resolvedDeps) as TServiceType);\r\n      } catch (constructorError) {\r\n        return err({\r\n          code: \"FactoryFailed\",\r\n          message: `Constructor failed for ${String(token)}: ${String(constructorError)}`,\r\n          tokenDescription: String(token),\r\n          cause: constructorError,\r\n        });\r\n      }\r\n    } else if (registration.factory) {\r\n      // Factory: Call directly\r\n      try {\r\n        return ok(registration.factory() as TServiceType);\r\n      } catch (factoryError) {\r\n        return err({\r\n          code: \"FactoryFailed\",\r\n          message: `Factory failed for ${String(token)}: ${String(factoryError)}`,\r\n          tokenDescription: String(token),\r\n          cause: factoryError,\r\n        });\r\n      }\r\n    } else if (registration.value !== undefined) {\r\n      // Value: Return as-is\r\n      return ok(registration.value as TServiceType);\r\n    } else {\r\n      // Invalid registration\r\n      /* c8 ignore next 5 -- Defensive: ServiceRegistration.create* methods already ensure one of class/factory/value is set */\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: `Invalid registration for ${String(token)} - no class, factory, or value`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Resolves a Singleton service.\r\n   *\r\n   * Strategy:\r\n   * 1. Try parent resolver first (for shared parent singletons)\r\n   * 2. If parent returns error:\r\n   *    - CircularDependency ‚Üí propagate error\r\n   *    - TokenNotRegistered ‚Üí fallback to own cache (child-specific singleton)\r\n   * 3. Use own cache for root container or child-specific singletons\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param token - The injection token\r\n   * @param registration - The service registration\r\n   * @returns Result with instance or error\r\n   */\r\n  private resolveSingleton<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    registration: ServiceRegistration\r\n  ): Result<TServiceType, ContainerError> {\r\n    // Try parent resolver first for shared singletons\r\n    if (this.parentResolver !== null) {\r\n      const parentResult = this.parentResolver.resolve(token);\r\n\r\n      if (parentResult.ok) {\r\n        // Parent has it - use parent's singleton instance (shared)\r\n        return parentResult;\r\n      }\r\n\r\n      // Check error code to determine action\r\n      /* c8 ignore next 4 -- Circular dependency from parent requires complex multi-level dependency setup that's already tested in container.test.ts */\r\n      if (parentResult.error.code === \"CircularDependency\") {\r\n        // Real circular dependency - propagate as-is\r\n        return parentResult;\r\n      }\r\n\r\n      // TokenNotRegistered or other error -> fallback to own cache\r\n      // This allows child-specific singleton registrations\r\n    }\r\n\r\n    // Root container OR parent doesn't have it: use own cache\r\n    if (!this.cache.has(token)) {\r\n      const instanceResult = this.instantiateService(token, registration);\r\n      if (!instanceResult.ok) {\r\n        return instanceResult; // Propagate error without wrapping\r\n      }\r\n      this.cache.set(token, instanceResult.value);\r\n    }\r\n\r\n    return ok(this.cache.get(token) as TServiceType);\r\n  }\r\n\r\n  /**\r\n   * Resolves a Transient service.\r\n   *\r\n   * Strategy:\r\n   * - Always create new instance (no caching)\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param token - The injection token\r\n   * @param registration - The service registration\r\n   * @returns Result with new instance\r\n   */\r\n  private resolveTransient<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    registration: ServiceRegistration\r\n  ): Result<TServiceType, ContainerError> {\r\n    return this.instantiateService(token, registration);\r\n  }\r\n\r\n  /**\r\n   * Resolves a Scoped service.\r\n   *\r\n   * ‚ö†Ô∏è IMPORTANT: Scoped services can ONLY be resolved in child containers.\r\n   * Attempting to resolve a scoped service in the root container will return\r\n   * a ScopeRequired error.\r\n   *\r\n   * Strategy:\r\n   * - Must be in child scope (not root)\r\n   * - One instance per scope (cached)\r\n   * - Each child scope gets its own isolated instance\r\n   *\r\n   * Use createScope() to create a child container before resolving scoped services.\r\n   *\r\n   * @template TServiceType - The type of service\r\n   * @param token - The injection token\r\n   * @param registration - The service registration\r\n   * @returns Result with scoped instance or ScopeRequired error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // ‚ùå WRONG: Trying to resolve scoped service in root\r\n   * const root = ServiceContainer.createRoot();\r\n   * root.registerClass(RequestToken, RequestContext, SCOPED);\r\n   * root.validate();\r\n   * const result = root.resolve(RequestToken); // Error: ScopeRequired\r\n   *\r\n   * // ‚úÖ CORRECT: Create child scope first\r\n   * const child = root.createScope(\"request\").value!;\r\n   * child.validate(); // Child must validate separately\r\n   * const ctx = child.resolve(RequestToken); // OK\r\n   * ```\r\n   */\r\n  private resolveScoped<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    registration: ServiceRegistration\r\n  ): Result<TServiceType, ContainerError> {\r\n    // Scoped services require a child scope\r\n    if (this.parentResolver === null) {\r\n      return err({\r\n        code: \"ScopeRequired\",\r\n        message: `Scoped service ${String(token)} requires a scope container. Use createScope() to create a child container first.`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    // Check cache (one instance per scope)\r\n    if (!this.cache.has(token)) {\r\n      const instanceResult = this.instantiateService(token, registration);\r\n      /* c8 ignore next 3 -- Error path covered by other instantiation tests; this is just error propagation */\r\n      if (!instanceResult.ok) {\r\n        return instanceResult; // Propagate error\r\n      }\r\n      this.cache.set(token, instanceResult.value);\r\n    }\r\n\r\n    return ok(this.cache.get(token) as TServiceType);\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { ContainerError } from \"../interfaces/containererror\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport type { Disposable, AsyncDisposable } from \"../interfaces/disposable\";\r\nimport { InstanceCache } from \"../cache/InstanceCache\";\r\nimport { ok, err, tryCatch, isErr } from \"@/utils/result\";\r\n\r\n/**\r\n * Helper function to generate unique scope names.\r\n * Tries crypto.randomUUID(), falls back to timestamp + random.\r\n */\r\nfunction generateScopeId(): string {\r\n  try {\r\n    /* c8 ignore next -- Delegates to browser crypto implementation */\r\n    return crypto.randomUUID();\r\n  } catch {\r\n    return Date.now() + \"-\" + Math.random();\r\n  }\r\n}\r\n\r\n/**\r\n * Manages scope hierarchy and disposal lifecycle.\r\n *\r\n * Responsibilities:\r\n * - Track child scopes in hierarchy\r\n * - Generate scope names\r\n * - Dispose instances (supports both Disposable and AsyncDisposable patterns)\r\n * - Cascade disposal to children\r\n * - Enforce maximum scope depth (stack overflow protection)\r\n *\r\n * Design:\r\n * - NO dependency on ServiceResolver (avoids circular dependency)\r\n * - createChild() returns data for facade to build new container\r\n * - Disposal order: children first, then instances (critical!)\r\n * - Supports both sync (dispose()) and async (disposeAsync()) disposal modes\r\n *\r\n * Disposal Modes:\r\n * - dispose(): Synchronous disposal (for browser unload, emergency cleanup)\r\n * - disposeAsync(): Asynchronous disposal (preferred, handles async cleanup properly)\r\n */\r\nexport class ScopeManager {\r\n  private readonly MAX_SCOPE_DEPTH = 10; // Prevent deep nesting and potential stack overflow\r\n  private children = new Set<ScopeManager>();\r\n  private disposed = false;\r\n  private readonly depth: number;\r\n  private readonly scopeId: string; // Unique correlation ID for tracing\r\n\r\n  constructor(\r\n    private readonly scopeName: string,\r\n    private readonly parent: ScopeManager | null,\r\n    private readonly cache: InstanceCache,\r\n    depth: number = 0\r\n  ) {\r\n    this.depth = depth;\r\n    // Generate unique correlation ID for this scope (useful for logging/tracing)\r\n    this.scopeId = `${scopeName}-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;\r\n  }\r\n\r\n  /**\r\n   * Creates a child scope manager.\r\n   *\r\n   * Note: Returns data (scopeName, cache, childManager) instead of full container\r\n   * to avoid circular dependency with ServiceResolver.\r\n   *\r\n   * @param name - Optional custom name for the scope\r\n   * @returns Result with child scope data or error if disposed or max depth exceeded\r\n   */\r\n  createChild(\r\n    name?: string\r\n  ): Result<{ scopeName: string; cache: InstanceCache; manager: ScopeManager }, ContainerError> {\r\n    if (this.disposed) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot create child scope from disposed scope: ${this.scopeName}`,\r\n      });\r\n    }\r\n\r\n    // Check maximum scope depth (stack overflow protection)\r\n    if (this.depth >= this.MAX_SCOPE_DEPTH) {\r\n      return err({\r\n        code: \"MaxScopeDepthExceeded\",\r\n        message: `Maximum scope depth of ${this.MAX_SCOPE_DEPTH} exceeded. Current depth: ${this.depth}`,\r\n      });\r\n    }\r\n\r\n    // Build hierarchical scope name\r\n    const uniqueId = name ?? `scope-${generateScopeId()}`;\r\n    const childScopeName = `${this.scopeName}.${uniqueId}`;\r\n\r\n    // Create new cache for child\r\n    const childCache = new InstanceCache();\r\n\r\n    // Create child manager with incremented depth\r\n    const childManager = new ScopeManager(childScopeName, this, childCache, this.depth + 1);\r\n\r\n    // Only add to children set AFTER successful creation\r\n    this.children.add(childManager);\r\n\r\n    return ok({\r\n      scopeName: childScopeName,\r\n      cache: childCache,\r\n      manager: childManager,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Disposes this scope and all child scopes.\r\n   *\r\n   * Disposal order (critical):\r\n   * 1. Recursively dispose all children\r\n   * 2. Dispose instances in this scope (if Disposable)\r\n   * 3. Clear instance cache\r\n   * 4. Remove from parent's children set\r\n   *\r\n   * @returns Result indicating success or disposal error\r\n   */\r\n  dispose(): Result<void, ContainerError> {\r\n    if (this.disposed) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Scope already disposed: ${this.scopeName}`,\r\n      });\r\n    }\r\n\r\n    // Mark as disposed BEFORE disposing children to prevent concurrent operations\r\n    this.disposed = true;\r\n\r\n    // Collect disposal errors instead of logging\r\n    const childDisposalErrors: Array<{ scopeName: string; error: ContainerError }> = [];\r\n\r\n    // Step 1: Recursively dispose all child scopes (children first!)\r\n    for (const child of this.children) {\r\n      const childResult = child.dispose();\r\n\r\n      if (isErr(childResult)) {\r\n        // Collect error instead of logging\r\n        childDisposalErrors.push({\r\n          scopeName: child.scopeName,\r\n          error: childResult.error,\r\n        });\r\n      }\r\n    }\r\n\r\n    // Step 2: Dispose instances in this scope\r\n    const disposeResult = this.disposeInstances();\r\n    if (!disposeResult.ok) {\r\n      return disposeResult;\r\n    }\r\n\r\n    // Step 3: Clear cache\r\n    this.cache.clear();\r\n\r\n    // Step 4: Remove from parent's children set\r\n    if (this.parent !== null) {\r\n      this.parent.children.delete(this);\r\n    }\r\n\r\n    // Return aggregated errors if any children failed\r\n    if (childDisposalErrors.length > 0) {\r\n      return err({\r\n        code: \"PartialDisposal\",\r\n        message: `Failed to dispose ${childDisposalErrors.length} child scope(s)`,\r\n        details: childDisposalErrors,\r\n      });\r\n    }\r\n\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Asynchronously disposes this scope and all child scopes.\r\n   *\r\n   * Preferred method for cleanup as it properly handles async dispose operations.\r\n   * Falls back to sync dispose() for services that only implement Disposable.\r\n   *\r\n   * Disposal order (critical):\r\n   * 1. Recursively dispose all children (async)\r\n   * 2. Dispose instances in this scope (async or sync)\r\n   * 3. Clear instance cache\r\n   * 4. Remove from parent's children set\r\n   *\r\n   * @returns Promise with Result indicating success or disposal error\r\n   */\r\n  async disposeAsync(): Promise<Result<void, ContainerError>> {\r\n    if (this.disposed) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Scope already disposed: ${this.scopeName}`,\r\n      });\r\n    }\r\n\r\n    // Mark as disposed BEFORE disposing children to prevent concurrent operations\r\n    this.disposed = true;\r\n\r\n    // Collect disposal errors instead of logging\r\n    const childDisposalErrors: Array<{ scopeName: string; error: ContainerError }> = [];\r\n\r\n    // Step 1: Recursively dispose all child scopes (children first!)\r\n    for (const child of this.children) {\r\n      const childResult = await child.disposeAsync();\r\n\r\n      if (isErr(childResult)) {\r\n        // Collect error instead of logging\r\n        childDisposalErrors.push({\r\n          scopeName: child.scopeName,\r\n          error: childResult.error,\r\n        });\r\n      }\r\n    }\r\n\r\n    // Step 2: Dispose instances in this scope (async)\r\n    const disposeResult = await this.disposeInstancesAsync();\r\n    if (!disposeResult.ok) {\r\n      return disposeResult;\r\n    }\r\n\r\n    // Step 3: Clear cache\r\n    this.cache.clear();\r\n\r\n    // Step 4: Remove from parent's children set\r\n    if (this.parent !== null) {\r\n      this.parent.children.delete(this);\r\n    }\r\n\r\n    // Return aggregated errors if any children failed\r\n    if (childDisposalErrors.length > 0) {\r\n      return err({\r\n        code: \"PartialDisposal\",\r\n        message: `Failed to dispose ${childDisposalErrors.length} child scope(s)`,\r\n        details: childDisposalErrors,\r\n      });\r\n    }\r\n\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Disposes all instances in the cache that implement Disposable (sync).\r\n   *\r\n   * @returns Result indicating success or disposal error\r\n   */\r\n  private disposeInstances(): Result<void, ContainerError> {\r\n    const instances = this.cache.getAllInstances();\r\n\r\n    for (const [token, instance] of instances.entries()) {\r\n      if (this.isDisposable(instance)) {\r\n        const result = tryCatch(\r\n          () => instance.dispose(),\r\n          (error): ContainerError => ({\r\n            code: \"DisposalFailed\",\r\n            message: `Error disposing service ${String(token)}: ${String(error)}`,\r\n            tokenDescription: String(token),\r\n            cause: error,\r\n          })\r\n        );\r\n\r\n        if (isErr(result)) {\r\n          return result;\r\n        }\r\n      }\r\n    }\r\n\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Disposes all instances in the cache that implement Disposable or AsyncDisposable (async).\r\n   * Prefers async disposal when available, falls back to sync.\r\n   *\r\n   * @returns Promise with Result indicating success or disposal error\r\n   */\r\n  private async disposeInstancesAsync(): Promise<Result<void, ContainerError>> {\r\n    const instances = this.cache.getAllInstances();\r\n\r\n    for (const [token, instance] of instances.entries()) {\r\n      // Try async disposal first (preferred)\r\n      if (this.isAsyncDisposable(instance)) {\r\n        try {\r\n          await instance.disposeAsync();\r\n        } catch (error) {\r\n          return err({\r\n            code: \"DisposalFailed\",\r\n            message: `Error disposing service ${String(token)}: ${String(error)}`,\r\n            tokenDescription: String(token),\r\n            cause: error,\r\n          });\r\n        }\r\n      }\r\n      // Fallback to sync disposal\r\n      else if (this.isDisposable(instance)) {\r\n        const result = tryCatch(\r\n          () => instance.dispose(),\r\n          (error): ContainerError => ({\r\n            code: \"DisposalFailed\",\r\n            message: `Error disposing service ${String(token)}: ${String(error)}`,\r\n            tokenDescription: String(token),\r\n            cause: error,\r\n          })\r\n        );\r\n\r\n        if (isErr(result)) {\r\n          return result;\r\n        }\r\n      }\r\n    }\r\n\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Type guard to check if an instance implements the Disposable pattern.\r\n   *\r\n   * @param instance - The service instance to check\r\n   * @returns True if instance has dispose() method\r\n   */\r\n  private isDisposable(instance: ServiceType): instance is ServiceType & Disposable {\r\n    return \"dispose\" in instance && typeof (instance as Partial<Disposable>).dispose === \"function\";\r\n  }\r\n\r\n  /**\r\n   * Type guard to check if an instance implements the AsyncDisposable pattern.\r\n   *\r\n   * @param instance - The service instance to check\r\n   * @returns True if instance has disposeAsync() method\r\n   */\r\n  private isAsyncDisposable(instance: ServiceType): instance is ServiceType & AsyncDisposable {\r\n    return (\r\n      \"disposeAsync\" in instance &&\r\n      typeof (instance as Partial<AsyncDisposable>).disposeAsync === \"function\"\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Checks if this scope is disposed.\r\n   *\r\n   * @returns True if disposed, false otherwise\r\n   */\r\n  isDisposed(): boolean {\r\n    return this.disposed;\r\n  }\r\n\r\n  /**\r\n   * Gets the hierarchical scope name.\r\n   *\r\n   * @returns The scope name (e.g., \"root.child1.grandchild\")\r\n   */\r\n  getScopeName(): string {\r\n    return this.scopeName;\r\n  }\r\n\r\n  /**\r\n   * Gets the unique correlation ID for this scope.\r\n   *\r\n   * Useful for tracing and logging in distributed/concurrent scenarios.\r\n   * Each scope gets a unique ID combining name, timestamp, and random string.\r\n   *\r\n   * @returns The unique scope ID (e.g., \"root-1730761234567-abc123\")\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const scope = container.createScope(\"request\").value!;\r\n   * logger.info(`[${scope.getScopeId()}] Processing request`);\r\n   * ```\r\n   */\r\n  getScopeId(): string {\r\n    return this.scopeId;\r\n  }\r\n}\r\n","import type { InjectionToken } from \"./types/injectiontoken\";\r\nimport type { FactoryFunction } from \"./types/servicefactory\";\r\nimport type { ServiceClass } from \"./types/serviceclass\";\r\nimport type { ServiceDependencies } from \"./types/servicedependencies\";\r\nimport type { ContainerValidationState } from \"./types/containervalidationstate\";\r\nimport type { ApiSafeToken } from \"./types/api-safe-token\";\r\nimport { isApiSafeTokenRuntime } from \"./types/api-safe-token\";\r\nimport { ServiceLifecycle } from \"@/di_infrastructure/types/servicelifecycle\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport { ok, err, isOk } from \"@/utils/result\";\r\nimport type { Result } from \"@/types/result\";\r\nimport type { Container } from \"@/di_infrastructure/interfaces/container\";\r\nimport type { ContainerError } from \"@/di_infrastructure/interfaces/containererror\";\r\nimport { ServiceRegistry } from \"./registry/ServiceRegistry\";\r\nimport { ContainerValidator } from \"./validation/ContainerValidator\";\r\nimport { InstanceCache } from \"./cache/InstanceCache\";\r\nimport { ServiceResolver } from \"./resolution/ServiceResolver\";\r\nimport { ScopeManager } from \"./scope/ScopeManager\";\r\n\r\n/**\r\n * Fallback factory function type for creating service instances when container resolution fails.\r\n */\r\ntype FallbackFactory<T extends ServiceType> = () => T;\r\n\r\n/**\r\n * Dependency injection container (Facade pattern).\r\n *\r\n * Delegates to specialized components:\r\n * - ServiceRegistry: manages registrations\r\n * - ContainerValidator: validates dependencies\r\n * - InstanceCache: caches instances\r\n * - ServiceResolver: resolves services\r\n * - ScopeManager: manages lifecycle and disposal\r\n *\r\n * **Scope Chain Behavior:**\r\n * When a parent container is disposed, all child containers are automatically disposed.\r\n * This ensures proper cleanup of resources across the container hierarchy.\r\n *\r\n * **Architecture:**\r\n * This is a Facade that coordinates specialized components, adhering to Single Responsibility Principle.\r\n * Each component has a focused responsibility, making the system testable and maintainable.\r\n *\r\n * @example\r\n * ```typescript\r\n * // Basic usage\r\n * const container = ServiceContainer.createRoot();\r\n * container.registerClass(LoggerToken, Logger, ServiceLifecycle.SINGLETON);\r\n * container.validate();\r\n * const logger = container.resolve(LoggerToken);\r\n * ```\r\n *\r\n * @example\r\n * ```typescript\r\n * // Scope chain with cascading disposal\r\n * const root = ServiceContainer.createRoot();\r\n * root.validate();\r\n * const child1 = root.createScope(\"child1\").value!;\r\n * const child2 = root.createScope(\"child2\").value!;\r\n *\r\n * // Disposing root automatically disposes all children\r\n * root.dispose();\r\n * ```\r\n */\r\nexport class ServiceContainer implements Container {\r\n  private registry: ServiceRegistry;\r\n  private validator: ContainerValidator;\r\n  private cache: InstanceCache;\r\n  private resolver: ServiceResolver;\r\n  private scopeManager: ScopeManager;\r\n  private validationState: ContainerValidationState;\r\n  private fallbackFactories = new Map<symbol, FallbackFactory<ServiceType>>();\r\n  private validationPromise: Promise<Result<void, ContainerError[]>> | null = null;\r\n\r\n  /**\r\n   * Private constructor - use ServiceContainer.createRoot() instead.\r\n   *\r\n   * This constructor is private to:\r\n   * - Enforce factory pattern usage\r\n   * - Prevent constructor throws (Result-Contract-breaking)\r\n   * - Make child creation explicit through createScope()\r\n   *\r\n   * @param registry - Service registry\r\n   * @param validator - Container validator (shared for parent/child)\r\n   * @param cache - Instance cache\r\n   * @param resolver - Service resolver\r\n   * @param scopeManager - Scope manager\r\n   * @param validationState - Initial validation state\r\n   */\r\n  private constructor(\r\n    registry: ServiceRegistry,\r\n    validator: ContainerValidator,\r\n    cache: InstanceCache,\r\n    resolver: ServiceResolver,\r\n    scopeManager: ScopeManager,\r\n    validationState: ContainerValidationState\r\n  ) {\r\n    this.registry = registry;\r\n    this.validator = validator;\r\n    this.cache = cache;\r\n    this.resolver = resolver;\r\n    this.scopeManager = scopeManager;\r\n    this.validationState = validationState;\r\n  }\r\n\r\n  /**\r\n   * Creates a new root container.\r\n   *\r\n   * This is the preferred way to create containers.\r\n   * All components are created fresh for the root container.\r\n   *\r\n   * @returns A new root ServiceContainer\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const container = ServiceContainer.createRoot();\r\n   * container.registerClass(LoggerToken, Logger, SINGLETON);\r\n   * container.validate();\r\n   * ```\r\n   */\r\n  static createRoot(): ServiceContainer {\r\n    const registry = new ServiceRegistry();\r\n    const validator = new ContainerValidator();\r\n    const cache = new InstanceCache();\r\n    const scopeManager = new ScopeManager(\"root\", null, cache);\r\n    const resolver = new ServiceResolver(registry, cache, null, \"root\");\r\n\r\n    return new ServiceContainer(registry, validator, cache, resolver, scopeManager, \"registering\");\r\n  }\r\n\r\n  /**\r\n   * Register a service class with automatic dependency injection.\r\n   */\r\n  registerClass<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    serviceClass: ServiceClass<TServiceType>,\r\n    lifecycle: ServiceLifecycle\r\n  ): Result<void, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot register service on disposed container`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.validationState === \"validated\") {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"Cannot register after validation\",\r\n      });\r\n    }\r\n\r\n    return this.registry.registerClass(token, serviceClass, lifecycle);\r\n  }\r\n\r\n  /**\r\n   * Register a factory function.\r\n   */\r\n  registerFactory<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    factory: FactoryFunction<TServiceType>,\r\n    lifecycle: ServiceLifecycle,\r\n    dependencies: ServiceDependencies\r\n  ): Result<void, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot register service on disposed container`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.validationState === \"validated\") {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"Cannot register after validation\",\r\n      });\r\n    }\r\n\r\n    // Validate factory parameter\r\n    /* c8 ignore next 7 -- TypeScript ensures factory is a function at compile time; runtime check is defensive */\r\n    if (!factory || typeof factory !== \"function\") {\r\n      return err({\r\n        code: \"InvalidFactory\",\r\n        message: \"Factory must be a function\",\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    return this.registry.registerFactory(token, factory, lifecycle, dependencies);\r\n  }\r\n\r\n  /**\r\n   * Register a constant value.\r\n   */\r\n  registerValue<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    value: TServiceType\r\n  ): Result<void, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot register service on disposed container`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.validationState === \"validated\") {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"Cannot register after validation\",\r\n      });\r\n    }\r\n\r\n    return this.registry.registerValue(token, value);\r\n  }\r\n\r\n  /**\r\n   * Register an alias.\r\n   */\r\n  registerAlias<TServiceType extends ServiceType>(\r\n    aliasToken: InjectionToken<TServiceType>,\r\n    targetToken: InjectionToken<TServiceType>\r\n  ): Result<void, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot register service on disposed container`,\r\n        tokenDescription: String(aliasToken),\r\n      });\r\n    }\r\n\r\n    if (this.validationState === \"validated\") {\r\n      return err({\r\n        code: \"InvalidOperation\",\r\n        message: \"Cannot register after validation\",\r\n      });\r\n    }\r\n\r\n    return this.registry.registerAlias(aliasToken, targetToken);\r\n  }\r\n\r\n  /**\r\n   * Validate all registrations.\r\n   */\r\n  validate(): Result<void, ContainerError[]> {\r\n    if (this.validationState === \"validated\") {\r\n      return ok(undefined);\r\n    }\r\n\r\n    /* c8 ignore next 8 -- Guard against concurrent validate() calls; requires re-entrant call during validation which is not possible in normal synchronous flow */\r\n    if (this.validationState === \"validating\") {\r\n      return err([\r\n        {\r\n          code: \"InvalidOperation\",\r\n          message: \"Validation already in progress\",\r\n        },\r\n      ]);\r\n    }\r\n\r\n    this.validationState = \"validating\";\r\n\r\n    const result = this.validator.validate(this.registry);\r\n\r\n    if (result.ok) {\r\n      this.validationState = \"validated\";\r\n    } else {\r\n      this.validationState = \"registering\";\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Get validation state.\r\n   */\r\n  getValidationState(): ContainerValidationState {\r\n    return this.validationState;\r\n  }\r\n\r\n  /**\r\n   * Async-safe validation for concurrent environments.\r\n   *\r\n   * Prevents race conditions when multiple callers validate simultaneously\r\n   * by ensuring only one validation runs at a time.\r\n   *\r\n   * @returns Promise resolving to validation result\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const container = ServiceContainer.createRoot();\r\n   * // ... register services\r\n   * await container.validateAsync(); // Safe for concurrent calls\r\n   * ```\r\n   */\r\n  async validateAsync(): Promise<Result<void, ContainerError[]>> {\r\n    // Return immediately if already validated\r\n    /* c8 ignore next 3 -- Fast-path optimization; tested in sync validate() */\r\n    if (this.validationState === \"validated\") {\r\n      return ok(undefined);\r\n    }\r\n\r\n    // Wait for ongoing validation\r\n    /* c8 ignore next 3 -- Race condition guard for concurrent validateAsync calls; requires complex async timing to test */\r\n    if (this.validationPromise !== null) {\r\n      return this.validationPromise;\r\n    }\r\n\r\n    // Validation already in progress (sync)\r\n    /* c8 ignore next 8 -- Mixed sync/async validation conflict; requires calling validate() then validateAsync() which is not a real use case */\r\n    if (this.validationState === \"validating\") {\r\n      return err([\r\n        {\r\n          code: \"InvalidOperation\",\r\n          message: \"Validation already in progress\",\r\n        },\r\n      ]);\r\n    }\r\n\r\n    this.validationState = \"validating\";\r\n\r\n    this.validationPromise = Promise.resolve().then(() => {\r\n      const result = this.validator.validate(this.registry);\r\n\r\n      if (result.ok) {\r\n        this.validationState = \"validated\";\r\n      } else {\r\n        this.validationState = \"registering\";\r\n      }\r\n\r\n      return result;\r\n    });\r\n\r\n    const result = await this.validationPromise;\r\n    /* c8 ignore next -- State cleanup always executed; null assignment is cleanup logic not business logic */\r\n    this.validationPromise = null;\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Creates a child scope container.\r\n   *\r\n   * Child containers:\r\n   * - Inherit parent registrations (cloned)\r\n   * - Can add their own registrations\r\n   * - Must call validate() before resolving\r\n   * - Share parent's singleton instances\r\n   * - Have isolated scoped instances\r\n   *\r\n   * @param name - Optional custom name for the scope\r\n   * @returns Result with child container or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const parent = ServiceContainer.createRoot();\r\n   * parent.registerClass(LoggerToken, Logger, SINGLETON);\r\n   * parent.validate();\r\n   *\r\n   * const child = parent.createScope(\"request\").value!;\r\n   * child.registerClass(RequestToken, RequestContext, SCOPED);\r\n   * child.validate();\r\n   *\r\n   * const logger = child.resolve(LoggerToken);   // From parent (shared)\r\n   * const ctx = child.resolve(RequestToken);      // From child (isolated)\r\n   * ```\r\n   */\r\n  createScope(name?: string): Result<ServiceContainer, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot create scope from disposed container`,\r\n      });\r\n    }\r\n\r\n    if (this.validationState !== \"validated\") {\r\n      return err({\r\n        code: \"NotValidated\",\r\n        message: \"Parent must be validated before creating scopes. Call validate() first.\",\r\n      });\r\n    }\r\n\r\n    // Create child scope (pure Result, no throws)\r\n    const scopeResult = this.scopeManager.createChild(name);\r\n    /* c8 ignore next 3 -- ScopeManager.createChild() error paths tested in ScopeManager.test.ts; this is just error propagation */\r\n    if (!scopeResult.ok) {\r\n      return err(scopeResult.error); // Structured error, not exception\r\n    }\r\n\r\n    // Build child container components\r\n    const childRegistry = this.registry.clone();\r\n    const childCache = scopeResult.value.cache;\r\n    const childManager = scopeResult.value.manager;\r\n    const childResolver = new ServiceResolver(\r\n      childRegistry,\r\n      childCache,\r\n      this.resolver, // Parent resolver for singleton delegation\r\n      scopeResult.value.scopeName\r\n    );\r\n\r\n    // Create child using private constructor\r\n    const child = new ServiceContainer(\r\n      childRegistry,\r\n      this.validator, // Shared (stateless)\r\n      childCache,\r\n      childResolver,\r\n      childManager,\r\n      \"registering\" // FIX: Child starts in registering state, not validated!\r\n    );\r\n\r\n    return ok(child);\r\n  }\r\n\r\n  /**\r\n   * Resolve service with Result return.\r\n   */\r\n  resolveWithError<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>\r\n  ): Result<TServiceType, ContainerError> {\r\n    if (this.scopeManager.isDisposed()) {\r\n      return err({\r\n        code: \"Disposed\",\r\n        message: `Cannot resolve from disposed container`,\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    if (this.validationState !== \"validated\") {\r\n      return err({\r\n        code: \"NotValidated\",\r\n        message: \"Container must be validated before resolving. Call validate() first.\",\r\n        tokenDescription: String(token),\r\n      });\r\n    }\r\n\r\n    return this.resolver.resolve(token);\r\n  }\r\n\r\n  /**\r\n   * Resolves a service instance (throws on failure).\r\n   *\r\n   * **üéØ FOR EXTERNAL API USE ONLY**\r\n   *\r\n   * This method is designed for the public ModuleApi to provide\r\n   * exception-based error handling for external Foundry VTT modules.\r\n   *\r\n   * **Enforcement (Defense-in-Depth):**\r\n   * - **Compile-Time:** Only accepts ApiSafeToken types\r\n   * - **Runtime:** Validates token has API_SAFE_RUNTIME_MARKER (always active)\r\n   *\r\n   * Internal code MUST use `resolveWithError()` for Result-based error handling.\r\n   *\r\n   * @param token - An API-safe injection token (from api.tokens)\r\n   * @returns The resolved service instance\r\n   * @throws {Error} If token is not API-safe or resolution fails\r\n   *\r\n   * @example External Module Usage\r\n   * ```typescript\r\n   * const api = game.modules.get('fvtt_relationship_app_module').api;\r\n   *\r\n   * try {\r\n   *   const logger = api.resolve(api.tokens.loggerToken);\r\n   *   logger.info(\"Success\");\r\n   * } catch (error) {\r\n   *   console.error(\"Failed:\", error);\r\n   * }\r\n   * ```\r\n   *\r\n   * @example Internal Code (WRONG - Use resolveWithError)\r\n   * ```typescript\r\n   * // ‚ùå TypeScript Error + Runtime Error\r\n   * const logger = container.resolve(loggerToken);\r\n   *\r\n   * // ‚úÖ CORRECT\r\n   * const result = container.resolveWithError(loggerToken);\r\n   * if (result.ok) {\r\n   *   result.value.info(\"Success\");\r\n   * }\r\n   * ```\r\n   */\r\n  resolve<TServiceType extends ServiceType>(token: ApiSafeToken<TServiceType>): TServiceType;\r\n\r\n  /**\r\n   * @deprecated Internal code must use resolveWithError()\r\n   * @internal This overload prevents direct calls with non-branded tokens\r\n   */\r\n  resolve<TServiceType extends ServiceType>(token: InjectionToken<TServiceType>): never;\r\n\r\n  // Implementation (unified for both overloads)\r\n  resolve<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType> | ApiSafeToken<TServiceType>\r\n  ): TServiceType {\r\n    // üõ°Ô∏è RUNTIME GUARD (always active for defense-in-depth)\r\n    if (!isApiSafeTokenRuntime(token)) {\r\n      throw new Error(\r\n        `API Boundary Violation: resolve() called with non-API-safe token: ${String(token)}.\\n` +\r\n          `This token was not marked via markAsApiSafe().\\n` +\r\n          `\\n` +\r\n          `Internal code MUST use resolveWithError() instead:\\n` +\r\n          `  const result = container.resolveWithError(${String(token)});\\n` +\r\n          `  if (result.ok) { /* use result.value */ }\\n` +\r\n          `\\n` +\r\n          `Only the public ModuleApi should expose resolve() for external modules.`\r\n      );\r\n    }\r\n\r\n    // Standard resolution via Result pattern\r\n    const result = this.resolveWithError(token);\r\n\r\n    if (isOk(result)) {\r\n      return result.value;\r\n    }\r\n\r\n    // Try fallback factory\r\n    const fallback = this.fallbackFactories.get(token);\r\n    if (fallback) {\r\n      return fallback() as TServiceType;\r\n    }\r\n\r\n    // No fallback - throw with context\r\n    throw new Error(\r\n      `Cannot resolve ${String(token)}: ${result.error.message}. ` +\r\n        `No fallback factory registered for this token.`\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Check if service is registered.\r\n   */\r\n  isRegistered<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>\r\n  ): Result<boolean, never> {\r\n    return ok(this.registry.has(token));\r\n  }\r\n\r\n  /**\r\n   * Register a fallback factory for a specific token.\r\n   * This will be used when resolve() fails for that token.\r\n   *\r\n   * @param token - The injection token\r\n   * @param factory - Factory function that creates a fallback instance\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * container.registerFallback(UserServiceToken, () => new DefaultUserService());\r\n   * ```\r\n   */\r\n  registerFallback<TServiceType extends ServiceType>(\r\n    token: InjectionToken<TServiceType>,\r\n    factory: FallbackFactory<TServiceType>\r\n  ): void {\r\n    this.fallbackFactories.set(token, factory as FallbackFactory<ServiceType>);\r\n  }\r\n\r\n  /**\r\n   * Synchronously dispose container and all children.\r\n   *\r\n   * Use this for scenarios where async disposal is not possible (e.g., browser unload).\r\n   * For normal cleanup, prefer disposeAsync() which handles async disposal properly.\r\n   *\r\n   * @returns Result indicating success or disposal error\r\n   */\r\n  dispose(): Result<void, ContainerError> {\r\n    const result = this.scopeManager.dispose();\r\n\r\n    // Reset validation state after disposal (per review feedback)\r\n    if (result.ok) {\r\n      this.validationState = \"registering\";\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Asynchronously dispose container and all children.\r\n   *\r\n   * This is the preferred disposal method as it properly handles services that\r\n   * implement AsyncDisposable, allowing for proper cleanup of resources like\r\n   * database connections, file handles, or network sockets.\r\n   *\r\n   * Falls back to synchronous disposal for services implementing only Disposable.\r\n   *\r\n   * @returns Promise with Result indicating success or disposal error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Preferred: async disposal\r\n   * const result = await container.disposeAsync();\r\n   * if (result.ok) {\r\n   *   console.log(\"Container disposed successfully\");\r\n   * }\r\n   *\r\n   * // Browser unload (sync required)\r\n   * window.addEventListener('beforeunload', () => {\r\n   *   container.dispose();  // Sync fallback\r\n   * });\r\n   * ```\r\n   */\r\n  async disposeAsync(): Promise<Result<void, ContainerError>> {\r\n    const result = await this.scopeManager.disposeAsync();\r\n\r\n    // Reset validation state after disposal (per review feedback)\r\n    if (result.ok) {\r\n      this.validationState = \"registering\";\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Clear all registrations and instances.\r\n   *\r\n   * IMPORTANT: Resets validation state (per review feedback).\r\n   */\r\n  clear(): Result<void, never> {\r\n    this.registry.clear();\r\n    this.cache.clear();\r\n    this.validationState = \"registering\"; // Critical: reset validation state\r\n    return ok(undefined);\r\n  }\r\n}\r\n","import type { Logger } from \"@/interfaces/logger\";\r\nimport { MODULE_CONSTANTS } from \"../constants\";\r\nimport { LogLevel } from \"@/config/environment\";\r\n\r\n/**\r\n * Console-based implementation of the Logger interface.\r\n * Writes log messages to the browser console with support for interactive object inspection.\r\n * Supports configurable minimum log level for filtering.\r\n *\r\n * @implements {Logger}\r\n */\r\nexport class ConsoleLoggerService implements Logger {\r\n  static dependencies = [] as const;\r\n  private minLevel: LogLevel = LogLevel.INFO;\r\n\r\n  /**\r\n   * Sets the minimum log level. Messages below this level will be ignored.\r\n   * @param level - Minimum log level\r\n   */\r\n  setMinLevel(level: LogLevel): void {\r\n    this.minLevel = level;\r\n  }\r\n\r\n  /**\r\n   * Log a message to console\r\n   * @param message - Message to log\r\n   * @param optionalParams - Additional data to log (objects will be interactive in browser console)\r\n   */\r\n  log(message: string, ...optionalParams: unknown[]): void {\r\n    // Log has no specific level, always output\r\n    console.log(`${MODULE_CONSTANTS.LOG_PREFIX} ${message}`, ...optionalParams);\r\n  }\r\n\r\n  /**\r\n   * Log an error message\r\n   * @param message - Error message to log\r\n   * @param optionalParams - Additional data to log (e.g., error objects, stack traces)\r\n   */\r\n  error(message: string, ...optionalParams: unknown[]): void {\r\n    /* c8 ignore next 2 -- Branch: Log level filtering tested in other methods; error just delegates */\r\n    if (LogLevel.ERROR < this.minLevel) return;\r\n    console.error(`${MODULE_CONSTANTS.LOG_PREFIX} ${message}`, ...optionalParams);\r\n  }\r\n\r\n  /**\r\n   * Log a warning message\r\n   * @param message - Warning message to log\r\n   * @param optionalParams - Additional data to log\r\n   */\r\n  warn(message: string, ...optionalParams: unknown[]): void {\r\n    if (LogLevel.WARN < this.minLevel) return;\r\n    console.warn(`${MODULE_CONSTANTS.LOG_PREFIX} ${message}`, ...optionalParams);\r\n  }\r\n\r\n  /**\r\n   * Log an info message\r\n   * @param message - Info message to log\r\n   * @param optionalParams - Additional data to log\r\n   */\r\n  info(message: string, ...optionalParams: unknown[]): void {\r\n    if (LogLevel.INFO < this.minLevel) return;\r\n    console.info(`${MODULE_CONSTANTS.LOG_PREFIX} ${message}`, ...optionalParams);\r\n  }\r\n\r\n  /**\r\n   * Log a debug message\r\n   * @param message - Debug message to log\r\n   * @param optionalParams - Additional data to log (useful for inspecting complex objects)\r\n   */\r\n  debug(message: string, ...optionalParams: unknown[]): void {\r\n    if (LogLevel.DEBUG < this.minLevel) return;\r\n    console.debug(`${MODULE_CONSTANTS.LOG_PREFIX} ${message}`, ...optionalParams);\r\n  }\r\n}\r\n","// src/storages/globalConfig/globalConfig.ts\nvar store;\nfunction setGlobalConfig(config2) {\n  store = { ...store, ...config2 };\n}\n// @__NO_SIDE_EFFECTS__\nfunction getGlobalConfig(config2) {\n  return {\n    lang: config2?.lang ?? store?.lang,\n    message: config2?.message,\n    abortEarly: config2?.abortEarly ?? store?.abortEarly,\n    abortPipeEarly: config2?.abortPipeEarly ?? store?.abortPipeEarly\n  };\n}\nfunction deleteGlobalConfig() {\n  store = void 0;\n}\n\n// src/storages/globalMessage/globalMessage.ts\nvar store2;\nfunction setGlobalMessage(message2, lang) {\n  if (!store2) store2 = /* @__PURE__ */ new Map();\n  store2.set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getGlobalMessage(lang) {\n  return store2?.get(lang);\n}\nfunction deleteGlobalMessage(lang) {\n  store2?.delete(lang);\n}\n\n// src/storages/schemaMessage/schemaMessage.ts\nvar store3;\nfunction setSchemaMessage(message2, lang) {\n  if (!store3) store3 = /* @__PURE__ */ new Map();\n  store3.set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getSchemaMessage(lang) {\n  return store3?.get(lang);\n}\nfunction deleteSchemaMessage(lang) {\n  store3?.delete(lang);\n}\n\n// src/storages/specificMessage/specificMessage.ts\nvar store4;\nfunction setSpecificMessage(reference, message2, lang) {\n  if (!store4) store4 = /* @__PURE__ */ new Map();\n  if (!store4.get(reference)) store4.set(reference, /* @__PURE__ */ new Map());\n  store4.get(reference).set(lang, message2);\n}\n// @__NO_SIDE_EFFECTS__\nfunction getSpecificMessage(reference, lang) {\n  return store4?.get(reference)?.get(lang);\n}\nfunction deleteSpecificMessage(reference, lang) {\n  store4?.get(reference)?.delete(lang);\n}\n\n// src/utils/_stringify/_stringify.ts\n// @__NO_SIDE_EFFECTS__\nfunction _stringify(input) {\n  const type = typeof input;\n  if (type === \"string\") {\n    return `\"${input}\"`;\n  }\n  if (type === \"number\" || type === \"bigint\" || type === \"boolean\") {\n    return `${input}`;\n  }\n  if (type === \"object\" || type === \"function\") {\n    return (input && Object.getPrototypeOf(input)?.constructor?.name) ?? \"null\";\n  }\n  return type;\n}\n\n// src/utils/_addIssue/_addIssue.ts\nfunction _addIssue(context, label, dataset, config2, other) {\n  const input = other && \"input\" in other ? other.input : dataset.value;\n  const expected = other?.expected ?? context.expects ?? null;\n  const received = other?.received ?? _stringify(input);\n  const issue = {\n    kind: context.kind,\n    type: context.type,\n    input,\n    expected,\n    received,\n    message: `Invalid ${label}: ${expected ? `Expected ${expected} but r` : \"R\"}eceived ${received}`,\n    requirement: context.requirement,\n    path: other?.path,\n    issues: other?.issues,\n    lang: config2.lang,\n    abortEarly: config2.abortEarly,\n    abortPipeEarly: config2.abortPipeEarly\n  };\n  const isSchema = context.kind === \"schema\";\n  const message2 = other?.message ?? context.message ?? getSpecificMessage(context.reference, issue.lang) ?? (isSchema ? getSchemaMessage(issue.lang) : null) ?? config2.message ?? getGlobalMessage(issue.lang);\n  if (message2 !== void 0) {\n    issue.message = typeof message2 === \"function\" ? (\n      // @ts-expect-error\n      message2(issue)\n    ) : message2;\n  }\n  if (isSchema) {\n    dataset.typed = false;\n  }\n  if (dataset.issues) {\n    dataset.issues.push(issue);\n  } else {\n    dataset.issues = [issue];\n  }\n}\n\n// src/utils/_getByteCount/_getByteCount.ts\nvar textEncoder;\n// @__NO_SIDE_EFFECTS__\nfunction _getByteCount(input) {\n  if (!textEncoder) {\n    textEncoder = new TextEncoder();\n  }\n  return textEncoder.encode(input).length;\n}\n\n// src/utils/_getGraphemeCount/_getGraphemeCount.ts\nvar segmenter;\n// @__NO_SIDE_EFFECTS__\nfunction _getGraphemeCount(input) {\n  if (!segmenter) {\n    segmenter = new Intl.Segmenter();\n  }\n  const segments = segmenter.segment(input);\n  let count = 0;\n  for (const _ of segments) {\n    count++;\n  }\n  return count;\n}\n\n// src/utils/_getLastMetadata/_getLastMetadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction _getLastMetadata(schema, type) {\n  if (\"pipe\" in schema) {\n    const nestedSchemas = [];\n    for (let index = schema.pipe.length - 1; index >= 0; index--) {\n      const item = schema.pipe[index];\n      if (item.kind === \"schema\" && \"pipe\" in item) {\n        nestedSchemas.push(item);\n      } else if (item.kind === \"metadata\" && item.type === type) {\n        return item[type];\n      }\n    }\n    for (const nestedSchema of nestedSchemas) {\n      const result = /* @__PURE__ */ _getLastMetadata(nestedSchema, type);\n      if (result !== void 0) {\n        return result;\n      }\n    }\n  }\n}\n\n// src/utils/_getStandardProps/_getStandardProps.ts\n// @__NO_SIDE_EFFECTS__\nfunction _getStandardProps(context) {\n  return {\n    version: 1,\n    vendor: \"valibot\",\n    validate(value2) {\n      return context[\"~run\"]({ value: value2 }, getGlobalConfig());\n    }\n  };\n}\n\n// src/utils/_getWordCount/_getWordCount.ts\nvar store5;\n// @__NO_SIDE_EFFECTS__\nfunction _getWordCount(locales, input) {\n  if (!store5) {\n    store5 = /* @__PURE__ */ new Map();\n  }\n  if (!store5.get(locales)) {\n    store5.set(locales, new Intl.Segmenter(locales, { granularity: \"word\" }));\n  }\n  const segments = store5.get(locales).segment(input);\n  let count = 0;\n  for (const segment of segments) {\n    if (segment.isWordLike) {\n      count++;\n    }\n  }\n  return count;\n}\n\n// src/utils/_isLuhnAlgo/_isLuhnAlgo.ts\nvar NON_DIGIT_REGEX = /\\D/gu;\n// @__NO_SIDE_EFFECTS__\nfunction _isLuhnAlgo(input) {\n  const number2 = input.replace(NON_DIGIT_REGEX, \"\");\n  let length2 = number2.length;\n  let bit = 1;\n  let sum = 0;\n  while (length2) {\n    const value2 = +number2[--length2];\n    bit ^= 1;\n    sum += bit ? [0, 2, 4, 6, 8, 1, 3, 5, 7, 9][value2] : value2;\n  }\n  return sum % 10 === 0;\n}\n\n// src/utils/_isValidObjectKey/_isValidObjectKey.ts\n// @__NO_SIDE_EFFECTS__\nfunction _isValidObjectKey(object2, key) {\n  return Object.hasOwn(object2, key) && key !== \"__proto__\" && key !== \"prototype\" && key !== \"constructor\";\n}\n\n// src/utils/_joinExpects/_joinExpects.ts\n// @__NO_SIDE_EFFECTS__\nfunction _joinExpects(values2, separator) {\n  const list = [...new Set(values2)];\n  if (list.length > 1) {\n    return `(${list.join(` ${separator} `)})`;\n  }\n  return list[0] ?? \"never\";\n}\n\n// src/utils/entriesFromList/entriesFromList.ts\n// @__NO_SIDE_EFFECTS__\nfunction entriesFromList(list, schema) {\n  const entries2 = {};\n  for (const key of list) {\n    entries2[key] = schema;\n  }\n  return entries2;\n}\n\n// src/utils/entriesFromObjects/entriesFromObjects.ts\n// @__NO_SIDE_EFFECTS__\nfunction entriesFromObjects(schemas) {\n  const entries2 = {};\n  for (const schema of schemas) {\n    Object.assign(entries2, schema.entries);\n  }\n  return entries2;\n}\n\n// src/utils/getDotPath/getDotPath.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDotPath(issue) {\n  if (issue.path) {\n    let key = \"\";\n    for (const item of issue.path) {\n      if (typeof item.key === \"string\" || typeof item.key === \"number\") {\n        if (key) {\n          key += `.${item.key}`;\n        } else {\n          key += item.key;\n        }\n      } else {\n        return null;\n      }\n    }\n    return key;\n  }\n  return null;\n}\n\n// src/utils/isOfKind/isOfKind.ts\n// @__NO_SIDE_EFFECTS__\nfunction isOfKind(kind, object2) {\n  return object2.kind === kind;\n}\n\n// src/utils/isOfType/isOfType.ts\n// @__NO_SIDE_EFFECTS__\nfunction isOfType(type, object2) {\n  return object2.type === type;\n}\n\n// src/utils/isValiError/isValiError.ts\n// @__NO_SIDE_EFFECTS__\nfunction isValiError(error) {\n  return error instanceof ValiError;\n}\n\n// src/utils/ValiError/ValiError.ts\nvar ValiError = class extends Error {\n  /**\n   * Creates a Valibot error with useful information.\n   *\n   * @param issues The error issues.\n   */\n  constructor(issues) {\n    super(issues[0].message);\n    this.name = \"ValiError\";\n    this.issues = issues;\n  }\n};\n\n// src/actions/args/args.ts\n// @__NO_SIDE_EFFECTS__\nfunction args(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"args\",\n    reference: args,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = (...args_) => {\n        const argsDataset = this.schema[\"~run\"]({ value: args_ }, config2);\n        if (argsDataset.issues) {\n          throw new ValiError(argsDataset.issues);\n        }\n        return func(...argsDataset.value);\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/args/argsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction argsAsync(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"args\",\n    reference: argsAsync,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = async (...args2) => {\n        const argsDataset = await schema[\"~run\"]({ value: args2 }, config2);\n        if (argsDataset.issues) {\n          throw new ValiError(argsDataset.issues);\n        }\n        return func(...argsDataset.value);\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/await/awaitAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction awaitAsync() {\n  return {\n    kind: \"transformation\",\n    type: \"await\",\n    reference: awaitAsync,\n    async: true,\n    async \"~run\"(dataset) {\n      dataset.value = await dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/regex.ts\nvar BASE64_REGEX = /^(?:[\\da-z+/]{4})*(?:[\\da-z+/]{2}==|[\\da-z+/]{3}=)?$/iu;\nvar BIC_REGEX = /^[A-Z]{6}(?!00)[\\dA-Z]{2}(?:[\\dA-Z]{3})?$/u;\nvar CUID2_REGEX = /^[a-z][\\da-z]*$/u;\nvar DECIMAL_REGEX = /^[+-]?(?:\\d*\\.)?\\d+$/u;\nvar DIGITS_REGEX = /^\\d+$/u;\nvar EMAIL_REGEX = /^[\\w+-]+(?:\\.[\\w+-]+)*@[\\da-z]+(?:[.-][\\da-z]+)*\\.[a-z]{2,}$/iu;\nvar EMOJI_REGEX = (\n  // eslint-disable-next-line redos-detector/no-unsafe-regex, regexp/no-dupe-disjunctions -- false positives\n  /^(?:[\\u{1F1E6}-\\u{1F1FF}]{2}|\\u{1F3F4}[\\u{E0061}-\\u{E007A}]{2}[\\u{E0030}-\\u{E0039}\\u{E0061}-\\u{E007A}]{1,3}\\u{E007F}|(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation})(?:\\u200D(?:\\p{Emoji}\\uFE0F\\u20E3?|\\p{Emoji_Modifier_Base}\\p{Emoji_Modifier}?|\\p{Emoji_Presentation}))*)+$/u\n);\nvar HEXADECIMAL_REGEX = /^(?:0[hx])?[\\da-fA-F]+$/u;\nvar HEX_COLOR_REGEX = /^#(?:[\\da-fA-F]{3,4}|[\\da-fA-F]{6}|[\\da-fA-F]{8})$/u;\nvar IMEI_REGEX = /^\\d{15}$|^\\d{2}-\\d{6}-\\d{6}-\\d$/u;\nvar IPV4_REGEX = (\n  // eslint-disable-next-line redos-detector/no-unsafe-regex -- false positive\n  /^(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])(?:\\.(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])){3}$/u\n);\nvar IPV6_REGEX = /^(?:(?:[\\da-f]{1,4}:){7}[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,7}:|(?:[\\da-f]{1,4}:){1,6}:[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,5}(?::[\\da-f]{1,4}){1,2}|(?:[\\da-f]{1,4}:){1,4}(?::[\\da-f]{1,4}){1,3}|(?:[\\da-f]{1,4}:){1,3}(?::[\\da-f]{1,4}){1,4}|(?:[\\da-f]{1,4}:){1,2}(?::[\\da-f]{1,4}){1,5}|[\\da-f]{1,4}:(?::[\\da-f]{1,4}){1,6}|:(?:(?::[\\da-f]{1,4}){1,7}|:)|fe80:(?::[\\da-f]{0,4}){0,4}%[\\da-z]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)|(?:[\\da-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d))$/iu;\nvar IP_REGEX = /^(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])(?:\\.(?:(?:[1-9]|1\\d|2[0-4])?\\d|25[0-5])){3}$|^(?:(?:[\\da-f]{1,4}:){7}[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,7}:|(?:[\\da-f]{1,4}:){1,6}:[\\da-f]{1,4}|(?:[\\da-f]{1,4}:){1,5}(?::[\\da-f]{1,4}){1,2}|(?:[\\da-f]{1,4}:){1,4}(?::[\\da-f]{1,4}){1,3}|(?:[\\da-f]{1,4}:){1,3}(?::[\\da-f]{1,4}){1,4}|(?:[\\da-f]{1,4}:){1,2}(?::[\\da-f]{1,4}){1,5}|[\\da-f]{1,4}:(?::[\\da-f]{1,4}){1,6}|:(?:(?::[\\da-f]{1,4}){1,7}|:)|fe80:(?::[\\da-f]{0,4}){0,4}%[\\da-z]+|::(?:f{4}(?::0{1,4})?:)?(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)|(?:[\\da-f]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d)\\.){3}(?:25[0-5]|(?:2[0-4]|1?\\d)?\\d))$/iu;\nvar ISO_DATE_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])$/u;\nvar ISO_DATE_TIME_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])[T ](?:0\\d|1\\d|2[0-3]):[0-5]\\d$/u;\nvar ISO_TIME_REGEX = /^(?:0\\d|1\\d|2[0-3]):[0-5]\\d$/u;\nvar ISO_TIME_SECOND_REGEX = /^(?:0\\d|1\\d|2[0-3])(?::[0-5]\\d){2}$/u;\nvar ISO_TIMESTAMP_REGEX = /^\\d{4}-(?:0[1-9]|1[0-2])-(?:[12]\\d|0[1-9]|3[01])[T ](?:0\\d|1\\d|2[0-3])(?::[0-5]\\d){2}(?:\\.\\d{1,9})?(?:Z|[+-](?:0\\d|1\\d|2[0-3])(?::?[0-5]\\d)?)$/u;\nvar ISO_WEEK_REGEX = /^\\d{4}-W(?:0[1-9]|[1-4]\\d|5[0-3])$/u;\nvar MAC48_REGEX = /^(?:[\\da-f]{2}:){5}[\\da-f]{2}$|^(?:[\\da-f]{2}-){5}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){2}[\\da-f]{4}$/iu;\nvar MAC64_REGEX = /^(?:[\\da-f]{2}:){7}[\\da-f]{2}$|^(?:[\\da-f]{2}-){7}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){3}[\\da-f]{4}$|^(?:[\\da-f]{4}:){3}[\\da-f]{4}$/iu;\nvar MAC_REGEX = /^(?:[\\da-f]{2}:){5}[\\da-f]{2}$|^(?:[\\da-f]{2}-){5}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){2}[\\da-f]{4}$|^(?:[\\da-f]{2}:){7}[\\da-f]{2}$|^(?:[\\da-f]{2}-){7}[\\da-f]{2}$|^(?:[\\da-f]{4}\\.){3}[\\da-f]{4}$|^(?:[\\da-f]{4}:){3}[\\da-f]{4}$/iu;\nvar NANO_ID_REGEX = /^[\\w-]+$/u;\nvar OCTAL_REGEX = /^(?:0o)?[0-7]+$/u;\nvar RFC_EMAIL_REGEX = (\n  // eslint-disable-next-line regexp/prefer-w, no-useless-escape, regexp/no-useless-escape, regexp/require-unicode-regexp\n  /^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/\n);\nvar SLUG_REGEX = /^[\\da-z]+(?:[-_][\\da-z]+)*$/u;\nvar ULID_REGEX = /^[\\da-hjkmnp-tv-zA-HJKMNP-TV-Z]{26}$/u;\nvar UUID_REGEX = /^[\\da-f]{8}(?:-[\\da-f]{4}){3}-[\\da-f]{12}$/iu;\n\n// src/actions/base64/base64.ts\n// @__NO_SIDE_EFFECTS__\nfunction base64(message2) {\n  return {\n    kind: \"validation\",\n    type: \"base64\",\n    reference: base64,\n    async: false,\n    expects: null,\n    requirement: BASE64_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Base64\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/bic/bic.ts\n// @__NO_SIDE_EFFECTS__\nfunction bic(message2) {\n  return {\n    kind: \"validation\",\n    type: \"bic\",\n    reference: bic,\n    async: false,\n    expects: null,\n    requirement: BIC_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"BIC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/brand/brand.ts\n// @__NO_SIDE_EFFECTS__\nfunction brand(name) {\n  return {\n    kind: \"transformation\",\n    type: \"brand\",\n    reference: brand,\n    async: false,\n    name,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/bytes/bytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction bytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"bytes\",\n    reference: bytes,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 !== this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/check/check.ts\n// @__NO_SIDE_EFFECTS__\nfunction check(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check\",\n    reference: check,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/check/checkAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkAsync(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check\",\n    reference: checkAsync,\n    async: true,\n    expects: null,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if (dataset.typed && !await this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/checkItems/checkItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkItems(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check_items\",\n    reference: checkItems,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        for (let index = 0; index < dataset.value.length; index++) {\n          const item = dataset.value[index];\n          if (!this.requirement(item, index, dataset.value)) {\n            _addIssue(this, \"item\", dataset, config2, {\n              input: item,\n              path: [\n                {\n                  type: \"array\",\n                  origin: \"value\",\n                  input: dataset.value,\n                  key: index,\n                  value: item\n                }\n              ]\n            });\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/checkItems/checkItemsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction checkItemsAsync(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"check_items\",\n    reference: checkItemsAsync,\n    async: true,\n    expects: null,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const requirementResults = await Promise.all(\n          dataset.value.map(this.requirement)\n        );\n        for (let index = 0; index < dataset.value.length; index++) {\n          if (!requirementResults[index]) {\n            const item = dataset.value[index];\n            _addIssue(this, \"item\", dataset, config2, {\n              input: item,\n              path: [\n                {\n                  type: \"array\",\n                  origin: \"value\",\n                  input: dataset.value,\n                  key: index,\n                  value: item\n                }\n              ]\n            });\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/creditCard/creditCard.ts\nvar CREDIT_CARD_REGEX = /^(?:\\d{14,19}|\\d{4}(?: \\d{3,6}){2,4}|\\d{4}(?:-\\d{3,6}){2,4})$/u;\nvar SANITIZE_REGEX = /[- ]/gu;\nvar PROVIDER_REGEX_LIST = [\n  // American Express\n  /^3[47]\\d{13}$/u,\n  // Diners Club\n  /^3(?:0[0-5]|[68]\\d)\\d{11,13}$/u,\n  // Discover\n  /^6(?:011|5\\d{2})\\d{12,15}$/u,\n  // JCB\n  /^(?:2131|1800|35\\d{3})\\d{11}$/u,\n  // Mastercard\n  // eslint-disable-next-line redos-detector/no-unsafe-regex\n  /^5[1-5]\\d{2}|(?:222\\d|22[3-9]\\d|2[3-6]\\d{2}|27[01]\\d|2720)\\d{12}$/u,\n  // UnionPay\n  /^(?:6[27]\\d{14,17}|81\\d{14,17})$/u,\n  // Visa\n  /^4\\d{12}(?:\\d{3,6})?$/u\n];\n// @__NO_SIDE_EFFECTS__\nfunction creditCard(message2) {\n  return {\n    kind: \"validation\",\n    type: \"credit_card\",\n    reference: creditCard,\n    async: false,\n    expects: null,\n    requirement(input) {\n      let sanitized;\n      return CREDIT_CARD_REGEX.test(input) && // Remove any hyphens and blanks\n      (sanitized = input.replace(SANITIZE_REGEX, \"\")) && // Check if it matches a provider\n      PROVIDER_REGEX_LIST.some((regex2) => regex2.test(sanitized)) && // Check if passes luhn algorithm\n      _isLuhnAlgo(sanitized);\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"credit card\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/cuid2/cuid2.ts\n// @__NO_SIDE_EFFECTS__\nfunction cuid2(message2) {\n  return {\n    kind: \"validation\",\n    type: \"cuid2\",\n    reference: cuid2,\n    async: false,\n    expects: null,\n    requirement: CUID2_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Cuid2\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/decimal/decimal.ts\n// @__NO_SIDE_EFFECTS__\nfunction decimal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"decimal\",\n    reference: decimal,\n    async: false,\n    expects: null,\n    requirement: DECIMAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"decimal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/description/description.ts\n// @__NO_SIDE_EFFECTS__\nfunction description(description_) {\n  return {\n    kind: \"metadata\",\n    type: \"description\",\n    reference: description,\n    description: description_\n  };\n}\n\n// src/actions/digits/digits.ts\n// @__NO_SIDE_EFFECTS__\nfunction digits(message2) {\n  return {\n    kind: \"validation\",\n    type: \"digits\",\n    reference: digits,\n    async: false,\n    expects: null,\n    requirement: DIGITS_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"digits\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/email/email.ts\n// @__NO_SIDE_EFFECTS__\nfunction email(message2) {\n  return {\n    kind: \"validation\",\n    type: \"email\",\n    reference: email,\n    expects: null,\n    async: false,\n    requirement: EMAIL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"email\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/emoji/emoji.ts\n// @__NO_SIDE_EFFECTS__\nfunction emoji(message2) {\n  return {\n    kind: \"validation\",\n    type: \"emoji\",\n    reference: emoji,\n    async: false,\n    expects: null,\n    requirement: EMOJI_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"emoji\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/empty/empty.ts\n// @__NO_SIDE_EFFECTS__\nfunction empty(message2) {\n  return {\n    kind: \"validation\",\n    type: \"empty\",\n    reference: empty,\n    async: false,\n    expects: \"0\",\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length > 0) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/endsWith/endsWith.ts\n// @__NO_SIDE_EFFECTS__\nfunction endsWith(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"ends_with\",\n    reference: endsWith,\n    async: false,\n    expects: `\"${requirement}\"`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.endsWith(this.requirement)) {\n        _addIssue(this, \"end\", dataset, config2, {\n          received: `\"${dataset.value.slice(-this.requirement.length)}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/entries/entries.ts\n// @__NO_SIDE_EFFECTS__\nfunction entries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"entries\",\n    reference: entries,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count !== this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/everyItem/everyItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction everyItem(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"every_item\",\n    reference: everyItem,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.every(this.requirement)) {\n        _addIssue(this, \"item\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/excludes/excludes.ts\n// @__NO_SIDE_EFFECTS__\nfunction excludes(requirement, message2) {\n  const received = _stringify(requirement);\n  return {\n    kind: \"validation\",\n    type: \"excludes\",\n    reference: excludes,\n    async: false,\n    expects: `!${received}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.includes(this.requirement)) {\n        _addIssue(this, \"content\", dataset, config2, { received });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/filterItems/filterItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction filterItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"filter_items\",\n    reference: filterItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.filter(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/findItem/findItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction findItem(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"find_item\",\n    reference: findItem,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.find(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/finite/finite.ts\n// @__NO_SIDE_EFFECTS__\nfunction finite(message2) {\n  return {\n    kind: \"validation\",\n    type: \"finite\",\n    reference: finite,\n    async: false,\n    expects: null,\n    requirement: Number.isFinite,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"finite\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/flavor/flavor.ts\n// @__NO_SIDE_EFFECTS__\nfunction flavor(name) {\n  return {\n    kind: \"transformation\",\n    type: \"flavor\",\n    reference: flavor,\n    async: false,\n    name,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/graphemes/graphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction graphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"graphemes\",\n    reference: graphemes,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count !== this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/gtValue/gtValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction gtValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"gt_value\",\n    reference: gtValue,\n    async: false,\n    expects: `>${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value > this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hash/hash.ts\nvar HASH_LENGTHS = {\n  md4: 32,\n  md5: 32,\n  sha1: 40,\n  sha256: 64,\n  sha384: 96,\n  sha512: 128,\n  ripemd128: 32,\n  ripemd160: 40,\n  tiger128: 32,\n  tiger160: 40,\n  tiger192: 48,\n  crc32: 8,\n  crc32b: 8,\n  adler32: 8\n};\n// @__NO_SIDE_EFFECTS__\nfunction hash(types, message2) {\n  return {\n    kind: \"validation\",\n    type: \"hash\",\n    reference: hash,\n    expects: null,\n    async: false,\n    requirement: RegExp(\n      types.map((type) => `^[a-f0-9]{${HASH_LENGTHS[type]}}$`).join(\"|\"),\n      \"iu\"\n    ),\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hash\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hexadecimal/hexadecimal.ts\n// @__NO_SIDE_EFFECTS__\nfunction hexadecimal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"hexadecimal\",\n    reference: hexadecimal,\n    async: false,\n    expects: null,\n    requirement: HEXADECIMAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hexadecimal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/hexColor/hexColor.ts\n// @__NO_SIDE_EFFECTS__\nfunction hexColor(message2) {\n  return {\n    kind: \"validation\",\n    type: \"hex_color\",\n    reference: hexColor,\n    async: false,\n    expects: null,\n    requirement: HEX_COLOR_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"hex color\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/imei/imei.ts\n// @__NO_SIDE_EFFECTS__\nfunction imei(message2) {\n  return {\n    kind: \"validation\",\n    type: \"imei\",\n    reference: imei,\n    async: false,\n    expects: null,\n    requirement(input) {\n      return IMEI_REGEX.test(input) && _isLuhnAlgo(input);\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"IMEI\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/includes/includes.ts\n// @__NO_SIDE_EFFECTS__\nfunction includes(requirement, message2) {\n  const expects = _stringify(requirement);\n  return {\n    kind: \"validation\",\n    type: \"includes\",\n    reference: includes,\n    async: false,\n    expects,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.includes(this.requirement)) {\n        _addIssue(this, \"content\", dataset, config2, {\n          received: `!${expects}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/integer/integer.ts\n// @__NO_SIDE_EFFECTS__\nfunction integer(message2) {\n  return {\n    kind: \"validation\",\n    type: \"integer\",\n    reference: integer,\n    async: false,\n    expects: null,\n    requirement: Number.isInteger,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"integer\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ip/ip.ts\n// @__NO_SIDE_EFFECTS__\nfunction ip(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ip\",\n    reference: ip,\n    async: false,\n    expects: null,\n    requirement: IP_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IP\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ipv4/ipv4.ts\n// @__NO_SIDE_EFFECTS__\nfunction ipv4(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ipv4\",\n    reference: ipv4,\n    async: false,\n    expects: null,\n    requirement: IPV4_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IPv4\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ipv6/ipv6.ts\n// @__NO_SIDE_EFFECTS__\nfunction ipv6(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ipv6\",\n    reference: ipv6,\n    async: false,\n    expects: null,\n    requirement: IPV6_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"IPv6\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoDate/isoDate.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoDate(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_date\",\n    reference: isoDate,\n    async: false,\n    expects: null,\n    requirement: ISO_DATE_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"date\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoDateTime/isoDateTime.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoDateTime(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_date_time\",\n    reference: isoDateTime,\n    async: false,\n    expects: null,\n    requirement: ISO_DATE_TIME_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"date-time\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTime/isoTime.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTime(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_time\",\n    reference: isoTime,\n    async: false,\n    expects: null,\n    requirement: ISO_TIME_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"time\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTimeSecond/isoTimeSecond.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTimeSecond(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_time_second\",\n    reference: isoTimeSecond,\n    async: false,\n    expects: null,\n    requirement: ISO_TIME_SECOND_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"time-second\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoTimestamp/isoTimestamp.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoTimestamp(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_timestamp\",\n    reference: isoTimestamp,\n    async: false,\n    expects: null,\n    requirement: ISO_TIMESTAMP_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"timestamp\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/isoWeek/isoWeek.ts\n// @__NO_SIDE_EFFECTS__\nfunction isoWeek(message2) {\n  return {\n    kind: \"validation\",\n    type: \"iso_week\",\n    reference: isoWeek,\n    async: false,\n    expects: null,\n    requirement: ISO_WEEK_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"week\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/length/length.ts\n// @__NO_SIDE_EFFECTS__\nfunction length(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"length\",\n    reference: length,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length !== this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ltValue/ltValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction ltValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"lt_value\",\n    reference: ltValue,\n    async: false,\n    expects: `<${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value < this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac/mac.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac\",\n    reference: mac,\n    async: false,\n    expects: null,\n    requirement: MAC_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac48/mac48.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac48(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac48\",\n    reference: mac48,\n    async: false,\n    expects: null,\n    requirement: MAC48_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"48-bit MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mac64/mac64.ts\n// @__NO_SIDE_EFFECTS__\nfunction mac64(message2) {\n  return {\n    kind: \"validation\",\n    type: \"mac64\",\n    reference: mac64,\n    async: false,\n    expects: null,\n    requirement: MAC64_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"64-bit MAC\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/mapItems/mapItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction mapItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"map_items\",\n    reference: mapItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.map(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxBytes/maxBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_bytes\",\n    reference: maxBytes,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 > this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxEntries/maxEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_entries\",\n    reference: maxEntries,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count > this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxGraphemes/maxGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_graphemes\",\n    reference: maxGraphemes,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count > this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxLength/maxLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_length\",\n    reference: maxLength,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length > this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxSize/maxSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_size\",\n    reference: maxSize,\n    async: false,\n    expects: `<=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size > this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxValue/maxValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_value\",\n    reference: maxValue,\n    async: false,\n    expects: `<=${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value <= this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/maxWords/maxWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction maxWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"max_words\",\n    reference: maxWords,\n    async: false,\n    expects: `<=${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count > this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/metadata/metadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction metadata(metadata_) {\n  return {\n    kind: \"metadata\",\n    type: \"metadata\",\n    reference: metadata,\n    metadata: metadata_\n  };\n}\n\n// src/actions/mimeType/mimeType.ts\n// @__NO_SIDE_EFFECTS__\nfunction mimeType(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"mime_type\",\n    reference: mimeType,\n    async: false,\n    expects: _joinExpects(\n      requirement.map((option) => `\"${option}\"`),\n      \"|\"\n    ),\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.includes(dataset.value.type)) {\n        _addIssue(this, \"MIME type\", dataset, config2, {\n          received: `\"${dataset.value.type}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minBytes/minBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction minBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_bytes\",\n    reference: minBytes,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 < this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minEntries/minEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction minEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_entries\",\n    reference: minEntries,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count < this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minGraphemes/minGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction minGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_graphemes\",\n    reference: minGraphemes,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count < this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minLength/minLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction minLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_length\",\n    reference: minLength,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length < this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minSize/minSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction minSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_size\",\n    reference: minSize,\n    async: false,\n    expects: `>=${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size < this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minValue/minValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction minValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_value\",\n    reference: minValue,\n    async: false,\n    expects: `>=${requirement instanceof Date ? requirement.toJSON() : _stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(dataset.value >= this.requirement)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/minWords/minWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction minWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"min_words\",\n    reference: minWords,\n    async: false,\n    expects: `>=${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count < this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/multipleOf/multipleOf.ts\n// @__NO_SIDE_EFFECTS__\nfunction multipleOf(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"multiple_of\",\n    reference: multipleOf,\n    async: false,\n    expects: `%${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value % this.requirement != 0) {\n        _addIssue(this, \"multiple\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/nanoid/nanoid.ts\n// @__NO_SIDE_EFFECTS__\nfunction nanoid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"nanoid\",\n    reference: nanoid,\n    async: false,\n    expects: null,\n    requirement: NANO_ID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"Nano ID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/nonEmpty/nonEmpty.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonEmpty(message2) {\n  return {\n    kind: \"validation\",\n    type: \"non_empty\",\n    reference: nonEmpty,\n    async: false,\n    expects: \"!0\",\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length === 0) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: \"0\"\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/normalize/normalize.ts\n// @__NO_SIDE_EFFECTS__\nfunction normalize(form) {\n  return {\n    kind: \"transformation\",\n    type: \"normalize\",\n    reference: normalize,\n    async: false,\n    form,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.normalize(this.form);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notBytes/notBytes.ts\n// @__NO_SIDE_EFFECTS__\nfunction notBytes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_bytes\",\n    reference: notBytes,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const length2 = _getByteCount(dataset.value);\n        if (length2 === this.requirement) {\n          _addIssue(this, \"bytes\", dataset, config2, {\n            received: `${length2}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notEntries/notEntries.ts\n// @__NO_SIDE_EFFECTS__\nfunction notEntries(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_entries\",\n    reference: notEntries,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (!dataset.typed) return dataset;\n      const count = Object.keys(dataset.value).length;\n      if (dataset.typed && count === this.requirement) {\n        _addIssue(this, \"entries\", dataset, config2, {\n          received: `${count}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notGraphemes/notGraphemes.ts\n// @__NO_SIDE_EFFECTS__\nfunction notGraphemes(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_graphemes\",\n    reference: notGraphemes,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getGraphemeCount(dataset.value);\n        if (count === this.requirement) {\n          _addIssue(this, \"graphemes\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notLength/notLength.ts\n// @__NO_SIDE_EFFECTS__\nfunction notLength(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_length\",\n    reference: notLength,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.length === this.requirement) {\n        _addIssue(this, \"length\", dataset, config2, {\n          received: `${dataset.value.length}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notSize/notSize.ts\n// @__NO_SIDE_EFFECTS__\nfunction notSize(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_size\",\n    reference: notSize,\n    async: false,\n    expects: `!${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size === this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notValue/notValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction notValue(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_value\",\n    reference: notValue,\n    async: false,\n    expects: requirement instanceof Date ? `!${requirement.toJSON()}` : `!${_stringify(requirement)}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && this.requirement <= dataset.value && this.requirement >= dataset.value) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notValues/notValues.ts\n// @__NO_SIDE_EFFECTS__\nfunction notValues(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_values\",\n    reference: notValues,\n    async: false,\n    expects: `!${_joinExpects(\n      requirement.map(\n        (value2) => value2 instanceof Date ? value2.toJSON() : _stringify(value2)\n      ),\n      \"|\"\n    )}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && this.requirement.some(\n        (value2) => value2 <= dataset.value && value2 >= dataset.value\n      )) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/notWords/notWords.ts\n// @__NO_SIDE_EFFECTS__\nfunction notWords(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"not_words\",\n    reference: notWords,\n    async: false,\n    expects: `!${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count === this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/octal/octal.ts\n// @__NO_SIDE_EFFECTS__\nfunction octal(message2) {\n  return {\n    kind: \"validation\",\n    type: \"octal\",\n    reference: octal,\n    async: false,\n    expects: null,\n    requirement: OCTAL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"octal\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/parseJson/parseJson.ts\n// @__NO_SIDE_EFFECTS__\nfunction parseJson(config2, message2) {\n  return {\n    kind: \"transformation\",\n    type: \"parse_json\",\n    reference: parseJson,\n    config: config2,\n    message: message2,\n    async: false,\n    \"~run\"(dataset, config3) {\n      try {\n        dataset.value = JSON.parse(dataset.value, this.config?.reviver);\n      } catch (error) {\n        if (error instanceof Error) {\n          _addIssue(this, \"JSON\", dataset, config3, {\n            received: `\"${error.message}\"`\n          });\n          dataset.typed = false;\n        } else {\n          throw error;\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/partialCheck/utils/_isPartiallyTyped/_isPartiallyTyped.ts\n// @__NO_SIDE_EFFECTS__\nfunction _isPartiallyTyped(dataset, paths) {\n  if (dataset.issues) {\n    for (const path of paths) {\n      for (const issue of dataset.issues) {\n        let typed = false;\n        const bound = Math.min(path.length, issue.path?.length ?? 0);\n        for (let index = 0; index < bound; index++) {\n          if (\n            // @ts-expect-error\n            path[index] !== issue.path[index].key && // @ts-expect-error\n            (path[index] !== \"$\" || issue.path[index].type !== \"array\")\n          ) {\n            typed = true;\n            break;\n          }\n        }\n        if (!typed) {\n          return false;\n        }\n      }\n    }\n  }\n  return true;\n}\n\n// src/actions/partialCheck/partialCheck.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialCheck(paths, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"partial_check\",\n    reference: partialCheck,\n    async: false,\n    expects: null,\n    paths,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if ((dataset.typed || _isPartiallyTyped(dataset, paths)) && // @ts-expect-error\n      !this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/partialCheck/partialCheckAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialCheckAsync(paths, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"partial_check\",\n    reference: partialCheckAsync,\n    async: true,\n    expects: null,\n    paths,\n    requirement,\n    message: message2,\n    async \"~run\"(dataset, config2) {\n      if ((dataset.typed || _isPartiallyTyped(dataset, paths)) && // @ts-expect-error\n      !await this.requirement(dataset.value)) {\n        _addIssue(this, \"input\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawCheck/rawCheck.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawCheck(action) {\n  return {\n    kind: \"validation\",\n    type: \"raw_check\",\n    reference: rawCheck,\n    async: false,\n    expects: null,\n    \"~run\"(dataset, config2) {\n      action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info)\n      });\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawCheck/rawCheckAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawCheckAsync(action) {\n  return {\n    kind: \"validation\",\n    type: \"raw_check\",\n    reference: rawCheckAsync,\n    async: true,\n    expects: null,\n    async \"~run\"(dataset, config2) {\n      await action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info)\n      });\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawTransform/rawTransform.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawTransform(action) {\n  return {\n    kind: \"transformation\",\n    type: \"raw_transform\",\n    reference: rawTransform,\n    async: false,\n    \"~run\"(dataset, config2) {\n      const output = action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info),\n        NEVER: null\n      });\n      if (dataset.issues) {\n        dataset.typed = false;\n      } else {\n        dataset.value = output;\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rawTransform/rawTransformAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction rawTransformAsync(action) {\n  return {\n    kind: \"transformation\",\n    type: \"raw_transform\",\n    reference: rawTransformAsync,\n    async: true,\n    async \"~run\"(dataset, config2) {\n      const output = await action({\n        dataset,\n        config: config2,\n        addIssue: (info) => _addIssue(this, info?.label ?? \"input\", dataset, config2, info),\n        NEVER: null\n      });\n      if (dataset.issues) {\n        dataset.typed = false;\n      } else {\n        dataset.value = output;\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/readonly/readonly.ts\n// @__NO_SIDE_EFFECTS__\nfunction readonly() {\n  return {\n    kind: \"transformation\",\n    type: \"readonly\",\n    reference: readonly,\n    async: false,\n    \"~run\"(dataset) {\n      return dataset;\n    }\n  };\n}\n\n// src/actions/reduceItems/reduceItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction reduceItems(operation, initial) {\n  return {\n    kind: \"transformation\",\n    type: \"reduce_items\",\n    reference: reduceItems,\n    async: false,\n    operation,\n    initial,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.reduce(this.operation, this.initial);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/regex/regex.ts\n// @__NO_SIDE_EFFECTS__\nfunction regex(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"regex\",\n    reference: regex,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"format\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/returns/returns.ts\n// @__NO_SIDE_EFFECTS__\nfunction returns(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"returns\",\n    reference: returns,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = (...args_) => {\n        const returnsDataset = this.schema[\"~run\"](\n          { value: func(...args_) },\n          config2\n        );\n        if (returnsDataset.issues) {\n          throw new ValiError(returnsDataset.issues);\n        }\n        return returnsDataset.value;\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/returns/returnsAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction returnsAsync(schema) {\n  return {\n    kind: \"transformation\",\n    type: \"returns\",\n    reference: returnsAsync,\n    async: false,\n    schema,\n    \"~run\"(dataset, config2) {\n      const func = dataset.value;\n      dataset.value = async (...args_) => {\n        const returnsDataset = await this.schema[\"~run\"](\n          { value: await func(...args_) },\n          config2\n        );\n        if (returnsDataset.issues) {\n          throw new ValiError(returnsDataset.issues);\n        }\n        return returnsDataset.value;\n      };\n      return dataset;\n    }\n  };\n}\n\n// src/actions/rfcEmail/rfcEmail.ts\n// @__NO_SIDE_EFFECTS__\nfunction rfcEmail(message2) {\n  return {\n    kind: \"validation\",\n    type: \"rfc_email\",\n    reference: rfcEmail,\n    expects: null,\n    async: false,\n    requirement: RFC_EMAIL_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"email\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/safeInteger/safeInteger.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeInteger(message2) {\n  return {\n    kind: \"validation\",\n    type: \"safe_integer\",\n    reference: safeInteger,\n    async: false,\n    expects: null,\n    requirement: Number.isSafeInteger,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"safe integer\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/size/size.ts\n// @__NO_SIDE_EFFECTS__\nfunction size(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"size\",\n    reference: size,\n    async: false,\n    expects: `${requirement}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && dataset.value.size !== this.requirement) {\n        _addIssue(this, \"size\", dataset, config2, {\n          received: `${dataset.value.size}`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/slug/slug.ts\n// @__NO_SIDE_EFFECTS__\nfunction slug(message2) {\n  return {\n    kind: \"validation\",\n    type: \"slug\",\n    reference: slug,\n    async: false,\n    expects: null,\n    requirement: SLUG_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"slug\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/someItem/someItem.ts\n// @__NO_SIDE_EFFECTS__\nfunction someItem(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"some_item\",\n    reference: someItem,\n    async: false,\n    expects: null,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.some(this.requirement)) {\n        _addIssue(this, \"item\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/sortItems/sortItems.ts\n// @__NO_SIDE_EFFECTS__\nfunction sortItems(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"sort_items\",\n    reference: sortItems,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.sort(this.operation);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/startsWith/startsWith.ts\n// @__NO_SIDE_EFFECTS__\nfunction startsWith(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"starts_with\",\n    reference: startsWith,\n    async: false,\n    expects: `\"${requirement}\"`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !dataset.value.startsWith(this.requirement)) {\n        _addIssue(this, \"start\", dataset, config2, {\n          received: `\"${dataset.value.slice(0, this.requirement.length)}\"`\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/stringifyJson/stringifyJson.ts\n// @__NO_SIDE_EFFECTS__\nfunction stringifyJson(config2, message2) {\n  return {\n    kind: \"transformation\",\n    type: \"stringify_json\",\n    reference: stringifyJson,\n    message: message2,\n    config: config2,\n    async: false,\n    \"~run\"(dataset, config3) {\n      try {\n        const output = JSON.stringify(\n          dataset.value,\n          // @ts-expect-error\n          this.config?.replacer,\n          this.config?.space\n        );\n        if (output === void 0) {\n          _addIssue(this, \"JSON\", dataset, config3);\n          dataset.typed = false;\n        }\n        dataset.value = output;\n      } catch (error) {\n        if (error instanceof Error) {\n          _addIssue(this, \"JSON\", dataset, config3, {\n            received: `\"${error.message}\"`\n          });\n          dataset.typed = false;\n        } else {\n          throw error;\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/title/title.ts\n// @__NO_SIDE_EFFECTS__\nfunction title(title_) {\n  return {\n    kind: \"metadata\",\n    type: \"title\",\n    reference: title,\n    title: title_\n  };\n}\n\n// src/actions/toLowerCase/toLowerCase.ts\n// @__NO_SIDE_EFFECTS__\nfunction toLowerCase() {\n  return {\n    kind: \"transformation\",\n    type: \"to_lower_case\",\n    reference: toLowerCase,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.toLowerCase();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toMaxValue/toMaxValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction toMaxValue(requirement) {\n  return {\n    kind: \"transformation\",\n    type: \"to_max_value\",\n    reference: toMaxValue,\n    async: false,\n    requirement,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value > this.requirement ? this.requirement : dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toMinValue/toMinValue.ts\n// @__NO_SIDE_EFFECTS__\nfunction toMinValue(requirement) {\n  return {\n    kind: \"transformation\",\n    type: \"to_min_value\",\n    reference: toMinValue,\n    async: false,\n    requirement,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value < this.requirement ? this.requirement : dataset.value;\n      return dataset;\n    }\n  };\n}\n\n// src/actions/toUpperCase/toUpperCase.ts\n// @__NO_SIDE_EFFECTS__\nfunction toUpperCase() {\n  return {\n    kind: \"transformation\",\n    type: \"to_upper_case\",\n    reference: toUpperCase,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.toUpperCase();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/transform/transform.ts\n// @__NO_SIDE_EFFECTS__\nfunction transform(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"transform\",\n    reference: transform,\n    async: false,\n    operation,\n    \"~run\"(dataset) {\n      dataset.value = this.operation(dataset.value);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/transform/transformAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction transformAsync(operation) {\n  return {\n    kind: \"transformation\",\n    type: \"transform\",\n    reference: transformAsync,\n    async: true,\n    operation,\n    async \"~run\"(dataset) {\n      dataset.value = await this.operation(dataset.value);\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trim/trim.ts\n// @__NO_SIDE_EFFECTS__\nfunction trim() {\n  return {\n    kind: \"transformation\",\n    type: \"trim\",\n    reference: trim,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trim();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trimEnd/trimEnd.ts\n// @__NO_SIDE_EFFECTS__\nfunction trimEnd() {\n  return {\n    kind: \"transformation\",\n    type: \"trim_end\",\n    reference: trimEnd,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trimEnd();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/trimStart/trimStart.ts\n// @__NO_SIDE_EFFECTS__\nfunction trimStart() {\n  return {\n    kind: \"transformation\",\n    type: \"trim_start\",\n    reference: trimStart,\n    async: false,\n    \"~run\"(dataset) {\n      dataset.value = dataset.value.trimStart();\n      return dataset;\n    }\n  };\n}\n\n// src/actions/ulid/ulid.ts\n// @__NO_SIDE_EFFECTS__\nfunction ulid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"ulid\",\n    reference: ulid,\n    async: false,\n    expects: null,\n    requirement: ULID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"ULID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/url/url.ts\n// @__NO_SIDE_EFFECTS__\nfunction url(message2) {\n  return {\n    kind: \"validation\",\n    type: \"url\",\n    reference: url,\n    async: false,\n    expects: null,\n    requirement(input) {\n      try {\n        new URL(input);\n        return true;\n      } catch {\n        return false;\n      }\n    },\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement(dataset.value)) {\n        _addIssue(this, \"URL\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/uuid/uuid.ts\n// @__NO_SIDE_EFFECTS__\nfunction uuid(message2) {\n  return {\n    kind: \"validation\",\n    type: \"uuid\",\n    reference: uuid,\n    async: false,\n    expects: null,\n    requirement: UUID_REGEX,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.test(dataset.value)) {\n        _addIssue(this, \"UUID\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/value/value.ts\n// @__NO_SIDE_EFFECTS__\nfunction value(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"value\",\n    reference: value,\n    async: false,\n    expects: requirement instanceof Date ? requirement.toJSON() : _stringify(requirement),\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !(this.requirement <= dataset.value && this.requirement >= dataset.value)) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/values/values.ts\n// @__NO_SIDE_EFFECTS__\nfunction values(requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"values\",\n    reference: values,\n    async: false,\n    expects: `${_joinExpects(\n      requirement.map(\n        (value2) => value2 instanceof Date ? value2.toJSON() : _stringify(value2)\n      ),\n      \"|\"\n    )}`,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed && !this.requirement.some(\n        (value2) => value2 <= dataset.value && value2 >= dataset.value\n      )) {\n        _addIssue(this, \"value\", dataset, config2, {\n          received: dataset.value instanceof Date ? dataset.value.toJSON() : _stringify(dataset.value)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/actions/words/words.ts\n// @__NO_SIDE_EFFECTS__\nfunction words(locales, requirement, message2) {\n  return {\n    kind: \"validation\",\n    type: \"words\",\n    reference: words,\n    async: false,\n    expects: `${requirement}`,\n    locales,\n    requirement,\n    message: message2,\n    \"~run\"(dataset, config2) {\n      if (dataset.typed) {\n        const count = _getWordCount(this.locales, dataset.value);\n        if (count !== this.requirement) {\n          _addIssue(this, \"words\", dataset, config2, {\n            received: `${count}`\n          });\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/assert/assert.ts\nfunction assert(schema, input) {\n  const issues = schema[\"~run\"]({ value: input }, { abortEarly: true }).issues;\n  if (issues) {\n    throw new ValiError(issues);\n  }\n}\n\n// src/methods/config/config.ts\n// @__NO_SIDE_EFFECTS__\nfunction config(schema, config2) {\n  return {\n    ...schema,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config_) {\n      return schema[\"~run\"](dataset, { ...config_, ...config2 });\n    }\n  };\n}\n\n// src/methods/getFallback/getFallback.ts\n// @__NO_SIDE_EFFECTS__\nfunction getFallback(schema, dataset, config2) {\n  return typeof schema.fallback === \"function\" ? (\n    // @ts-expect-error\n    schema.fallback(dataset, config2)\n  ) : (\n    // @ts-expect-error\n    schema.fallback\n  );\n}\n\n// src/methods/fallback/fallback.ts\n// @__NO_SIDE_EFFECTS__\nfunction fallback(schema, fallback2) {\n  return {\n    ...schema,\n    fallback: fallback2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const outputDataset = schema[\"~run\"](dataset, config2);\n      return outputDataset.issues ? { typed: true, value: getFallback(this, outputDataset, config2) } : outputDataset;\n    }\n  };\n}\n\n// src/methods/fallback/fallbackAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction fallbackAsync(schema, fallback2) {\n  return {\n    ...schema,\n    fallback: fallback2,\n    async: true,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const outputDataset = await schema[\"~run\"](dataset, config2);\n      return outputDataset.issues ? {\n        typed: true,\n        value: await getFallback(this, outputDataset, config2)\n      } : outputDataset;\n    }\n  };\n}\n\n// src/methods/flatten/flatten.ts\n// @__NO_SIDE_EFFECTS__\nfunction flatten(issues) {\n  const flatErrors = {};\n  for (const issue of issues) {\n    if (issue.path) {\n      const dotPath = getDotPath(issue);\n      if (dotPath) {\n        if (!flatErrors.nested) {\n          flatErrors.nested = {};\n        }\n        if (flatErrors.nested[dotPath]) {\n          flatErrors.nested[dotPath].push(issue.message);\n        } else {\n          flatErrors.nested[dotPath] = [issue.message];\n        }\n      } else {\n        if (flatErrors.other) {\n          flatErrors.other.push(issue.message);\n        } else {\n          flatErrors.other = [issue.message];\n        }\n      }\n    } else {\n      if (flatErrors.root) {\n        flatErrors.root.push(issue.message);\n      } else {\n        flatErrors.root = [issue.message];\n      }\n    }\n  }\n  return flatErrors;\n}\n\n// src/methods/forward/forward.ts\n// @__NO_SIDE_EFFECTS__\nfunction forward(action, path) {\n  return {\n    ...action,\n    \"~run\"(dataset, config2) {\n      const prevIssues = dataset.issues && [...dataset.issues];\n      dataset = action[\"~run\"](dataset, config2);\n      if (dataset.issues) {\n        for (const issue of dataset.issues) {\n          if (!prevIssues?.includes(issue)) {\n            let pathInput = dataset.value;\n            for (const key of path) {\n              const pathValue = pathInput[key];\n              const pathItem = {\n                type: \"unknown\",\n                origin: \"value\",\n                input: pathInput,\n                key,\n                value: pathValue\n              };\n              if (issue.path) {\n                issue.path.push(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              if (!pathValue) {\n                break;\n              }\n              pathInput = pathValue;\n            }\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/forward/forwardAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction forwardAsync(action, path) {\n  return {\n    ...action,\n    async: true,\n    async \"~run\"(dataset, config2) {\n      const prevIssues = dataset.issues && [...dataset.issues];\n      dataset = await action[\"~run\"](dataset, config2);\n      if (dataset.issues) {\n        for (const issue of dataset.issues) {\n          if (!prevIssues?.includes(issue)) {\n            let pathInput = dataset.value;\n            for (const key of path) {\n              const pathValue = pathInput[key];\n              const pathItem = {\n                type: \"unknown\",\n                origin: \"value\",\n                input: pathInput,\n                key,\n                value: pathValue\n              };\n              if (issue.path) {\n                issue.path.push(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              if (!pathValue) {\n                break;\n              }\n              pathInput = pathValue;\n            }\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/getDefault/getDefault.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDefault(schema, dataset, config2) {\n  return typeof schema.default === \"function\" ? (\n    // @ts-expect-error\n    schema.default(dataset, config2)\n  ) : (\n    // @ts-expect-error\n    schema.default\n  );\n}\n\n// src/methods/getDefaults/getDefaults.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDefaults(schema) {\n  if (\"entries\" in schema) {\n    const object2 = {};\n    for (const key in schema.entries) {\n      object2[key] = /* @__PURE__ */ getDefaults(schema.entries[key]);\n    }\n    return object2;\n  }\n  if (\"items\" in schema) {\n    return schema.items.map(getDefaults);\n  }\n  return getDefault(schema);\n}\n\n// src/methods/getDefaults/getDefaultsAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function getDefaultsAsync(schema) {\n  if (\"entries\" in schema) {\n    return Object.fromEntries(\n      await Promise.all(\n        Object.entries(schema.entries).map(async ([key, value2]) => [\n          key,\n          await /* @__PURE__ */ getDefaultsAsync(value2)\n        ])\n      )\n    );\n  }\n  if (\"items\" in schema) {\n    return Promise.all(schema.items.map(getDefaultsAsync));\n  }\n  return getDefault(schema);\n}\n\n// src/methods/getDescription/getDescription.ts\n// @__NO_SIDE_EFFECTS__\nfunction getDescription(schema) {\n  return _getLastMetadata(schema, \"description\");\n}\n\n// src/methods/getFallbacks/getFallbacks.ts\n// @__NO_SIDE_EFFECTS__\nfunction getFallbacks(schema) {\n  if (\"entries\" in schema) {\n    const object2 = {};\n    for (const key in schema.entries) {\n      object2[key] = /* @__PURE__ */ getFallbacks(schema.entries[key]);\n    }\n    return object2;\n  }\n  if (\"items\" in schema) {\n    return schema.items.map(getFallbacks);\n  }\n  return getFallback(schema);\n}\n\n// src/methods/getFallbacks/getFallbacksAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function getFallbacksAsync(schema) {\n  if (\"entries\" in schema) {\n    return Object.fromEntries(\n      await Promise.all(\n        Object.entries(schema.entries).map(async ([key, value2]) => [\n          key,\n          await /* @__PURE__ */ getFallbacksAsync(value2)\n        ])\n      )\n    );\n  }\n  if (\"items\" in schema) {\n    return Promise.all(schema.items.map(getFallbacksAsync));\n  }\n  return getFallback(schema);\n}\n\n// src/methods/getMetadata/getMetadata.ts\n// @__NO_SIDE_EFFECTS__\nfunction getMetadata(schema) {\n  const result = {};\n  function depthFirstMerge(schema2) {\n    if (\"pipe\" in schema2) {\n      for (const item of schema2.pipe) {\n        if (item.kind === \"schema\" && \"pipe\" in item) {\n          depthFirstMerge(item);\n        } else if (item.kind === \"metadata\" && item.type === \"metadata\") {\n          Object.assign(result, item.metadata);\n        }\n      }\n    }\n  }\n  depthFirstMerge(schema);\n  return result;\n}\n\n// src/methods/getTitle/getTitle.ts\n// @__NO_SIDE_EFFECTS__\nfunction getTitle(schema) {\n  return _getLastMetadata(schema, \"title\");\n}\n\n// src/methods/is/is.ts\n// @__NO_SIDE_EFFECTS__\nfunction is(schema, input) {\n  return !schema[\"~run\"]({ value: input }, { abortEarly: true }).issues;\n}\n\n// src/schemas/any/any.ts\n// @__NO_SIDE_EFFECTS__\nfunction any() {\n  return {\n    kind: \"schema\",\n    type: \"any\",\n    reference: any,\n    expects: \"any\",\n    async: false,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset) {\n      dataset.typed = true;\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/array/array.ts\n// @__NO_SIDE_EFFECTS__\nfunction array(item, message2) {\n  return {\n    kind: \"schema\",\n    type: \"array\",\n    reference: array,\n    expects: \"Array\",\n    async: false,\n    item,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < input.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.item[\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/array/arrayAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction arrayAsync(item, message2) {\n  return {\n    kind: \"schema\",\n    type: \"array\",\n    reference: arrayAsync,\n    expects: \"Array\",\n    async: true,\n    item,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          input.map((value2) => this.item[\"~run\"]({ value: value2 }, config2))\n        );\n        for (let key = 0; key < itemDatasets.length; key++) {\n          const itemDataset = itemDatasets[key];\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: input[key]\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/bigint/bigint.ts\n// @__NO_SIDE_EFFECTS__\nfunction bigint(message2) {\n  return {\n    kind: \"schema\",\n    type: \"bigint\",\n    reference: bigint,\n    expects: \"bigint\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"bigint\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/blob/blob.ts\n// @__NO_SIDE_EFFECTS__\nfunction blob(message2) {\n  return {\n    kind: \"schema\",\n    type: \"blob\",\n    reference: blob,\n    expects: \"Blob\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Blob) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/boolean/boolean.ts\n// @__NO_SIDE_EFFECTS__\nfunction boolean(message2) {\n  return {\n    kind: \"schema\",\n    type: \"boolean\",\n    reference: boolean,\n    expects: \"boolean\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"boolean\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/custom/custom.ts\n// @__NO_SIDE_EFFECTS__\nfunction custom(check2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"custom\",\n    reference: custom,\n    expects: \"unknown\",\n    async: false,\n    check: check2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.check(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/custom/customAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction customAsync(check2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"custom\",\n    reference: customAsync,\n    expects: \"unknown\",\n    async: true,\n    check: check2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (await this.check(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/date/date.ts\n// @__NO_SIDE_EFFECTS__\nfunction date(message2) {\n  return {\n    kind: \"schema\",\n    type: \"date\",\n    reference: date,\n    expects: \"Date\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Date) {\n        if (!isNaN(dataset.value)) {\n          dataset.typed = true;\n        } else {\n          _addIssue(this, \"type\", dataset, config2, {\n            received: '\"Invalid Date\"'\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/enum/enum.ts\n// @__NO_SIDE_EFFECTS__\nfunction enum_(enum__, message2) {\n  const options = [];\n  for (const key in enum__) {\n    if (`${+key}` !== key || typeof enum__[key] !== \"string\" || !Object.is(enum__[enum__[key]], +key)) {\n      options.push(enum__[key]);\n    }\n  }\n  return {\n    kind: \"schema\",\n    type: \"enum\",\n    reference: enum_,\n    expects: _joinExpects(options.map(_stringify), \"|\"),\n    async: false,\n    enum: enum__,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.includes(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/exactOptional/exactOptional.ts\n// @__NO_SIDE_EFFECTS__\nfunction exactOptional(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"exact_optional\",\n    reference: exactOptional,\n    expects: wrapped.expects,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/exactOptional/exactOptionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction exactOptionalAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"exact_optional\",\n    reference: exactOptionalAsync,\n    expects: wrapped.expects,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/file/file.ts\n// @__NO_SIDE_EFFECTS__\nfunction file(message2) {\n  return {\n    kind: \"schema\",\n    type: \"file\",\n    reference: file,\n    expects: \"File\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof File) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/function/function.ts\n// @__NO_SIDE_EFFECTS__\nfunction function_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"function\",\n    reference: function_,\n    expects: \"Function\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"function\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/instance/instance.ts\n// @__NO_SIDE_EFFECTS__\nfunction instance(class_, message2) {\n  return {\n    kind: \"schema\",\n    type: \"instance\",\n    reference: instance,\n    expects: class_.name,\n    async: false,\n    class: class_,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof this.class) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/intersect/utils/_merge/_merge.ts\n// @__NO_SIDE_EFFECTS__\nfunction _merge(value1, value2) {\n  if (typeof value1 === typeof value2) {\n    if (value1 === value2 || value1 instanceof Date && value2 instanceof Date && +value1 === +value2) {\n      return { value: value1 };\n    }\n    if (value1 && value2 && value1.constructor === Object && value2.constructor === Object) {\n      for (const key in value2) {\n        if (key in value1) {\n          const dataset = /* @__PURE__ */ _merge(value1[key], value2[key]);\n          if (dataset.issue) {\n            return dataset;\n          }\n          value1[key] = dataset.value;\n        } else {\n          value1[key] = value2[key];\n        }\n      }\n      return { value: value1 };\n    }\n    if (Array.isArray(value1) && Array.isArray(value2)) {\n      if (value1.length === value2.length) {\n        for (let index = 0; index < value1.length; index++) {\n          const dataset = /* @__PURE__ */ _merge(value1[index], value2[index]);\n          if (dataset.issue) {\n            return dataset;\n          }\n          value1[index] = dataset.value;\n        }\n        return { value: value1 };\n      }\n    }\n  }\n  return { issue: true };\n}\n\n// src/schemas/intersect/intersect.ts\n// @__NO_SIDE_EFFECTS__\nfunction intersect(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"intersect\",\n    reference: intersect,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"&\"\n    ),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.length) {\n        const input = dataset.value;\n        let outputs;\n        dataset.typed = true;\n        for (const schema of this.options) {\n          const optionDataset = schema[\"~run\"]({ value: input }, config2);\n          if (optionDataset.issues) {\n            if (dataset.issues) {\n              dataset.issues.push(...optionDataset.issues);\n            } else {\n              dataset.issues = optionDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!optionDataset.typed) {\n            dataset.typed = false;\n          }\n          if (dataset.typed) {\n            if (outputs) {\n              outputs.push(optionDataset.value);\n            } else {\n              outputs = [optionDataset.value];\n            }\n          }\n        }\n        if (dataset.typed) {\n          dataset.value = outputs[0];\n          for (let index = 1; index < outputs.length; index++) {\n            const mergeDataset = _merge(dataset.value, outputs[index]);\n            if (mergeDataset.issue) {\n              _addIssue(this, \"type\", dataset, config2, {\n                received: \"unknown\"\n              });\n              break;\n            }\n            dataset.value = mergeDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/intersect/intersectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction intersectAsync(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"intersect\",\n    reference: intersectAsync,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"&\"\n    ),\n    async: true,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (this.options.length) {\n        const input = dataset.value;\n        let outputs;\n        dataset.typed = true;\n        const optionDatasets = await Promise.all(\n          this.options.map((schema) => schema[\"~run\"]({ value: input }, config2))\n        );\n        for (const optionDataset of optionDatasets) {\n          if (optionDataset.issues) {\n            if (dataset.issues) {\n              dataset.issues.push(...optionDataset.issues);\n            } else {\n              dataset.issues = optionDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!optionDataset.typed) {\n            dataset.typed = false;\n          }\n          if (dataset.typed) {\n            if (outputs) {\n              outputs.push(optionDataset.value);\n            } else {\n              outputs = [optionDataset.value];\n            }\n          }\n        }\n        if (dataset.typed) {\n          dataset.value = outputs[0];\n          for (let index = 1; index < outputs.length; index++) {\n            const mergeDataset = _merge(dataset.value, outputs[index]);\n            if (mergeDataset.issue) {\n              _addIssue(this, \"type\", dataset, config2, {\n                received: \"unknown\"\n              });\n              break;\n            }\n            dataset.value = mergeDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/lazy/lazy.ts\n// @__NO_SIDE_EFFECTS__\nfunction lazy(getter) {\n  return {\n    kind: \"schema\",\n    type: \"lazy\",\n    reference: lazy,\n    expects: \"unknown\",\n    async: false,\n    getter,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return this.getter(dataset.value)[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/lazy/lazyAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction lazyAsync(getter) {\n  return {\n    kind: \"schema\",\n    type: \"lazy\",\n    reference: lazyAsync,\n    expects: \"unknown\",\n    async: true,\n    getter,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      return (await this.getter(dataset.value))[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/literal/literal.ts\n// @__NO_SIDE_EFFECTS__\nfunction literal(literal_, message2) {\n  return {\n    kind: \"schema\",\n    type: \"literal\",\n    reference: literal,\n    expects: _stringify(literal_),\n    async: false,\n    literal: literal_,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === this.literal) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseObject/looseObject.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseObject(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_object\",\n    reference: looseObject,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              dataset.value[key] = input[key];\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseObject/looseObjectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseObjectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_object\",\n    reference: looseObjectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              dataset.value[key] = input[key];\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseTuple/looseTuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseTuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_tuple\",\n    reference: looseTuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            dataset.value.push(input[key]);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/looseTuple/looseTupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction looseTupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"loose_tuple\",\n    reference: looseTupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            dataset.value.push(input[key]);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/map/map.ts\n// @__NO_SIDE_EFFECTS__\nfunction map(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"map\",\n    reference: map,\n    expects: \"Map\",\n    async: false,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Map) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Map();\n        for (const [inputKey, inputValue] of input) {\n          const keyDataset = this.key[\"~run\"]({ value: inputKey }, config2);\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"key\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of keyDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          const valueDataset = this.value[\"~run\"](\n            { value: inputValue },\n            config2\n          );\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"value\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.set(keyDataset.value, valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/map/mapAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction mapAsync(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"map\",\n    reference: mapAsync,\n    expects: \"Map\",\n    async: true,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Map) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Map();\n        const datasets = await Promise.all(\n          [...input].map(\n            ([inputKey, inputValue]) => Promise.all([\n              inputKey,\n              inputValue,\n              this.key[\"~run\"]({ value: inputKey }, config2),\n              this.value[\"~run\"]({ value: inputValue }, config2)\n            ])\n          )\n        );\n        for (const [\n          inputKey,\n          inputValue,\n          keyDataset,\n          valueDataset\n        ] of datasets) {\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"key\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of keyDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"map\",\n              origin: \"value\",\n              input,\n              key: inputKey,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.set(keyDataset.value, valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nan/nan.ts\n// @__NO_SIDE_EFFECTS__\nfunction nan(message2) {\n  return {\n    kind: \"schema\",\n    type: \"nan\",\n    reference: nan,\n    expects: \"NaN\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (Number.isNaN(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/never/never.ts\n// @__NO_SIDE_EFFECTS__\nfunction never(message2) {\n  return {\n    kind: \"schema\",\n    type: \"never\",\n    reference: never,\n    expects: \"never\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      _addIssue(this, \"type\", dataset, config2);\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullable/nonNullable.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullable(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullable\",\n    reference: nonNullable,\n    expects: \"!null\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value !== null) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullable/nonNullableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullableAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullable\",\n    reference: nonNullableAsync,\n    expects: \"!null\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value !== null) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullish/nonNullish.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullish(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullish\",\n    reference: nonNullish,\n    expects: \"(!null & !undefined)\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (!(dataset.value === null || dataset.value === void 0)) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null || dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonNullish/nonNullishAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonNullishAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_nullish\",\n    reference: nonNullishAsync,\n    expects: \"(!null & !undefined)\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (!(dataset.value === null || dataset.value === void 0)) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === null || dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonOptional/nonOptional.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonOptional(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_optional\",\n    reference: nonOptional,\n    expects: \"!undefined\",\n    async: false,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value !== void 0) {\n        dataset = this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nonOptional/nonOptionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nonOptionalAsync(wrapped, message2) {\n  return {\n    kind: \"schema\",\n    type: \"non_optional\",\n    reference: nonOptionalAsync,\n    expects: \"!undefined\",\n    async: true,\n    wrapped,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value !== void 0) {\n        dataset = await this.wrapped[\"~run\"](dataset, config2);\n      }\n      if (dataset.value === void 0) {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/null/null.ts\n// @__NO_SIDE_EFFECTS__\nfunction null_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"null\",\n    reference: null_,\n    expects: \"null\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/nullable/nullable.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullable(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullable\",\n    reference: nullable,\n    expects: `(${wrapped.expects} | null)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullable/nullableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullableAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullable\",\n    reference: nullableAsync,\n    expects: `(${wrapped.expects} | null)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === null) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullish/nullish.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullish(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullish\",\n    reference: nullish,\n    expects: `(${wrapped.expects} | null | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === null || dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null || dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/nullish/nullishAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction nullishAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"nullish\",\n    reference: nullishAsync,\n    expects: `(${wrapped.expects} | null | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === null || dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === null || dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/number/number.ts\n// @__NO_SIDE_EFFECTS__\nfunction number(message2) {\n  return {\n    kind: \"schema\",\n    type: \"number\",\n    reference: number,\n    expects: \"number\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"number\" && !isNaN(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/object/object.ts\n// @__NO_SIDE_EFFECTS__\nfunction object(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object\",\n    reference: object,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/object/objectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object\",\n    reference: objectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/objectWithRest/objectWithRest.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectWithRest(entries2, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object_with_rest\",\n    reference: objectWithRest,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (_isValidObjectKey(input, key) && !(key in this.entries)) {\n              const valueDataset = this.rest[\"~run\"](\n                // @ts-expect-error\n                { value: input[key] },\n                config2\n              );\n              if (valueDataset.issues) {\n                const pathItem = {\n                  type: \"object\",\n                  origin: \"value\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                };\n                for (const issue of valueDataset.issues) {\n                  if (issue.path) {\n                    issue.path.unshift(pathItem);\n                  } else {\n                    issue.path = [pathItem];\n                  }\n                  dataset.issues?.push(issue);\n                }\n                if (!dataset.issues) {\n                  dataset.issues = valueDataset.issues;\n                }\n                if (config2.abortEarly) {\n                  dataset.typed = false;\n                  break;\n                }\n              }\n              if (!valueDataset.typed) {\n                dataset.typed = false;\n              }\n              dataset.value[key] = valueDataset.value;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/objectWithRest/objectWithRestAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction objectWithRestAsync(entries2, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"object_with_rest\",\n    reference: objectWithRestAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const [normalDatasets, restDatasets] = await Promise.all([\n          // If key is present or its an optional schema with a default value,\n          // parse input of key or default value asynchronously\n          Promise.all(\n            Object.entries(this.entries).map(async ([key, valueSchema]) => {\n              if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n              valueSchema.default !== void 0) {\n                const value2 = key in input ? (\n                  // @ts-expect-error\n                  input[key]\n                ) : await getDefault(valueSchema);\n                return [\n                  key,\n                  value2,\n                  valueSchema,\n                  await valueSchema[\"~run\"]({ value: value2 }, config2)\n                ];\n              }\n              return [\n                key,\n                // @ts-expect-error\n                input[key],\n                valueSchema,\n                null\n              ];\n            })\n          ),\n          // Parse other entries with rest schema asynchronously\n          // Hint: We exclude specific keys for security reasons\n          Promise.all(\n            Object.entries(input).filter(\n              ([key]) => _isValidObjectKey(input, key) && !(key in this.entries)\n            ).map(\n              async ([key, value2]) => [\n                key,\n                value2,\n                await this.rest[\"~run\"]({ value: value2 }, config2)\n              ]\n            )\n          )\n        ]);\n        for (const [key, value2, valueSchema, valueDataset] of normalDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const [key, value2, valueDataset] of restDatasets) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/optional/optional.ts\n// @__NO_SIDE_EFFECTS__\nfunction optional(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"optional\",\n    reference: optional,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/optional/optionalAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction optionalAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"optional\",\n    reference: optionalAsync,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/picklist/picklist.ts\n// @__NO_SIDE_EFFECTS__\nfunction picklist(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"picklist\",\n    reference: picklist,\n    expects: _joinExpects(options.map(_stringify), \"|\"),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (this.options.includes(dataset.value)) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/promise/promise.ts\n// @__NO_SIDE_EFFECTS__\nfunction promise(message2) {\n  return {\n    kind: \"schema\",\n    type: \"promise\",\n    reference: promise,\n    expects: \"Promise\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value instanceof Promise) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/record/record.ts\n// @__NO_SIDE_EFFECTS__\nfunction record(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"record\",\n    reference: record,\n    expects: \"Object\",\n    async: false,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const entryKey in input) {\n          if (_isValidObjectKey(input, entryKey)) {\n            const entryValue = input[entryKey];\n            const keyDataset = this.key[\"~run\"]({ value: entryKey }, config2);\n            if (keyDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"key\",\n                input,\n                key: entryKey,\n                value: entryValue\n              };\n              for (const issue of keyDataset.issues) {\n                issue.path = [pathItem];\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = keyDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            const valueDataset = this.value[\"~run\"](\n              { value: entryValue },\n              config2\n            );\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key: entryKey,\n                value: entryValue\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!keyDataset.typed || !valueDataset.typed) {\n              dataset.typed = false;\n            }\n            if (keyDataset.typed) {\n              dataset.value[keyDataset.value] = valueDataset.value;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/record/recordAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction recordAsync(key, value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"record\",\n    reference: recordAsync,\n    expects: \"Object\",\n    async: true,\n    key,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const datasets = await Promise.all(\n          Object.entries(input).filter(([key2]) => _isValidObjectKey(input, key2)).map(\n            ([entryKey, entryValue]) => Promise.all([\n              entryKey,\n              entryValue,\n              this.key[\"~run\"]({ value: entryKey }, config2),\n              this.value[\"~run\"]({ value: entryValue }, config2)\n            ])\n          )\n        );\n        for (const [\n          entryKey,\n          entryValue,\n          keyDataset,\n          valueDataset\n        ] of datasets) {\n          if (keyDataset.issues) {\n            const pathItem = {\n              type: \"object\",\n              origin: \"key\",\n              input,\n              key: entryKey,\n              value: entryValue\n            };\n            for (const issue of keyDataset.issues) {\n              issue.path = [pathItem];\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = keyDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: entryKey,\n              value: entryValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!keyDataset.typed || !valueDataset.typed) {\n            dataset.typed = false;\n          }\n          if (keyDataset.typed) {\n            dataset.value[keyDataset.value] = valueDataset.value;\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/set/set.ts\n// @__NO_SIDE_EFFECTS__\nfunction set(value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"set\",\n    reference: set,\n    expects: \"Set\",\n    async: false,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Set) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Set();\n        for (const inputValue of input) {\n          const valueDataset = this.value[\"~run\"](\n            { value: inputValue },\n            config2\n          );\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"set\",\n              origin: \"value\",\n              input,\n              key: null,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.add(valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/set/setAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction setAsync(value2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"set\",\n    reference: setAsync,\n    expects: \"Set\",\n    async: true,\n    value: value2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input instanceof Set) {\n        dataset.typed = true;\n        dataset.value = /* @__PURE__ */ new Set();\n        const valueDatasets = await Promise.all(\n          [...input].map(\n            async (inputValue) => [\n              inputValue,\n              await this.value[\"~run\"]({ value: inputValue }, config2)\n            ]\n          )\n        );\n        for (const [inputValue, valueDataset] of valueDatasets) {\n          if (valueDataset.issues) {\n            const pathItem = {\n              type: \"set\",\n              origin: \"value\",\n              input,\n              key: null,\n              value: inputValue\n            };\n            for (const issue of valueDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = valueDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!valueDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.add(valueDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictObject/strictObject.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictObject(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_object\",\n    reference: strictObject,\n    expects: \"Object\",\n    async: false,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        for (const key in this.entries) {\n          const valueSchema = this.entries[key];\n          if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n          valueSchema.default !== void 0) {\n            const value2 = key in input ? (\n              // @ts-expect-error\n              input[key]\n            ) : getDefault(valueSchema);\n            const valueDataset = valueSchema[\"~run\"]({ value: value2 }, config2);\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  // @ts-expect-error\n                  value: input[key]\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (!(key in this.entries)) {\n              _addIssue(this, \"key\", dataset, config2, {\n                input: key,\n                expected: \"never\",\n                path: [\n                  {\n                    type: \"object\",\n                    origin: \"key\",\n                    input,\n                    key,\n                    // @ts-expect-error\n                    value: input[key]\n                  }\n                ]\n              });\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictObject/strictObjectAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictObjectAsync(entries2, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_object\",\n    reference: strictObjectAsync,\n    expects: \"Object\",\n    async: true,\n    entries: entries2,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        dataset.typed = true;\n        dataset.value = {};\n        const valueDatasets = await Promise.all(\n          Object.entries(this.entries).map(async ([key, valueSchema]) => {\n            if (key in input || (valueSchema.type === \"exact_optional\" || valueSchema.type === \"optional\" || valueSchema.type === \"nullish\") && // @ts-expect-error\n            valueSchema.default !== void 0) {\n              const value2 = key in input ? (\n                // @ts-expect-error\n                input[key]\n              ) : await getDefault(valueSchema);\n              return [\n                key,\n                value2,\n                valueSchema,\n                await valueSchema[\"~run\"]({ value: value2 }, config2)\n              ];\n            }\n            return [\n              key,\n              // @ts-expect-error\n              input[key],\n              valueSchema,\n              null\n            ];\n          })\n        );\n        for (const [key, value2, valueSchema, valueDataset] of valueDatasets) {\n          if (valueDataset) {\n            if (valueDataset.issues) {\n              const pathItem = {\n                type: \"object\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of valueDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = valueDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!valueDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value[key] = valueDataset.value;\n          } else if (valueSchema.fallback !== void 0) {\n            dataset.value[key] = await getFallback(valueSchema);\n          } else if (valueSchema.type !== \"exact_optional\" && valueSchema.type !== \"optional\" && valueSchema.type !== \"nullish\") {\n            _addIssue(this, \"key\", dataset, config2, {\n              input: void 0,\n              expected: `\"${key}\"`,\n              path: [\n                {\n                  type: \"object\",\n                  origin: \"key\",\n                  input,\n                  key,\n                  value: value2\n                }\n              ]\n            });\n            if (config2.abortEarly) {\n              break;\n            }\n          }\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const key in input) {\n            if (!(key in this.entries)) {\n              _addIssue(this, \"key\", dataset, config2, {\n                input: key,\n                expected: \"never\",\n                path: [\n                  {\n                    type: \"object\",\n                    origin: \"key\",\n                    input,\n                    key,\n                    // @ts-expect-error\n                    value: input[key]\n                  }\n                ]\n              });\n              break;\n            }\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictTuple/strictTuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictTuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_tuple\",\n    reference: strictTuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!(dataset.issues && config2.abortEarly) && this.items.length < input.length) {\n          _addIssue(this, \"type\", dataset, config2, {\n            input: input[this.items.length],\n            expected: \"never\",\n            path: [\n              {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key: this.items.length,\n                value: input[this.items.length]\n              }\n            ]\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/strictTuple/strictTupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction strictTupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"strict_tuple\",\n    reference: strictTupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!(dataset.issues && config2.abortEarly) && this.items.length < input.length) {\n          _addIssue(this, \"type\", dataset, config2, {\n            input: input[this.items.length],\n            expected: \"never\",\n            path: [\n              {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key: this.items.length,\n                value: input[this.items.length]\n              }\n            ]\n          });\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/string/string.ts\n// @__NO_SIDE_EFFECTS__\nfunction string(message2) {\n  return {\n    kind: \"schema\",\n    type: \"string\",\n    reference: string,\n    expects: \"string\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"string\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/symbol/symbol.ts\n// @__NO_SIDE_EFFECTS__\nfunction symbol(message2) {\n  return {\n    kind: \"schema\",\n    type: \"symbol\",\n    reference: symbol,\n    expects: \"symbol\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (typeof dataset.value === \"symbol\") {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tuple/tuple.ts\n// @__NO_SIDE_EFFECTS__\nfunction tuple(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple\",\n    reference: tuple,\n    expects: \"Array\",\n    async: false,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tuple/tupleAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleAsync(items, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple\",\n    reference: tupleAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const itemDatasets = await Promise.all(\n          this.items.map(async (item, key) => {\n            const value2 = input[key];\n            return [key, value2, await item[\"~run\"]({ value: value2 }, config2)];\n          })\n        );\n        for (const [key, value2, itemDataset] of itemDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tupleWithRest/tupleWithRest.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleWithRest(items, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple_with_rest\",\n    reference: tupleWithRest,\n    expects: \"Array\",\n    async: false,\n    items,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        for (let key = 0; key < this.items.length; key++) {\n          const value2 = input[key];\n          const itemDataset = this.items[key][\"~run\"]({ value: value2 }, config2);\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (let key = this.items.length; key < input.length; key++) {\n            const value2 = input[key];\n            const itemDataset = this.rest[\"~run\"]({ value: value2 }, config2);\n            if (itemDataset.issues) {\n              const pathItem = {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of itemDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = itemDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!itemDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value.push(itemDataset.value);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/tupleWithRest/tupleWithRestAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction tupleWithRestAsync(items, rest, message2) {\n  return {\n    kind: \"schema\",\n    type: \"tuple_with_rest\",\n    reference: tupleWithRestAsync,\n    expects: \"Array\",\n    async: true,\n    items,\n    rest,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (Array.isArray(input)) {\n        dataset.typed = true;\n        dataset.value = [];\n        const [normalDatasets, restDatasets] = await Promise.all([\n          // Parse schema of each normal item\n          Promise.all(\n            this.items.map(async (item, key) => {\n              const value2 = input[key];\n              return [\n                key,\n                value2,\n                await item[\"~run\"]({ value: value2 }, config2)\n              ];\n            })\n          ),\n          // Parse other items with rest schema\n          Promise.all(\n            input.slice(this.items.length).map(async (value2, key) => {\n              return [\n                key + this.items.length,\n                value2,\n                await this.rest[\"~run\"]({ value: value2 }, config2)\n              ];\n            })\n          )\n        ]);\n        for (const [key, value2, itemDataset] of normalDatasets) {\n          if (itemDataset.issues) {\n            const pathItem = {\n              type: \"array\",\n              origin: \"value\",\n              input,\n              key,\n              value: value2\n            };\n            for (const issue of itemDataset.issues) {\n              if (issue.path) {\n                issue.path.unshift(pathItem);\n              } else {\n                issue.path = [pathItem];\n              }\n              dataset.issues?.push(issue);\n            }\n            if (!dataset.issues) {\n              dataset.issues = itemDataset.issues;\n            }\n            if (config2.abortEarly) {\n              dataset.typed = false;\n              break;\n            }\n          }\n          if (!itemDataset.typed) {\n            dataset.typed = false;\n          }\n          dataset.value.push(itemDataset.value);\n        }\n        if (!dataset.issues || !config2.abortEarly) {\n          for (const [key, value2, itemDataset] of restDatasets) {\n            if (itemDataset.issues) {\n              const pathItem = {\n                type: \"array\",\n                origin: \"value\",\n                input,\n                key,\n                value: value2\n              };\n              for (const issue of itemDataset.issues) {\n                if (issue.path) {\n                  issue.path.unshift(pathItem);\n                } else {\n                  issue.path = [pathItem];\n                }\n                dataset.issues?.push(issue);\n              }\n              if (!dataset.issues) {\n                dataset.issues = itemDataset.issues;\n              }\n              if (config2.abortEarly) {\n                dataset.typed = false;\n                break;\n              }\n            }\n            if (!itemDataset.typed) {\n              dataset.typed = false;\n            }\n            dataset.value.push(itemDataset.value);\n          }\n        }\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/undefined/undefined.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefined_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"undefined\",\n    reference: undefined_,\n    expects: \"undefined\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/undefinedable/undefinedable.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefinedable(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"undefinedable\",\n    reference: undefinedable,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: false,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/undefinedable/undefinedableAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction undefinedableAsync(wrapped, default_) {\n  return {\n    kind: \"schema\",\n    type: \"undefinedable\",\n    reference: undefinedableAsync,\n    expects: `(${wrapped.expects} | undefined)`,\n    async: true,\n    wrapped,\n    default: default_,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        if (this.default !== void 0) {\n          dataset.value = await getDefault(this, dataset, config2);\n        }\n        if (dataset.value === void 0) {\n          dataset.typed = true;\n          return dataset;\n        }\n      }\n      return this.wrapped[\"~run\"](dataset, config2);\n    }\n  };\n}\n\n// src/schemas/union/utils/_subIssues/_subIssues.ts\n// @__NO_SIDE_EFFECTS__\nfunction _subIssues(datasets) {\n  let issues;\n  if (datasets) {\n    for (const dataset of datasets) {\n      if (issues) {\n        issues.push(...dataset.issues);\n      } else {\n        issues = dataset.issues;\n      }\n    }\n  }\n  return issues;\n}\n\n// src/schemas/union/union.ts\n// @__NO_SIDE_EFFECTS__\nfunction union(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"union\",\n    reference: union,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"|\"\n    ),\n    async: false,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      let validDataset;\n      let typedDatasets;\n      let untypedDatasets;\n      for (const schema of this.options) {\n        const optionDataset = schema[\"~run\"]({ value: dataset.value }, config2);\n        if (optionDataset.typed) {\n          if (optionDataset.issues) {\n            if (typedDatasets) {\n              typedDatasets.push(optionDataset);\n            } else {\n              typedDatasets = [optionDataset];\n            }\n          } else {\n            validDataset = optionDataset;\n            break;\n          }\n        } else {\n          if (untypedDatasets) {\n            untypedDatasets.push(optionDataset);\n          } else {\n            untypedDatasets = [optionDataset];\n          }\n        }\n      }\n      if (validDataset) {\n        return validDataset;\n      }\n      if (typedDatasets) {\n        if (typedDatasets.length === 1) {\n          return typedDatasets[0];\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(typedDatasets)\n        });\n        dataset.typed = true;\n      } else if (untypedDatasets?.length === 1) {\n        return untypedDatasets[0];\n      } else {\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(untypedDatasets)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/union/unionAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction unionAsync(options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"union\",\n    reference: unionAsync,\n    expects: _joinExpects(\n      options.map((option) => option.expects),\n      \"|\"\n    ),\n    async: true,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      let validDataset;\n      let typedDatasets;\n      let untypedDatasets;\n      for (const schema of this.options) {\n        const optionDataset = await schema[\"~run\"](\n          { value: dataset.value },\n          config2\n        );\n        if (optionDataset.typed) {\n          if (optionDataset.issues) {\n            if (typedDatasets) {\n              typedDatasets.push(optionDataset);\n            } else {\n              typedDatasets = [optionDataset];\n            }\n          } else {\n            validDataset = optionDataset;\n            break;\n          }\n        } else {\n          if (untypedDatasets) {\n            untypedDatasets.push(optionDataset);\n          } else {\n            untypedDatasets = [optionDataset];\n          }\n        }\n      }\n      if (validDataset) {\n        return validDataset;\n      }\n      if (typedDatasets) {\n        if (typedDatasets.length === 1) {\n          return typedDatasets[0];\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(typedDatasets)\n        });\n        dataset.typed = true;\n      } else if (untypedDatasets?.length === 1) {\n        return untypedDatasets[0];\n      } else {\n        _addIssue(this, \"type\", dataset, config2, {\n          issues: _subIssues(untypedDatasets)\n        });\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/unknown/unknown.ts\n// @__NO_SIDE_EFFECTS__\nfunction unknown() {\n  return {\n    kind: \"schema\",\n    type: \"unknown\",\n    reference: unknown,\n    expects: \"unknown\",\n    async: false,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset) {\n      dataset.typed = true;\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/variant/variant.ts\n// @__NO_SIDE_EFFECTS__\nfunction variant(key, options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"variant\",\n    reference: variant,\n    expects: \"Object\",\n    async: false,\n    key,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        let outputDataset;\n        let maxDiscriminatorPriority = 0;\n        let invalidDiscriminatorKey = this.key;\n        let expectedDiscriminators = [];\n        const parseOptions = (variant2, allKeys) => {\n          for (const schema of variant2.options) {\n            if (schema.type === \"variant\") {\n              parseOptions(schema, new Set(allKeys).add(schema.key));\n            } else {\n              let keysAreValid = true;\n              let currentPriority = 0;\n              for (const currentKey of allKeys) {\n                const discriminatorSchema = schema.entries[currentKey];\n                if (currentKey in input ? discriminatorSchema[\"~run\"](\n                  // @ts-expect-error\n                  { typed: false, value: input[currentKey] },\n                  { abortEarly: true }\n                ).issues : discriminatorSchema.type !== \"exact_optional\" && discriminatorSchema.type !== \"optional\" && discriminatorSchema.type !== \"nullish\") {\n                  keysAreValid = false;\n                  if (invalidDiscriminatorKey !== currentKey && (maxDiscriminatorPriority < currentPriority || maxDiscriminatorPriority === currentPriority && currentKey in input && !(invalidDiscriminatorKey in input))) {\n                    maxDiscriminatorPriority = currentPriority;\n                    invalidDiscriminatorKey = currentKey;\n                    expectedDiscriminators = [];\n                  }\n                  if (invalidDiscriminatorKey === currentKey) {\n                    expectedDiscriminators.push(\n                      schema.entries[currentKey].expects\n                    );\n                  }\n                  break;\n                }\n                currentPriority++;\n              }\n              if (keysAreValid) {\n                const optionDataset = schema[\"~run\"]({ value: input }, config2);\n                if (!outputDataset || !outputDataset.typed && optionDataset.typed) {\n                  outputDataset = optionDataset;\n                }\n              }\n            }\n            if (outputDataset && !outputDataset.issues) {\n              break;\n            }\n          }\n        };\n        parseOptions(this, /* @__PURE__ */ new Set([this.key]));\n        if (outputDataset) {\n          return outputDataset;\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          // @ts-expect-error\n          input: input[invalidDiscriminatorKey],\n          expected: _joinExpects(expectedDiscriminators, \"|\"),\n          path: [\n            {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: invalidDiscriminatorKey,\n              // @ts-expect-error\n              value: input[invalidDiscriminatorKey]\n            }\n          ]\n        });\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/variant/variantAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction variantAsync(key, options, message2) {\n  return {\n    kind: \"schema\",\n    type: \"variant\",\n    reference: variantAsync,\n    expects: \"Object\",\n    async: true,\n    key,\n    options,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      const input = dataset.value;\n      if (input && typeof input === \"object\") {\n        let outputDataset;\n        let maxDiscriminatorPriority = 0;\n        let invalidDiscriminatorKey = this.key;\n        let expectedDiscriminators = [];\n        const parseOptions = async (variant2, allKeys) => {\n          for (const schema of variant2.options) {\n            if (schema.type === \"variant\") {\n              await parseOptions(schema, new Set(allKeys).add(schema.key));\n            } else {\n              let keysAreValid = true;\n              let currentPriority = 0;\n              for (const currentKey of allKeys) {\n                const discriminatorSchema = schema.entries[currentKey];\n                if (currentKey in input ? (await discriminatorSchema[\"~run\"](\n                  // @ts-expect-error\n                  { typed: false, value: input[currentKey] },\n                  { abortEarly: true }\n                )).issues : discriminatorSchema.type !== \"exact_optional\" && discriminatorSchema.type !== \"optional\" && discriminatorSchema.type !== \"nullish\") {\n                  keysAreValid = false;\n                  if (invalidDiscriminatorKey !== currentKey && (maxDiscriminatorPriority < currentPriority || maxDiscriminatorPriority === currentPriority && currentKey in input && !(invalidDiscriminatorKey in input))) {\n                    maxDiscriminatorPriority = currentPriority;\n                    invalidDiscriminatorKey = currentKey;\n                    expectedDiscriminators = [];\n                  }\n                  if (invalidDiscriminatorKey === currentKey) {\n                    expectedDiscriminators.push(\n                      schema.entries[currentKey].expects\n                    );\n                  }\n                  break;\n                }\n                currentPriority++;\n              }\n              if (keysAreValid) {\n                const optionDataset = await schema[\"~run\"](\n                  { value: input },\n                  config2\n                );\n                if (!outputDataset || !outputDataset.typed && optionDataset.typed) {\n                  outputDataset = optionDataset;\n                }\n              }\n            }\n            if (outputDataset && !outputDataset.issues) {\n              break;\n            }\n          }\n        };\n        await parseOptions(this, /* @__PURE__ */ new Set([this.key]));\n        if (outputDataset) {\n          return outputDataset;\n        }\n        _addIssue(this, \"type\", dataset, config2, {\n          // @ts-expect-error\n          input: input[invalidDiscriminatorKey],\n          expected: _joinExpects(expectedDiscriminators, \"|\"),\n          path: [\n            {\n              type: \"object\",\n              origin: \"value\",\n              input,\n              key: invalidDiscriminatorKey,\n              // @ts-expect-error\n              value: input[invalidDiscriminatorKey]\n            }\n          ]\n        });\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/schemas/void/void.ts\n// @__NO_SIDE_EFFECTS__\nfunction void_(message2) {\n  return {\n    kind: \"schema\",\n    type: \"void\",\n    reference: void_,\n    expects: \"void\",\n    async: false,\n    message: message2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      if (dataset.value === void 0) {\n        dataset.typed = true;\n      } else {\n        _addIssue(this, \"type\", dataset, config2);\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/keyof/keyof.ts\n// @__NO_SIDE_EFFECTS__\nfunction keyof(schema, message2) {\n  return picklist(Object.keys(schema.entries), message2);\n}\n\n// src/methods/message/message.ts\n// @__NO_SIDE_EFFECTS__\nfunction message(schema, message_) {\n  return {\n    ...schema,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      return schema[\"~run\"](dataset, { ...config2, message: message_ });\n    }\n  };\n}\n\n// src/methods/omit/omit.ts\n// @__NO_SIDE_EFFECTS__\nfunction omit(schema, keys) {\n  const entries2 = {\n    ...schema.entries\n  };\n  for (const key of keys) {\n    delete entries2[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/parse/parse.ts\nfunction parse(schema, input, config2) {\n  const dataset = schema[\"~run\"]({ value: input }, getGlobalConfig(config2));\n  if (dataset.issues) {\n    throw new ValiError(dataset.issues);\n  }\n  return dataset.value;\n}\n\n// src/methods/parse/parseAsync.ts\nasync function parseAsync(schema, input, config2) {\n  const dataset = await schema[\"~run\"](\n    { value: input },\n    getGlobalConfig(config2)\n  );\n  if (dataset.issues) {\n    throw new ValiError(dataset.issues);\n  }\n  return dataset.value;\n}\n\n// src/methods/parser/parser.ts\n// @__NO_SIDE_EFFECTS__\nfunction parser(schema, config2) {\n  const func = (input) => parse(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/parser/parserAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction parserAsync(schema, config2) {\n  const func = (input) => parseAsync(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/partial/partial.ts\n// @__NO_SIDE_EFFECTS__\nfunction partial(schema, keys) {\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? optional(schema.entries[key]) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/partial/partialAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction partialAsync(schema, keys) {\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? optionalAsync(schema.entries[key]) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/pick/pick.ts\n// @__NO_SIDE_EFFECTS__\nfunction pick(schema, keys) {\n  const entries2 = {};\n  for (const key of keys) {\n    entries2[key] = schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/pipe/pipe.ts\n// @__NO_SIDE_EFFECTS__\nfunction pipe(...pipe2) {\n  return {\n    ...pipe2[0],\n    pipe: pipe2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    \"~run\"(dataset, config2) {\n      for (const item of pipe2) {\n        if (item.kind !== \"metadata\") {\n          if (dataset.issues && (item.kind === \"schema\" || item.kind === \"transformation\")) {\n            dataset.typed = false;\n            break;\n          }\n          if (!dataset.issues || !config2.abortEarly && !config2.abortPipeEarly) {\n            dataset = item[\"~run\"](dataset, config2);\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/pipe/pipeAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction pipeAsync(...pipe2) {\n  return {\n    ...pipe2[0],\n    pipe: pipe2,\n    async: true,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    },\n    async \"~run\"(dataset, config2) {\n      for (const item of pipe2) {\n        if (item.kind !== \"metadata\") {\n          if (dataset.issues && (item.kind === \"schema\" || item.kind === \"transformation\")) {\n            dataset.typed = false;\n            break;\n          }\n          if (!dataset.issues || !config2.abortEarly && !config2.abortPipeEarly) {\n            dataset = await item[\"~run\"](dataset, config2);\n          }\n        }\n      }\n      return dataset;\n    }\n  };\n}\n\n// src/methods/required/required.ts\n// @__NO_SIDE_EFFECTS__\nfunction required(schema, arg2, arg3) {\n  const keys = Array.isArray(arg2) ? arg2 : void 0;\n  const message2 = Array.isArray(arg2) ? arg3 : arg2;\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? nonOptional(schema.entries[key], message2) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/required/requiredAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction requiredAsync(schema, arg2, arg3) {\n  const keys = Array.isArray(arg2) ? arg2 : void 0;\n  const message2 = Array.isArray(arg2) ? arg3 : arg2;\n  const entries2 = {};\n  for (const key in schema.entries) {\n    entries2[key] = !keys || keys.includes(key) ? nonOptionalAsync(schema.entries[key], message2) : schema.entries[key];\n  }\n  return {\n    ...schema,\n    entries: entries2,\n    get \"~standard\"() {\n      return _getStandardProps(this);\n    }\n  };\n}\n\n// src/methods/safeParse/safeParse.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParse(schema, input, config2) {\n  const dataset = schema[\"~run\"]({ value: input }, getGlobalConfig(config2));\n  return {\n    typed: dataset.typed,\n    success: !dataset.issues,\n    output: dataset.value,\n    issues: dataset.issues\n  };\n}\n\n// src/methods/safeParse/safeParseAsync.ts\n// @__NO_SIDE_EFFECTS__\nasync function safeParseAsync(schema, input, config2) {\n  const dataset = await schema[\"~run\"](\n    { value: input },\n    getGlobalConfig(config2)\n  );\n  return {\n    typed: dataset.typed,\n    success: !dataset.issues,\n    output: dataset.value,\n    issues: dataset.issues\n  };\n}\n\n// src/methods/safeParser/safeParser.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParser(schema, config2) {\n  const func = (input) => safeParse(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/safeParser/safeParserAsync.ts\n// @__NO_SIDE_EFFECTS__\nfunction safeParserAsync(schema, config2) {\n  const func = (input) => safeParseAsync(schema, input, config2);\n  func.schema = schema;\n  func.config = config2;\n  return func;\n}\n\n// src/methods/summarize/summarize.ts\n// @__NO_SIDE_EFFECTS__\nfunction summarize(issues) {\n  let summary = \"\";\n  for (const issue of issues) {\n    if (summary) {\n      summary += \"\\n\";\n    }\n    summary += `\\xD7 ${issue.message}`;\n    const dotPath = getDotPath(issue);\n    if (dotPath) {\n      summary += `\n  \\u2192 at ${dotPath}`;\n    }\n  }\n  return summary;\n}\n\n// src/methods/unwrap/unwrap.ts\n// @__NO_SIDE_EFFECTS__\nfunction unwrap(schema) {\n  return schema.wrapped;\n}\nexport {\n  BASE64_REGEX,\n  BIC_REGEX,\n  CUID2_REGEX,\n  DECIMAL_REGEX,\n  DIGITS_REGEX,\n  EMAIL_REGEX,\n  EMOJI_REGEX,\n  HEXADECIMAL_REGEX,\n  HEX_COLOR_REGEX,\n  IMEI_REGEX,\n  IPV4_REGEX,\n  IPV6_REGEX,\n  IP_REGEX,\n  ISO_DATE_REGEX,\n  ISO_DATE_TIME_REGEX,\n  ISO_TIMESTAMP_REGEX,\n  ISO_TIME_REGEX,\n  ISO_TIME_SECOND_REGEX,\n  ISO_WEEK_REGEX,\n  MAC48_REGEX,\n  MAC64_REGEX,\n  MAC_REGEX,\n  NANO_ID_REGEX,\n  OCTAL_REGEX,\n  RFC_EMAIL_REGEX,\n  SLUG_REGEX,\n  ULID_REGEX,\n  UUID_REGEX,\n  ValiError,\n  _addIssue,\n  _getByteCount,\n  _getGraphemeCount,\n  _getLastMetadata,\n  _getStandardProps,\n  _getWordCount,\n  _isLuhnAlgo,\n  _isValidObjectKey,\n  _joinExpects,\n  _stringify,\n  any,\n  args,\n  argsAsync,\n  array,\n  arrayAsync,\n  assert,\n  awaitAsync,\n  base64,\n  bic,\n  bigint,\n  blob,\n  boolean,\n  brand,\n  bytes,\n  check,\n  checkAsync,\n  checkItems,\n  checkItemsAsync,\n  config,\n  creditCard,\n  cuid2,\n  custom,\n  customAsync,\n  date,\n  decimal,\n  deleteGlobalConfig,\n  deleteGlobalMessage,\n  deleteSchemaMessage,\n  deleteSpecificMessage,\n  description,\n  digits,\n  email,\n  emoji,\n  empty,\n  endsWith,\n  entries,\n  entriesFromList,\n  entriesFromObjects,\n  enum_ as enum,\n  enum_,\n  everyItem,\n  exactOptional,\n  exactOptionalAsync,\n  excludes,\n  fallback,\n  fallbackAsync,\n  file,\n  filterItems,\n  findItem,\n  finite,\n  flatten,\n  flavor,\n  forward,\n  forwardAsync,\n  function_ as function,\n  function_,\n  getDefault,\n  getDefaults,\n  getDefaultsAsync,\n  getDescription,\n  getDotPath,\n  getFallback,\n  getFallbacks,\n  getFallbacksAsync,\n  getGlobalConfig,\n  getGlobalMessage,\n  getMetadata,\n  getSchemaMessage,\n  getSpecificMessage,\n  getTitle,\n  graphemes,\n  gtValue,\n  hash,\n  hexColor,\n  hexadecimal,\n  imei,\n  includes,\n  instance,\n  integer,\n  intersect,\n  intersectAsync,\n  ip,\n  ipv4,\n  ipv6,\n  is,\n  isOfKind,\n  isOfType,\n  isValiError,\n  isoDate,\n  isoDateTime,\n  isoTime,\n  isoTimeSecond,\n  isoTimestamp,\n  isoWeek,\n  keyof,\n  lazy,\n  lazyAsync,\n  length,\n  literal,\n  looseObject,\n  looseObjectAsync,\n  looseTuple,\n  looseTupleAsync,\n  ltValue,\n  mac,\n  mac48,\n  mac64,\n  map,\n  mapAsync,\n  mapItems,\n  maxBytes,\n  maxEntries,\n  maxGraphemes,\n  maxLength,\n  maxSize,\n  maxValue,\n  maxWords,\n  message,\n  metadata,\n  mimeType,\n  minBytes,\n  minEntries,\n  minGraphemes,\n  minLength,\n  minSize,\n  minValue,\n  minWords,\n  multipleOf,\n  nan,\n  nanoid,\n  never,\n  nonEmpty,\n  nonNullable,\n  nonNullableAsync,\n  nonNullish,\n  nonNullishAsync,\n  nonOptional,\n  nonOptionalAsync,\n  normalize,\n  notBytes,\n  notEntries,\n  notGraphemes,\n  notLength,\n  notSize,\n  notValue,\n  notValues,\n  notWords,\n  null_ as null,\n  null_,\n  nullable,\n  nullableAsync,\n  nullish,\n  nullishAsync,\n  number,\n  object,\n  objectAsync,\n  objectWithRest,\n  objectWithRestAsync,\n  octal,\n  omit,\n  optional,\n  optionalAsync,\n  parse,\n  parseAsync,\n  parseJson,\n  parser,\n  parserAsync,\n  partial,\n  partialAsync,\n  partialCheck,\n  partialCheckAsync,\n  pick,\n  picklist,\n  pipe,\n  pipeAsync,\n  promise,\n  rawCheck,\n  rawCheckAsync,\n  rawTransform,\n  rawTransformAsync,\n  readonly,\n  record,\n  recordAsync,\n  reduceItems,\n  regex,\n  required,\n  requiredAsync,\n  returns,\n  returnsAsync,\n  rfcEmail,\n  safeInteger,\n  safeParse,\n  safeParseAsync,\n  safeParser,\n  safeParserAsync,\n  set,\n  setAsync,\n  setGlobalConfig,\n  setGlobalMessage,\n  setSchemaMessage,\n  setSpecificMessage,\n  size,\n  slug,\n  someItem,\n  sortItems,\n  startsWith,\n  strictObject,\n  strictObjectAsync,\n  strictTuple,\n  strictTupleAsync,\n  string,\n  stringifyJson,\n  summarize,\n  symbol,\n  title,\n  toLowerCase,\n  toMaxValue,\n  toMinValue,\n  toUpperCase,\n  transform,\n  transformAsync,\n  trim,\n  trimEnd,\n  trimStart,\n  tuple,\n  tupleAsync,\n  tupleWithRest,\n  tupleWithRestAsync,\n  ulid,\n  undefined_ as undefined,\n  undefined_,\n  undefinedable,\n  undefinedableAsync,\n  union,\n  unionAsync,\n  unknown,\n  unwrap,\n  url,\n  uuid,\n  value,\n  values,\n  variant,\n  variantAsync,\n  void_ as void,\n  void_,\n  words\n};\n","/**\r\n * Error codes for Foundry API operations.\r\n * Provides type-safe classification of Foundry-related errors.\r\n */\r\nexport type FoundryErrorCode =\r\n  | \"API_NOT_AVAILABLE\" // Foundry API (game, Hooks, etc.) not available\r\n  | \"VALIDATION_FAILED\" // Runtime validation failed\r\n  | \"NOT_FOUND\" // Entity not found by ID\r\n  | \"ACCESS_DENIED\" // Permission denied\r\n  | \"PORT_SELECTION_FAILED\" // Port selection/instantiation failed\r\n  | \"PORT_REGISTRY_ERROR\" // Port registry duplicate registration\r\n  | \"PORT_NOT_FOUND\" // No compatible port found for version\r\n  | \"OPERATION_FAILED\"; // General operation failure\r\n\r\n/**\r\n * Structured error for Foundry operations.\r\n * Provides detailed context for debugging and error handling.\r\n *\r\n * @example\r\n * ```typescript\r\n * const error: FoundryError = {\r\n *   code: \"API_NOT_AVAILABLE\",\r\n *   message: \"Foundry game API not available\",\r\n *   details: { api: \"game.journal\" }\r\n * };\r\n * ```\r\n */\r\nexport interface FoundryError {\r\n  /** Error code classifying the type of error */\r\n  code: FoundryErrorCode;\r\n\r\n  /** Human-readable error message */\r\n  message: string;\r\n\r\n  /** Optional additional context (IDs, names, etc.) */\r\n  details?: unknown;\r\n\r\n  /** Optional underlying error or exception that caused this error */\r\n  cause?: unknown;\r\n}\r\n\r\n/**\r\n * Factory for creating FoundryError instances.\r\n *\r\n * @param code - Error code\r\n * @param message - Error message\r\n * @param details - Optional additional context\r\n * @param cause - Optional underlying error\r\n * @returns FoundryError instance\r\n *\r\n * @example\r\n * ```typescript\r\n * const error = createFoundryError(\r\n *   \"NOT_FOUND\",\r\n *   \"Journal entry not found\",\r\n *   { journalId: \"abc123\" }\r\n * );\r\n * ```\r\n */\r\nexport function createFoundryError(\r\n  code: FoundryErrorCode,\r\n  message: string,\r\n  details?: unknown,\r\n  cause?: unknown\r\n): FoundryError {\r\n  return { code, message, details, cause };\r\n}\r\n\r\n/**\r\n * Type guard helper for error-like objects.\r\n */\r\ninterface ErrorLike {\r\n  code?: unknown;\r\n  message?: unknown;\r\n}\r\n\r\n/**\r\n * Checks if an object has error-like properties.\r\n */\r\nfunction isErrorLike(obj: unknown): obj is ErrorLike {\r\n  return typeof obj === \"object\" && obj !== null;\r\n}\r\n\r\n/**\r\n * Type guard to check if an error is a FoundryError.\r\n *\r\n * @param error - Error to check\r\n * @returns True if error is a FoundryError\r\n *\r\n * @example\r\n * ```typescript\r\n * if (isFoundryError(error)) {\r\n *   console.log(error.code); // Type-safe access\r\n * }\r\n * ```\r\n */\r\nexport function isFoundryError(error: unknown): error is FoundryError {\r\n  if (!isErrorLike(error)) return false;\r\n\r\n  return (\r\n    \"code\" in error &&\r\n    \"message\" in error &&\r\n    typeof error.code === \"string\" &&\r\n    typeof error.message === \"string\"\r\n  );\r\n}\r\n","import * as v from \"valibot\";\r\nimport type { Result } from \"@/types/result\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\n/**\r\n * Valibot schema for JournalEntry validation.\r\n * Validates that objects from Foundry API conform to expected structure.\r\n */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention -- Schemas use PascalCase\r\nexport const JournalEntrySchema = v.object({\r\n  id: v.string(),\r\n  name: v.optional(v.string()),\r\n  flags: v.optional(v.record(v.string(), v.unknown())),\r\n  getFlag: v.optional(\r\n    v.custom<(scope: string, key: string) => unknown>((val) => typeof val === \"function\")\r\n  ),\r\n  setFlag: v.optional(\r\n    v.custom<(scope: string, key: string, value: unknown) => Promise<unknown>>(\r\n      (val) => typeof val === \"function\"\r\n    )\r\n  ),\r\n});\r\n\r\n/**\r\n * Type for validated journal entries.\r\n */\r\nexport type ValidatedJournalEntry = v.InferOutput<typeof JournalEntrySchema>;\r\n\r\n/**\r\n * Validates an array of journal entries against the schema.\r\n *\r\n * @param entries - Array of unknown objects to validate\r\n * @returns Result with validated entries or FoundryError\r\n *\r\n * @example\r\n * ```typescript\r\n * const entries = Array.from(game.journal.contents);\r\n * const result = validateJournalEntries(entries);\r\n * if (result.ok) {\r\n *   // entries are validated\r\n * }\r\n * ```\r\n */\r\nexport function validateJournalEntries(\r\n  entries: unknown[]\r\n): Result<ValidatedJournalEntry[], FoundryError> {\r\n  const result = v.safeParse(v.array(JournalEntrySchema), entries);\r\n\r\n  if (!result.success) {\r\n    return err(\r\n      createFoundryError(\r\n        \"VALIDATION_FAILED\",\r\n        \"Journal entry validation failed\",\r\n        undefined,\r\n        result.issues\r\n      )\r\n    );\r\n  }\r\n\r\n  return ok(result.output);\r\n}\r\n\r\n/**\r\n * Sanitizes a string for use in HTML/CSS selectors.\r\n * Removes all characters except alphanumeric, hyphens, and underscores.\r\n * Prevents CSS injection attacks.\r\n *\r\n * @param id - The ID to sanitize\r\n * @returns Sanitized ID safe for use in selectors\r\n *\r\n * @example\r\n * ```typescript\r\n * sanitizeId(\"journal-123\");  // \"journal-123\"\r\n * sanitizeId(\"../../../etc/passwd\");  // \"etcpasswd\"\r\n * sanitizeId(\"<script>alert('xss')</script>\");  // \"scriptalertxssscript\"\r\n * ```\r\n */\r\nexport function sanitizeId(id: string): string {\r\n  return id.replace(/[^a-zA-Z0-9-_]/g, \"\");\r\n}\r\n\r\n/**\r\n * Sanitizes a string for display in HTML.\r\n * Escapes HTML entities to prevent XSS attacks.\r\n *\r\n * @param text - The text to sanitize\r\n * @returns HTML-safe text\r\n *\r\n * @example\r\n * ```typescript\r\n * sanitizeHtml(\"<script>alert('xss')</script>\");\r\n * // \"&lt;script&gt;alert('xss')&lt;/script&gt;\"\r\n *\r\n * sanitizeHtml(\"Normal text\");\r\n * // \"Normal text\"\r\n * ```\r\n */\r\nexport function sanitizeHtml(text: string): string {\r\n  const div = document.createElement(\"div\");\r\n  div.textContent = text;\r\n  return div.innerHTML;\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryGame } from \"@/foundry/interfaces/FoundryGame\";\r\nimport type { FoundryDocument } from \"@/foundry/interfaces/FoundryDocument\";\r\nimport type { FoundryUI } from \"@/foundry/interfaces/FoundryUI\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Logger } from \"@/interfaces/logger\";\r\nimport type { FoundryJournalEntry } from \"@/foundry/types\";\r\nimport { MODULE_CONSTANTS } from \"@/constants\";\r\nimport { match } from \"@/utils/result\";\r\nimport { foundryGameToken, foundryDocumentToken, foundryUIToken } from \"@/foundry/foundrytokens\";\r\nimport { loggerToken } from \"@/tokens/tokenindex\";\r\nimport { sanitizeHtml } from \"@/foundry/validation/schemas\";\r\n\r\n/**\r\n * Service for managing journal entry visibility based on module flags.\r\n * Handles business logic for hiding/showing journal entries in the UI.\r\n */\r\nexport class JournalVisibilityService {\r\n  static dependencies = [\r\n    foundryGameToken,\r\n    foundryDocumentToken,\r\n    foundryUIToken,\r\n    loggerToken,\r\n  ] as const;\r\n\r\n  constructor(\r\n    private readonly game: FoundryGame,\r\n    private readonly document: FoundryDocument,\r\n    private readonly ui: FoundryUI,\r\n    private readonly logger: Logger\r\n  ) {}\r\n\r\n  /**\r\n   * Sanitizes a string for safe use in log messages.\r\n   * Escapes HTML entities to prevent log injection or display issues.\r\n   *\r\n   * Delegates to sanitizeHtml for robust DOM-based sanitization.\r\n   *\r\n   * @param input - The string to sanitize\r\n   * @returns HTML-safe string\r\n   */\r\n  private sanitizeForLog(input: string): string {\r\n    return sanitizeHtml(input);\r\n  }\r\n\r\n  /**\r\n   * Gets journal entries marked as hidden via module flag.\r\n   * Logs warnings for entries where flag reading fails to aid diagnosis.\r\n   */\r\n  getHiddenJournalEntries(): Result<FoundryJournalEntry[], FoundryError> {\r\n    const allEntriesResult = this.game.getJournalEntries();\r\n    if (!allEntriesResult.ok) return allEntriesResult;\r\n\r\n    const hidden: FoundryJournalEntry[] = [];\r\n\r\n    for (const journal of allEntriesResult.value) {\r\n      const flagResult = this.document.getFlag<boolean>(\r\n        journal as { getFlag: (scope: string, key: string) => unknown },\r\n        MODULE_CONSTANTS.MODULE.ID,\r\n        MODULE_CONSTANTS.FLAGS.HIDDEN\r\n      );\r\n\r\n      if (flagResult.ok) {\r\n        if (flagResult.value === true) {\r\n          hidden.push(journal);\r\n        }\r\n        /* c8 ignore next 6 -- Branch: Non-hidden journals (else branch) are the common case, tested implicitly */\r\n      } else {\r\n        // Log flag read errors for diagnosis without interrupting processing\r\n        const journalIdentifier = journal.name ?? journal.id;\r\n        this.logger.warn(\r\n          `Failed to read hidden flag for journal \"${this.sanitizeForLog(journalIdentifier)}\"`,\r\n          {\r\n            errorCode: flagResult.error.code,\r\n            errorMessage: flagResult.error.message,\r\n          }\r\n        );\r\n\r\n        // Show UI notification for critical errors (e.g., permission issues)\r\n        if (flagResult.error.code === \"ACCESS_DENIED\") {\r\n          const notifyResult = this.ui.notify(\r\n            \"Some journal entries could not be accessed due to permissions\",\r\n            \"warning\"\r\n          );\r\n          /* c8 ignore next 3 -- UI notification error path tested in FoundryUIService.test.ts */\r\n          if (!notifyResult.ok) {\r\n            this.logger.warn(\"Failed to show UI notification\", notifyResult.error);\r\n          }\r\n        }\r\n\r\n        // Continue processing other entries\r\n      }\r\n    }\r\n\r\n    return { ok: true, value: hidden };\r\n  }\r\n\r\n  /**\r\n   * Processes journal directory HTML to hide flagged entries.\r\n   */\r\n  processJournalDirectory(htmlElement: HTMLElement): void {\r\n    this.logger.debug(\"Processing journal directory for hidden entries\");\r\n\r\n    const hiddenResult = this.getHiddenJournalEntries();\r\n    match(hiddenResult, {\r\n      onOk: (hidden) => {\r\n        this.logger.debug(`Found ${hidden.length} hidden journal entries`);\r\n        this.hideEntries(hidden, htmlElement);\r\n      },\r\n      onErr: (error) => {\r\n        this.logger.error(\"Error getting hidden journal entries\", error);\r\n      },\r\n    });\r\n  }\r\n\r\n  private hideEntries(entries: FoundryJournalEntry[], html: HTMLElement): void {\r\n    for (const journal of entries) {\r\n      const journalName = journal.name ?? MODULE_CONSTANTS.DEFAULTS.UNKNOWN_NAME;\r\n      const removeResult = this.ui.removeJournalElement(journal.id, journalName, html);\r\n      match(removeResult, {\r\n        onOk: () => {\r\n          this.logger.debug(`Removing journal entry: ${this.sanitizeForLog(journalName)}`);\r\n        },\r\n        onErr: (error) => {\r\n          this.logger.warn(\"Error removing journal entry\", error);\r\n        },\r\n      });\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Version detection for Foundry VTT.\r\n * Extracts the major version number from Foundry's version string.\r\n */\r\n\r\nimport type { Result } from \"@/types/result\";\r\nimport { ok, err } from \"@/utils/result\";\r\n\r\n/**\r\n * Cached version result to avoid repeated game.version access.\r\n * Improves performance when version is checked multiple times (e.g., during port selection).\r\n */\r\nlet cachedVersion: Result<number, string> | null = null;\r\n\r\n/**\r\n * Internal function to detect Foundry version without caching.\r\n * Called only once on first version check.\r\n */\r\nfunction detectFoundryVersion(): Result<number, string> {\r\n  if (typeof game === \"undefined\") {\r\n    return err(\"Foundry game object is not available or version cannot be determined\");\r\n  }\r\n\r\n  // game.version is typed as string by fvtt-types\r\n  // Format is \"{major}.{minor}\" (e.g., \"13.348\")\r\n  const versionString = game.version;\r\n  if (!versionString) {\r\n    return err(\"Foundry version is not available on the game object\");\r\n  }\r\n\r\n  const match = versionString.match(/^(\\d+)/);\r\n  if (!match) {\r\n    return err(`Could not parse Foundry version from: ${versionString}`);\r\n  }\r\n\r\n  return ok(Number.parseInt(match[1]!, 10));\r\n}\r\n\r\n/**\r\n * Gets the major version number of the currently running Foundry VTT instance.\r\n * Returns a Result for proper error handling.\r\n *\r\n * Performance: Version is cached after first detection to avoid repeated game.version access.\r\n *\r\n * @returns Result with major version number (e.g., 13 for \"13.348\") or error message\r\n *\r\n * @example\r\n * ```typescript\r\n * const versionResult = getFoundryVersionResult();\r\n * if (versionResult.ok) {\r\n *   console.log(`Foundry version: ${versionResult.value}`);\r\n * } else {\r\n *   console.error(`Version detection failed: ${versionResult.error}`);\r\n * }\r\n * ```\r\n */\r\nexport function getFoundryVersionResult(): Result<number, string> {\r\n  if (cachedVersion === null) {\r\n    cachedVersion = detectFoundryVersion();\r\n  }\r\n  return cachedVersion;\r\n}\r\n\r\n/**\r\n * Resets the version cache.\r\n *\r\n * @internal For testing purposes only.\r\n *\r\n * Should be called in test cleanup (afterEach) to ensure test isolation.\r\n * DO NOT use in production code - version detection is intentionally cached\r\n * for performance reasons.\r\n */\r\nexport function resetVersionCache(): void {\r\n  cachedVersion = null;\r\n}\r\n\r\n/**\r\n * Gets the major version number of the currently running Foundry VTT instance.\r\n *\r\n * @deprecated Use getFoundryVersionResult() for proper error handling with Result pattern\r\n * @returns The major version number (e.g., 13 for \"13.348\")\r\n * @throws Error if game is not available or version cannot be determined\r\n */\r\nexport function getFoundryVersion(): number {\r\n  const result = getFoundryVersionResult();\r\n  if (!result.ok) {\r\n    throw new Error(result.error);\r\n  }\r\n  return result.value;\r\n}\r\n\r\n/**\r\n * Safely gets the Foundry version, returning undefined if it cannot be determined.\r\n * @returns The major version number or undefined if not available\r\n */\r\nexport function tryGetFoundryVersion(): number | undefined {\r\n  const result = getFoundryVersionResult();\r\n  return result.ok ? result.value : undefined;\r\n}\r\n","/**\r\n * Performance measurement constants for the application.\r\n *\r\n * Organized hierarchically by component for better structure and discoverability.\r\n * Used to standardize performance mark names across the codebase.\r\n *\r\n * @example\r\n * ```typescript\r\n * performance.mark(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START);\r\n * // ... operation\r\n * performance.mark(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END);\r\n * performance.measure(\r\n *   PERFORMANCE_MARKS.MODULE.BOOTSTRAP.DURATION,\r\n *   PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START,\r\n *   PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END\r\n * );\r\n * ```\r\n */\r\n/* c8 ignore file -- Reine Konstanten-Definition, keine ausf√ºhrbare Logik */\r\nexport const PERFORMANCE_MARKS = {\r\n  MODULE: {\r\n    BOOTSTRAP: {\r\n      START: \"module:bootstrap:start\",\r\n      END: \"module:bootstrap:end\",\r\n      DURATION: \"module:bootstrap:duration\",\r\n    },\r\n    PORT_SELECTION: {\r\n      START: \"module:port-selection:start\",\r\n      END: \"module:port-selection:end\",\r\n      DURATION: \"module:port-selection:duration\",\r\n    },\r\n  },\r\n} as const;\r\n\r\n/**\r\n * Legacy flat constants for backwards compatibility.\r\n * @deprecated Use PERFORMANCE_MARKS.MODULE.* instead\r\n */\r\nexport const LEGACY_PERFORMANCE_MARKS = {\r\n  BOOTSTRAP_START: PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START,\r\n  BOOTSTRAP_END: PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END,\r\n  BOOTSTRAP_DURATION: PERFORMANCE_MARKS.MODULE.BOOTSTRAP.DURATION,\r\n  PORT_SELECTION_START: PERFORMANCE_MARKS.MODULE.PORT_SELECTION.START,\r\n  PORT_SELECTION_END: PERFORMANCE_MARKS.MODULE.PORT_SELECTION.END,\r\n  PORT_SELECTION_DURATION: PERFORMANCE_MARKS.MODULE.PORT_SELECTION.DURATION,\r\n} as const;\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { err, ok } from \"@/utils/result\";\r\nimport { getFoundryVersionResult } from \"./versiondetector\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { ENV } from \"@/config/environment\";\r\nimport { PERFORMANCE_MARKS } from \"@/core/performance-constants\";\r\nimport { MODULE_CONSTANTS } from \"@/constants\";\r\nimport { MetricsCollector } from \"@/observability/metrics-collector\";\r\n\r\n/**\r\n * Factory function type for creating port instances.\r\n * Enables lazy instantiation to prevent crashes from incompatible constructors.\r\n */\r\nexport type PortFactory<T> = () => T;\r\n\r\n/**\r\n * Selects the appropriate port implementation based on Foundry version.\r\n * Implements the logic:\r\n * - Foundry v13 ‚Üí uses v13 ports\r\n * - Foundry v14 ‚Üí uses v14 ports (if available), otherwise falls back to v13\r\n * - Never uses ports with version number higher than current Foundry version\r\n */\r\nexport class PortSelector {\r\n  /**\r\n   * Selects and instantiates the appropriate port from factories.\r\n   *\r\n   * CRITICAL: Works with factory map to avoid eager instantiation.\r\n   * Only the selected factory is executed, preventing crashes from\r\n   * incompatible constructors accessing unavailable APIs.\r\n   *\r\n   * @template T - The port type\r\n   * @param factories - Map of version numbers to port factories\r\n   * @param foundryVersion - Optional version override (uses getFoundryVersion() if not provided)\r\n   * @returns Result with instantiated port or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const factories = new Map([\r\n   *   [13, () => new FoundryGamePortV13()],\r\n   *   [14, () => new FoundryGamePortV14()]\r\n   * ]);\r\n   * const selector = new PortSelector();\r\n   * const result = selector.selectPortFromFactories(factories);\r\n   * // On Foundry v13: creates only v13 port (v14 factory never called)\r\n   * // On Foundry v14: creates v14 port\r\n   * ```\r\n   */\r\n  selectPortFromFactories<T>(\r\n    factories: Map<number, PortFactory<T>>,\r\n    foundryVersion?: number\r\n  ): Result<T, FoundryError> {\r\n    // Performance tracking (only in debug/performance mode)\r\n    if (ENV.enableDebugMode || ENV.enablePerformanceTracking) {\r\n      performance.mark(PERFORMANCE_MARKS.MODULE.PORT_SELECTION.START);\r\n    }\r\n\r\n    // Use central version detection\r\n    let version: number;\r\n    if (foundryVersion !== undefined) {\r\n      version = foundryVersion;\r\n    } else {\r\n      const versionResult = getFoundryVersionResult();\r\n      if (!versionResult.ok) {\r\n        return err(\r\n          createFoundryError(\r\n            \"PORT_SELECTION_FAILED\",\r\n            \"Could not determine Foundry version\",\r\n            undefined,\r\n            versionResult.error\r\n          )\r\n        );\r\n      }\r\n      version = versionResult.value;\r\n    }\r\n\r\n    // Find highest compatible factory (<= Foundry version)\r\n    let selectedFactory: PortFactory<T> | undefined;\r\n    let selectedVersion: number = MODULE_CONSTANTS.DEFAULTS.NO_VERSION_SELECTED;\r\n\r\n    for (const [portVersion, factory] of factories.entries()) {\r\n      if (portVersion > version) {\r\n        continue; // Ignore incompatible versions\r\n      }\r\n      if (portVersion > selectedVersion) {\r\n        selectedVersion = portVersion;\r\n        selectedFactory = factory;\r\n      }\r\n    }\r\n\r\n    if (selectedFactory === undefined) {\r\n      const availableVersions = Array.from(factories.keys())\r\n        .sort((a, b) => a - b)\r\n        .join(\", \");\r\n\r\n      // Track port selection failure\r\n      /* c8 ignore next 3 -- Performance tracking is optional feature flag tested in integration tests */\r\n      if (ENV.enablePerformanceTracking) {\r\n        MetricsCollector.getInstance().recordPortSelectionFailure(version);\r\n      }\r\n\r\n      return err(\r\n        createFoundryError(\r\n          \"PORT_SELECTION_FAILED\",\r\n          `No compatible port found for Foundry version ${version}`,\r\n          { version, availableVersions: availableVersions || \"none\" }\r\n        )\r\n      );\r\n    }\r\n\r\n    // CRITICAL: Only now instantiate the selected port\r\n    let result: Result<T, FoundryError>;\r\n    try {\r\n      result = ok(selectedFactory());\r\n    } catch (error) {\r\n      // Track instantiation failure\r\n      if (ENV.enablePerformanceTracking) {\r\n        MetricsCollector.getInstance().recordPortSelectionFailure(version);\r\n      }\r\n\r\n      result = err(\r\n        createFoundryError(\r\n          \"PORT_SELECTION_FAILED\",\r\n          `Failed to instantiate port v${selectedVersion}`,\r\n          { selectedVersion },\r\n          error\r\n        )\r\n      );\r\n    }\r\n\r\n    // Performance tracking end\r\n    if (ENV.enableDebugMode || ENV.enablePerformanceTracking) {\r\n      performance.mark(PERFORMANCE_MARKS.MODULE.PORT_SELECTION.END);\r\n      performance.measure(\r\n        PERFORMANCE_MARKS.MODULE.PORT_SELECTION.DURATION,\r\n        PERFORMANCE_MARKS.MODULE.PORT_SELECTION.START,\r\n        PERFORMANCE_MARKS.MODULE.PORT_SELECTION.END\r\n      );\r\n\r\n      // Get the latest measurement entry (not the first one which could be stale)\r\n      const entries = performance.getEntriesByName(\r\n        PERFORMANCE_MARKS.MODULE.PORT_SELECTION.DURATION\r\n      );\r\n      const measure = entries.at(-1);\r\n\r\n      if (measure && ENV.enableDebugMode) {\r\n        console.debug(\r\n          `${MODULE_CONSTANTS.LOG_PREFIX} Port selection completed in ${measure.duration.toFixed(2)}ms (selected: v${selectedVersion})`\r\n        );\r\n      }\r\n\r\n      // Clean up performance marks/measures to prevent memory leaks\r\n      performance.clearMarks(PERFORMANCE_MARKS.MODULE.PORT_SELECTION.START);\r\n      performance.clearMarks(PERFORMANCE_MARKS.MODULE.PORT_SELECTION.END);\r\n      performance.clearMeasures(PERFORMANCE_MARKS.MODULE.PORT_SELECTION.DURATION);\r\n\r\n      // Record port selection metrics\r\n      if (result.ok) {\r\n        MetricsCollector.getInstance().recordPortSelection(selectedVersion);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n","/**\r\n * Registry for managing available port implementations across different Foundry versions.\r\n * Centralizes port registration and discovery.\r\n */\r\n\r\nimport type { Result } from \"@/types/result\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { createFoundryError, type FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\nexport type PortFactory<T> = () => T;\r\n\r\n/**\r\n * Registry that holds exactly one port factory per version.\r\n * @template T - The port interface type\r\n */\r\nexport class PortRegistry<T> {\r\n  // Exactly one factory per version\r\n  private readonly factories = new Map<number, PortFactory<T>>();\r\n\r\n  /**\r\n   * Registers a port factory for a specific Foundry version.\r\n   * @param version - The Foundry version this port supports\r\n   * @param factory - Factory function that creates the port instance\r\n   * @returns Result indicating success or duplicate registration error\r\n   */\r\n  register(version: number, factory: PortFactory<T>): Result<void, FoundryError> {\r\n    if (this.factories.has(version)) {\r\n      return err(\r\n        createFoundryError(\r\n          \"PORT_REGISTRY_ERROR\",\r\n          `Port for version ${version} already registered`,\r\n          { version }\r\n        )\r\n      );\r\n    }\r\n    this.factories.set(version, factory);\r\n    return ok(undefined);\r\n  }\r\n\r\n  /**\r\n   * Gets all registered port versions.\r\n   * @returns Array of registered version numbers, sorted ascending\r\n   */\r\n  getAvailableVersions(): number[] {\r\n    return Array.from(this.factories.keys()).sort((a, b) => a - b);\r\n  }\r\n\r\n  /**\r\n   * Gets the factory map without instantiating ports.\r\n   * Use with PortSelector.selectPortFromFactories() for safe lazy instantiation.\r\n   *\r\n   * @returns Map of version numbers to factory functions (NOT instances)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const registry = new PortRegistry<FoundryGame>();\r\n   * registry.register(13, () => new FoundryGamePortV13());\r\n   * registry.register(14, () => new FoundryGamePortV14());\r\n   *\r\n   * const factories = registry.getFactories();\r\n   * const selector = new PortSelector();\r\n   * const result = selector.selectPortFromFactories(factories);\r\n   * // Only compatible port is instantiated\r\n   * ```\r\n   */\r\n  getFactories(): Map<number, PortFactory<T>> {\r\n    return new Map(this.factories);\r\n  }\r\n\r\n  /**\r\n   * Creates only the port for the specified version or the highest compatible version.\r\n   * More efficient than createAll() when only one port is needed.\r\n   * @param version - The target Foundry version\r\n   * @returns Result containing the port instance or error\r\n   */\r\n  createForVersion(version: number): Result<T, FoundryError> {\r\n    // Find highest compatible version (<= target version)\r\n    const compatibleVersions = Array.from(this.factories.keys())\r\n      .filter((v) => v <= version)\r\n      .sort((a, b) => b - a);\r\n\r\n    if (compatibleVersions.length === 0) {\r\n      const availableVersions = this.getAvailableVersions().join(\", \") || \"none\";\r\n      return err(\r\n        createFoundryError(\r\n          \"PORT_NOT_FOUND\",\r\n          `No compatible port for Foundry v${version}. Available ports: ${availableVersions}`,\r\n          { version, availableVersions }\r\n        )\r\n      );\r\n    }\r\n\r\n    const selectedVersion = compatibleVersions[0];\r\n    /* c8 ignore next 3 -- Defensive check: selectedVersion cannot be undefined after compatibleVersions length check */\r\n    if (selectedVersion === undefined) {\r\n      return err(createFoundryError(\"PORT_NOT_FOUND\", \"No compatible version found\", { version }));\r\n    }\r\n    const factory = this.factories.get(selectedVersion);\r\n    /* c8 ignore next 7 -- Defensive check: factory cannot be undefined after selectedVersion is validated from compatibleVersions */\r\n    if (!factory) {\r\n      return err(\r\n        createFoundryError(\"PORT_NOT_FOUND\", `Factory not found for version ${selectedVersion}`, {\r\n          selectedVersion,\r\n        })\r\n      );\r\n    }\r\n    return ok(factory());\r\n  }\r\n\r\n  /**\r\n   * Checks if a port is registered for a specific version.\r\n   * @param version - The version to check\r\n   * @returns True if a port is registered for this version\r\n   */\r\n  hasVersion(version: number): boolean {\r\n    return this.factories.has(version);\r\n  }\r\n\r\n  /**\r\n   * Gets the highest registered port version.\r\n   * @returns The highest version number or undefined if no ports are registered\r\n   */\r\n  getHighestVersion(): number | undefined {\r\n    const versions = this.getAvailableVersions();\r\n    return versions.length > 0 ? versions[versions.length - 1]! : undefined;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryGame } from \"@/foundry/interfaces/FoundryGame\";\r\nimport type { FoundryJournalEntry } from \"@/foundry/types\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Disposable } from \"@/di_infrastructure/interfaces/disposable\";\r\nimport type { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport type { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { portSelectorToken, foundryGamePortRegistryToken } from \"@/foundry/foundrytokens\";\r\n\r\n/**\r\n * Service wrapper for FoundryGame that automatically selects the appropriate port\r\n * based on the current Foundry version.\r\n *\r\n * Implements Disposable for resource cleanup consistency.\r\n */\r\nexport class FoundryGameService implements FoundryGame, Disposable {\r\n  static dependencies = [portSelectorToken, foundryGamePortRegistryToken] as const;\r\n\r\n  private port: FoundryGame | null = null;\r\n  private readonly portSelector: PortSelector;\r\n  private readonly portRegistry: PortRegistry<FoundryGame>;\r\n\r\n  constructor(portSelector: PortSelector, portRegistry: PortRegistry<FoundryGame>) {\r\n    this.portSelector = portSelector;\r\n    this.portRegistry = portRegistry;\r\n  }\r\n\r\n  /**\r\n   * Lazy-loads the appropriate port based on Foundry version.\r\n   * Uses PortSelector with factory-based selection to prevent eager instantiation.\r\n   *\r\n   * CRITICAL: This prevents crashes when newer port constructors access\r\n   * APIs not available in the current Foundry version.\r\n   *\r\n   * @returns Result containing the port or a FoundryError if no compatible port can be selected\r\n   */\r\n  private getPort(): Result<FoundryGame, FoundryError> {\r\n    if (this.port === null) {\r\n      // Get factories (not instances) to avoid eager instantiation\r\n      const factories = this.portRegistry.getFactories();\r\n\r\n      // Use PortSelector with factory-based selection\r\n      const portResult = this.portSelector.selectPortFromFactories(factories);\r\n      if (!portResult.ok) {\r\n        return portResult;\r\n      }\r\n\r\n      this.port = portResult.value;\r\n    }\r\n    return { ok: true, value: this.port };\r\n  }\r\n\r\n  getJournalEntries(): Result<FoundryJournalEntry[], FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.getJournalEntries();\r\n  }\r\n\r\n  getJournalEntryById(id: string): Result<FoundryJournalEntry | null, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.getJournalEntryById(id);\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources.\r\n   * Resets the port reference to allow garbage collection.\r\n   */\r\n  dispose(): void {\r\n    this.port = null;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryHooks } from \"@/foundry/interfaces/FoundryHooks\";\r\nimport type { FoundryHookCallback } from \"@/foundry/types\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Disposable } from \"@/di_infrastructure/interfaces/disposable\";\r\nimport { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { portSelectorToken, foundryHooksPortRegistryToken } from \"@/foundry/foundrytokens\";\r\n\r\n/**\r\n * Type-safe interface for Foundry Hooks with dynamic hook names.\r\n * Allows calling Hooks.off() with runtime-determined hook names without using 'any'.\r\n */\r\ninterface DynamicHooksApi {\r\n  off(hookName: string, callback: (...args: unknown[]) => unknown): void;\r\n  on(hookName: string, callback: (...args: unknown[]) => unknown): number;\r\n  once(hookName: string, callback: (...args: unknown[]) => unknown): number;\r\n}\r\n\r\n/**\r\n * Service wrapper for FoundryHooks that automatically selects the appropriate port\r\n * based on the current Foundry version.\r\n *\r\n * Implements Disposable to clean up registered hooks when the container is disposed.\r\n */\r\nexport class FoundryHooksService implements FoundryHooks, Disposable {\r\n  static dependencies = [portSelectorToken, foundryHooksPortRegistryToken] as const;\r\n\r\n  private port: FoundryHooks | null = null;\r\n  private readonly portSelector: PortSelector;\r\n  private readonly portRegistry: PortRegistry<FoundryHooks>;\r\n  private registeredHooks = new Map<string, Map<number, FoundryHookCallback>>();\r\n\r\n  constructor(portSelector: PortSelector, portRegistry: PortRegistry<FoundryHooks>) {\r\n    this.portSelector = portSelector;\r\n    this.portRegistry = portRegistry;\r\n  }\r\n\r\n  /**\r\n   * Lazy-loads the appropriate port based on Foundry version.\r\n   * Uses PortSelector with factory-based selection to prevent eager instantiation.\r\n   *\r\n   * CRITICAL: This prevents crashes when newer port constructors access\r\n   * APIs not available in the current Foundry version.\r\n   *\r\n   * @returns Result containing the port or a FoundryError if no compatible port can be selected\r\n   */\r\n  private getPort(): Result<FoundryHooks, FoundryError> {\r\n    if (this.port === null) {\r\n      // Get factories (not instances) to avoid eager instantiation\r\n      const factories = this.portRegistry.getFactories();\r\n\r\n      // Use PortSelector with factory-based selection\r\n      const portResult = this.portSelector.selectPortFromFactories(factories);\r\n      if (!portResult.ok) {\r\n        return portResult;\r\n      }\r\n\r\n      this.port = portResult.value;\r\n    }\r\n    return { ok: true, value: this.port };\r\n  }\r\n\r\n  on(hookName: string, callback: FoundryHookCallback): Result<number, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n\r\n    const result = portResult.value.on(hookName, callback);\r\n\r\n    if (result.ok) {\r\n      // Track registered hook for cleanup\r\n      if (!this.registeredHooks.has(hookName)) {\r\n        this.registeredHooks.set(hookName, new Map());\r\n      }\r\n      this.registeredHooks.get(hookName)!.set(result.value, callback);\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  once(hookName: string, callback: FoundryHookCallback): Result<number, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n\r\n    // once() hooks are automatically deregistered by Foundry after firing\r\n    // No tracking needed - they clean themselves up\r\n    return portResult.value.once(hookName, callback);\r\n  }\r\n\r\n  off(hookName: string, callbackOrId: FoundryHookCallback | number): Result<void, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n\r\n    const result = portResult.value.off(hookName, callbackOrId);\r\n\r\n    if (result.ok && typeof callbackOrId === \"number\") {\r\n      // Remove from tracked hooks\r\n      const hooks = this.registeredHooks.get(hookName);\r\n      if (hooks) {\r\n        hooks.delete(callbackOrId);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Cleans up all registered hooks.\r\n   * Called automatically when the container is disposed.\r\n   */\r\n  dispose(): void {\r\n    for (const [hookName, hookMap] of this.registeredHooks) {\r\n      for (const [hookId, callback] of hookMap) {\r\n        try {\r\n          if (typeof Hooks !== \"undefined\") {\r\n            // Type-safe cast for dynamic hook names\r\n            // Foundry's Hooks API supports dynamic hook names, but fvtt-types\r\n            // has strict keyof HookConfig typing that doesn't allow runtime strings\r\n            (Hooks as DynamicHooksApi).off(hookName, callback);\r\n          }\r\n        } catch (error) {\r\n          console.warn(`Failed to unregister hook ${hookName} (ID: ${hookId}):`, error);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.registeredHooks.clear();\r\n    this.port = null;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryDocument } from \"@/foundry/interfaces/FoundryDocument\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Disposable } from \"@/di_infrastructure/interfaces/disposable\";\r\nimport { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { portSelectorToken, foundryDocumentPortRegistryToken } from \"@/foundry/foundrytokens\";\r\n\r\n/**\r\n * Service wrapper for FoundryDocument that automatically selects the appropriate port\r\n * based on the current Foundry version.\r\n *\r\n * Implements Disposable for resource cleanup consistency.\r\n */\r\nexport class FoundryDocumentService implements FoundryDocument, Disposable {\r\n  static dependencies = [portSelectorToken, foundryDocumentPortRegistryToken] as const;\r\n\r\n  private port: FoundryDocument | null = null;\r\n  private readonly portSelector: PortSelector;\r\n  private readonly portRegistry: PortRegistry<FoundryDocument>;\r\n\r\n  constructor(portSelector: PortSelector, portRegistry: PortRegistry<FoundryDocument>) {\r\n    this.portSelector = portSelector;\r\n    this.portRegistry = portRegistry;\r\n  }\r\n\r\n  /**\r\n   * Lazy-loads the appropriate port based on Foundry version.\r\n   * Uses PortSelector with factory-based selection to prevent eager instantiation.\r\n   *\r\n   * CRITICAL: This prevents crashes when newer port constructors access\r\n   * APIs not available in the current Foundry version.\r\n   *\r\n   * @returns Result containing the port or a FoundryError if no compatible port can be selected\r\n   */\r\n  private getPort(): Result<FoundryDocument, FoundryError> {\r\n    if (this.port === null) {\r\n      // Get factories (not instances) to avoid eager instantiation\r\n      const factories = this.portRegistry.getFactories();\r\n\r\n      // Use PortSelector with factory-based selection\r\n      const portResult = this.portSelector.selectPortFromFactories(factories);\r\n      if (!portResult.ok) {\r\n        return portResult;\r\n      }\r\n\r\n      this.port = portResult.value;\r\n    }\r\n    return { ok: true, value: this.port };\r\n  }\r\n\r\n  getFlag<T = unknown>(\r\n    document: { getFlag: (scope: string, key: string) => unknown },\r\n    scope: string,\r\n    key: string\r\n  ): Result<T | null, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.getFlag<T>(document, scope, key);\r\n  }\r\n\r\n  async setFlag<T = unknown>(\r\n    document: { setFlag: (scope: string, key: string, value: T) => Promise<unknown> },\r\n    scope: string,\r\n    key: string,\r\n    value: T\r\n  ): Promise<Result<void, FoundryError>> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return await portResult.value.setFlag(document, scope, key, value);\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources.\r\n   * Resets the port reference to allow garbage collection.\r\n   */\r\n  dispose(): void {\r\n    this.port = null;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryUI } from \"@/foundry/interfaces/FoundryUI\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Disposable } from \"@/di_infrastructure/interfaces/disposable\";\r\nimport { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { portSelectorToken, foundryUIPortRegistryToken } from \"@/foundry/foundrytokens\";\r\n\r\n/**\r\n * Service wrapper for FoundryUI that automatically selects the appropriate port\r\n * based on the current Foundry version.\r\n *\r\n * Implements Disposable for resource cleanup consistency.\r\n */\r\nexport class FoundryUIService implements FoundryUI, Disposable {\r\n  static dependencies = [portSelectorToken, foundryUIPortRegistryToken] as const;\r\n\r\n  private port: FoundryUI | null = null;\r\n  private readonly portSelector: PortSelector;\r\n  private readonly portRegistry: PortRegistry<FoundryUI>;\r\n\r\n  constructor(portSelector: PortSelector, portRegistry: PortRegistry<FoundryUI>) {\r\n    this.portSelector = portSelector;\r\n    this.portRegistry = portRegistry;\r\n  }\r\n\r\n  /**\r\n   * Lazy-loads the appropriate port based on Foundry version.\r\n   * Uses PortSelector with factory-based selection to prevent eager instantiation.\r\n   *\r\n   * CRITICAL: This prevents crashes when newer port constructors access\r\n   * APIs not available in the current Foundry version.\r\n   *\r\n   * @returns Result containing the port or a FoundryError if no compatible port can be selected\r\n   */\r\n  private getPort(): Result<FoundryUI, FoundryError> {\r\n    if (this.port === null) {\r\n      // Get factories (not instances) to avoid eager instantiation\r\n      const factories = this.portRegistry.getFactories();\r\n\r\n      // Use PortSelector with factory-based selection\r\n      const portResult = this.portSelector.selectPortFromFactories(factories);\r\n      if (!portResult.ok) {\r\n        return portResult;\r\n      }\r\n\r\n      this.port = portResult.value;\r\n    }\r\n    return { ok: true, value: this.port };\r\n  }\r\n\r\n  removeJournalElement(\r\n    journalId: string,\r\n    journalName: string,\r\n    html: HTMLElement\r\n  ): Result<void, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.removeJournalElement(journalId, journalName, html);\r\n  }\r\n\r\n  findElement(container: HTMLElement, selector: string): Result<HTMLElement | null, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.findElement(container, selector);\r\n  }\r\n\r\n  notify(message: string, type: \"info\" | \"warning\" | \"error\"): Result<void, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.notify(message, type);\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources.\r\n   * Resets the port reference to allow garbage collection.\r\n   */\r\n  dispose(): void {\r\n    this.port = null;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundrySettings, SettingConfig } from \"@/foundry/interfaces/FoundrySettings\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport type { Disposable } from \"@/di_infrastructure/interfaces/disposable\";\r\nimport type { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport type { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { portSelectorToken, foundrySettingsPortRegistryToken } from \"@/foundry/foundrytokens\";\r\n\r\n/**\r\n * Service wrapper for FoundrySettings that automatically selects the appropriate port\r\n * based on the current Foundry version.\r\n *\r\n * Implements Disposable for resource cleanup consistency.\r\n */\r\nexport class FoundrySettingsService implements FoundrySettings, Disposable {\r\n  static dependencies = [portSelectorToken, foundrySettingsPortRegistryToken] as const;\r\n\r\n  private port: FoundrySettings | null = null;\r\n  private readonly portSelector: PortSelector;\r\n  private readonly portRegistry: PortRegistry<FoundrySettings>;\r\n\r\n  constructor(portSelector: PortSelector, portRegistry: PortRegistry<FoundrySettings>) {\r\n    this.portSelector = portSelector;\r\n    this.portRegistry = portRegistry;\r\n  }\r\n\r\n  /**\r\n   * Lazy-loads the appropriate port based on Foundry version.\r\n   * Uses PortSelector with factory-based selection to prevent eager instantiation.\r\n   *\r\n   * CRITICAL: This prevents crashes when newer port constructors access\r\n   * APIs not available in the current Foundry version.\r\n   *\r\n   * @returns Result containing the port or a FoundryError if no compatible port can be selected\r\n   */\r\n  private getPort(): Result<FoundrySettings, FoundryError> {\r\n    if (this.port === null) {\r\n      const factories = this.portRegistry.getFactories();\r\n      const portResult = this.portSelector.selectPortFromFactories(factories);\r\n      if (!portResult.ok) {\r\n        return portResult;\r\n      }\r\n      this.port = portResult.value;\r\n    }\r\n    return { ok: true, value: this.port };\r\n  }\r\n\r\n  register<T>(\r\n    namespace: string,\r\n    key: string,\r\n    config: SettingConfig<T>\r\n  ): Result<void, FoundryError> {\r\n    const portResult = this.getPort();\r\n    /* c8 ignore next -- Branch: Port error path tested in port selection tests */\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.register(namespace, key, config);\r\n  }\r\n\r\n  get<T>(namespace: string, key: string): Result<T, FoundryError> {\r\n    const portResult = this.getPort();\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.get<T>(namespace, key);\r\n  }\r\n\r\n  async set<T>(namespace: string, key: string, value: T): Promise<Result<void, FoundryError>> {\r\n    const portResult = this.getPort();\r\n    /* c8 ignore next -- Branch: Port error path tested in port selection tests */\r\n    if (!portResult.ok) return portResult;\r\n    return portResult.value.set(namespace, key, value);\r\n  }\r\n\r\n  /**\r\n   * Cleans up resources.\r\n   * Resets the port reference to allow garbage collection.\r\n   */\r\n  dispose(): void {\r\n    this.port = null;\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { createFoundryError, type FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\n/**\r\n * Validates a journal entry ID.\r\n *\r\n * Fast manual validation optimized for hot-path operations.\r\n * Validates format, length, and character constraints.\r\n *\r\n * Rules:\r\n * - Must be a non-empty string\r\n * - Maximum 100 characters\r\n * - Only alphanumeric characters, hyphens, and underscores\r\n *\r\n * @param id - Journal entry ID to validate\r\n * @returns Result with validated ID or FoundryError\r\n *\r\n * @example\r\n * ```typescript\r\n * const result = validateJournalId(\"journal-entry-123\");\r\n * if (result.ok) {\r\n *   // Safe to use result.value\r\n * }\r\n * ```\r\n */\r\nexport function validateJournalId(id: string): Result<string, FoundryError> {\r\n  /* c8 ignore next 3 -- TypeScript ensures id is string at compile time; runtime check is defensive */\r\n  if (typeof id !== \"string\") {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"ID must be a string\"));\r\n  }\r\n\r\n  if (id.length === 0) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"ID cannot be empty\"));\r\n  }\r\n\r\n  if (id.length > 100) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"ID too long (max 100 characters)\"));\r\n  }\r\n\r\n  if (!/^[a-zA-Z0-9-_]+$/.test(id)) {\r\n    return err(\r\n      createFoundryError(\r\n        \"VALIDATION_FAILED\",\r\n        \"ID contains invalid characters (allowed: a-z, A-Z, 0-9, -, _)\",\r\n        { id }\r\n      )\r\n    );\r\n  }\r\n\r\n  return ok(id);\r\n}\r\n\r\n/**\r\n * Validates a journal entry name.\r\n *\r\n * Rules:\r\n * - Must be a non-empty string\r\n * - Maximum 255 characters\r\n *\r\n * @param name - Journal entry name to validate\r\n * @returns Result with validated name or FoundryError\r\n */\r\nexport function validateJournalName(name: string): Result<string, FoundryError> {\r\n  if (typeof name !== \"string\" || name.length === 0) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"Name cannot be empty\"));\r\n  }\r\n\r\n  if (name.length > 255) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"Name too long (max 255 characters)\"));\r\n  }\r\n\r\n  return ok(name);\r\n}\r\n\r\n/**\r\n * Validates a module flag key.\r\n *\r\n * Rules:\r\n * - Must be a non-empty string\r\n * - Maximum 100 characters\r\n * - Only alphanumeric characters and underscores\r\n *\r\n * @param key - Flag key to validate\r\n * @returns Result with validated key or FoundryError\r\n */\r\nexport function validateFlagKey(key: string): Result<string, FoundryError> {\r\n  if (typeof key !== \"string\" || key.length === 0 || key.length > 100) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"Invalid flag key length\"));\r\n  }\r\n\r\n  if (!/^[a-zA-Z0-9_]+$/.test(key)) {\r\n    return err(createFoundryError(\"VALIDATION_FAILED\", \"Invalid flag key format\"));\r\n  }\r\n\r\n  return ok(key);\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryGame } from \"@/foundry/interfaces/FoundryGame\";\r\nimport type { FoundryJournalEntry } from \"@/foundry/types\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { tryCatch, err } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { validateJournalEntries } from \"@/foundry/validation/schemas\";\r\nimport { validateJournalId } from \"@/foundry/validation/input-validators\";\r\nimport { MODULE_CONSTANTS } from \"@/constants\";\r\nimport { MetricsCollector } from \"@/observability/metrics-collector\";\r\nimport { ENV } from \"@/config/environment\";\r\n\r\n/**\r\n * v13 implementation of FoundryGame interface.\r\n * Encapsulates Foundry v13-specific game API access.\r\n *\r\n * Performance optimization: Caches validated journal entries with TTL-based invalidation\r\n * to avoid expensive Valibot validation on every call. Cache expires after 5 seconds.\r\n */\r\nexport class FoundryGamePortV13 implements FoundryGame {\r\n  private cachedEntries: FoundryJournalEntry[] | null = null;\r\n  private lastCheckTimestamp = 0;\r\n  private readonly cacheTtlMs = MODULE_CONSTANTS.DEFAULTS.CACHE_TTL_MS;\r\n\r\n  getJournalEntries(): Result<FoundryJournalEntry[], FoundryError> {\r\n    if (typeof game === \"undefined\" || !game?.journal) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry game API not available\"));\r\n    }\r\n\r\n    const now = Date.now();\r\n    const cacheAge = now - this.lastCheckTimestamp;\r\n\r\n    // Check TTL-based cache validity\r\n    if (this.cachedEntries !== null && cacheAge < this.cacheTtlMs) {\r\n      /* c8 ignore next 3 -- Performance tracking is optional feature flag tested in integration tests */\r\n      if (ENV.enablePerformanceTracking) {\r\n        MetricsCollector.getInstance().recordCacheAccess(true);\r\n      }\r\n      return { ok: true, value: this.cachedEntries };\r\n    }\r\n\r\n    /* c8 ignore next 3 -- Performance tracking is optional feature flag tested in integration tests */\r\n    if (ENV.enablePerformanceTracking) {\r\n      MetricsCollector.getInstance().recordCacheAccess(false);\r\n    }\r\n\r\n    // game.journal is typed as DocumentCollection<JournalEntry> by fvtt-types\r\n    // DocumentCollection.contents is an array of the stored documents\r\n    const entries = tryCatch(\r\n      () => Array.from(game.journal.contents),\r\n      (error) =>\r\n        createFoundryError(\"OPERATION_FAILED\", \"Failed to access journal entries\", undefined, error)\r\n    );\r\n\r\n    if (!entries.ok) {\r\n      return entries;\r\n    }\r\n\r\n    // Validate entries to ensure they have expected structure (expensive, cached for TTL duration)\r\n    // IMPORTANT: Use validation as guard only, keep original Foundry objects with prototypes\r\n    const validationResult = validateJournalEntries(entries.value);\r\n    if (!validationResult.ok) {\r\n      // Return validation error directly (preserves VALIDATION_FAILED code and details)\r\n      return validationResult;\r\n    }\r\n\r\n    // Update cache with ORIGINAL entries (preserving Foundry prototypes like sheet.render, update, etc.)\r\n    // Do NOT cache validationResult.value as it strips prototypes\r\n    this.cachedEntries = entries.value;\r\n    this.lastCheckTimestamp = now;\r\n\r\n    return { ok: true, value: this.cachedEntries };\r\n  }\r\n\r\n  /**\r\n   * Invalidates the journal entries cache.\r\n   * Forces the next getJournalEntries() call to fetch and validate fresh data.\r\n   */\r\n  invalidateCache(): void {\r\n    this.cachedEntries = null;\r\n    this.lastCheckTimestamp = 0;\r\n  }\r\n\r\n  getJournalEntryById(id: string): Result<FoundryJournalEntry | null, FoundryError> {\r\n    // Validate input\r\n    const validationResult = validateJournalId(id);\r\n    /* c8 ignore next 3 -- Input validation tested in input-validators.test.ts */\r\n    if (!validationResult.ok) {\r\n      return validationResult;\r\n    }\r\n\r\n    if (typeof game === \"undefined\" || !game?.journal) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry game API not available\"));\r\n    }\r\n\r\n    return tryCatch(\r\n      () => {\r\n        // game.journal.get() is typed by fvtt-types and returns JournalEntry | undefined\r\n        const entry = game.journal.get(validationResult.value);\r\n        return entry ?? null;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to get journal entry by ID ${validationResult.value}`,\r\n          { id: validationResult.value },\r\n          error\r\n        )\r\n    );\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryHooks } from \"@/foundry/interfaces/FoundryHooks\";\r\nimport type { FoundryHookCallback } from \"@/foundry/types\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { tryCatch } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\n/**\r\n * Type-safe interface for Foundry Hooks with dynamic hook names.\r\n * Avoids 'any' while working around fvtt-types strict hook name typing.\r\n */\r\ninterface DynamicHooksApi {\r\n  on(hookName: string, callback: (...args: unknown[]) => unknown): number;\r\n  once(hookName: string, callback: (...args: unknown[]) => unknown): number;\r\n  off(hookName: string, callbackOrId: number | ((...args: unknown[]) => unknown)): void;\r\n}\r\n\r\n/**\r\n * v13 implementation of FoundryHooks interface.\r\n * Encapsulates Foundry v13-specific hook system access.\r\n *\r\n * Based on Foundry VTT v13 Hooks API:\r\n * https://foundryvtt.com/api/classes/foundry.helpers.Hooks.html\r\n */\r\nexport class FoundryHooksPortV13 implements FoundryHooks {\r\n  on(hookName: string, callback: FoundryHookCallback): Result<number, FoundryError> {\r\n    return tryCatch(\r\n      () => {\r\n        if (typeof Hooks === \"undefined\") {\r\n          throw new Error(\"Foundry Hooks API is not available\");\r\n        }\r\n        // Type-safe cast for dynamic hook names\r\n        // Foundry's Hooks API supports dynamic hook names, but fvtt-types\r\n        // has strict keyof HookConfig typing that doesn't allow runtime strings\r\n        const hookId = (Hooks as DynamicHooksApi).on(hookName, callback);\r\n        return hookId;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to register hook ${hookName}`,\r\n          { hookName },\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  once(hookName: string, callback: FoundryHookCallback): Result<number, FoundryError> {\r\n    return tryCatch(\r\n      () => {\r\n        if (typeof Hooks === \"undefined\") {\r\n          throw new Error(\"Foundry Hooks API is not available\");\r\n        }\r\n        // Type-safe cast for dynamic hook names\r\n        // Foundry's Hooks API supports dynamic hook names, but fvtt-types\r\n        // has strict keyof HookConfig typing that doesn't allow runtime strings\r\n        const hookId = (Hooks as DynamicHooksApi).once(hookName, callback);\r\n        return hookId;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to register one-time hook ${hookName}`,\r\n          { hookName },\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  off(hookName: string, callbackOrId: FoundryHookCallback | number): Result<void, FoundryError> {\r\n    return tryCatch(\r\n      () => {\r\n        if (typeof Hooks === \"undefined\") {\r\n          throw new Error(\"Foundry Hooks API is not available\");\r\n        }\r\n        // Type-safe cast for dynamic hook names\r\n        // Foundry's Hooks API supports dynamic hook names, but fvtt-types\r\n        // has strict keyof HookConfig typing that doesn't allow runtime strings\r\n        (Hooks as DynamicHooksApi).off(hookName, callbackOrId);\r\n        return undefined;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to unregister hook ${hookName}`,\r\n          { hookName },\r\n          error\r\n        )\r\n    );\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryDocument } from \"@/foundry/interfaces/FoundryDocument\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { fromPromise, tryCatch } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\n/**\r\n * v13 implementation of FoundryDocument interface.\r\n * Encapsulates Foundry v13-specific document operations.\r\n */\r\nexport class FoundryDocumentPortV13 implements FoundryDocument {\r\n  getFlag<T = unknown>(\r\n    document: { getFlag: (scope: string, key: string) => unknown },\r\n    scope: string,\r\n    key: string\r\n  ): Result<T | null, FoundryError> {\r\n    return tryCatch(\r\n      () => {\r\n        if (!document?.getFlag) {\r\n          throw new Error(\"Document does not have getFlag method\");\r\n        }\r\n        const value = document.getFlag(scope, key) as T | null | undefined;\r\n        return value ?? null;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to get flag ${scope}.${key}`,\r\n          { scope, key },\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  async setFlag<T = unknown>(\r\n    document: { setFlag: (scope: string, key: string, value: T) => Promise<unknown> },\r\n    scope: string,\r\n    key: string,\r\n    value: T\r\n  ): Promise<Result<void, FoundryError>> {\r\n    return fromPromise<void, FoundryError>(\r\n      (async () => {\r\n        if (!document?.setFlag) {\r\n          throw new Error(\"Document does not have setFlag method\");\r\n        }\r\n        await document.setFlag(scope, key, value);\r\n      })(),\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to set flag ${scope}.${key}`,\r\n          { scope, key, value },\r\n          error\r\n        )\r\n    );\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundryUI } from \"@/foundry/interfaces/FoundryUI\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { ok, err } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { sanitizeId } from \"@/foundry/validation/schemas\";\r\n\r\n/**\r\n * v13 implementation of FoundryUI interface.\r\n * Encapsulates Foundry v13-specific UI manipulation.\r\n */\r\nexport class FoundryUIPortV13 implements FoundryUI {\r\n  removeJournalElement(\r\n    journalId: string,\r\n    journalName: string,\r\n    html: HTMLElement\r\n  ): Result<void, FoundryError> {\r\n    // Sanitize ID to prevent CSS injection\r\n    const safeId = sanitizeId(journalId);\r\n\r\n    // Support both selectors: Foundry v13 uses data-document-id, older versions used data-entry-id\r\n    const element = html.querySelector(\r\n      `li.directory-item[data-document-id=\"${safeId}\"], li.directory-item[data-entry-id=\"${safeId}\"]`\r\n    ) as HTMLElement | null;\r\n\r\n    if (!element) {\r\n      return err(\r\n        createFoundryError(\r\n          \"NOT_FOUND\",\r\n          `Could not find element for journal entry: ${journalName}`,\r\n          { journalName, journalId: safeId }\r\n        )\r\n      );\r\n    }\r\n\r\n    try {\r\n      element.remove();\r\n      return ok(undefined);\r\n    } catch (error) {\r\n      return err(\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          \"Failed to remove element from DOM\",\r\n          { journalName, journalId: safeId },\r\n          error\r\n        )\r\n      );\r\n    }\r\n  }\r\n\r\n  findElement(container: HTMLElement, selector: string): Result<HTMLElement | null, FoundryError> {\r\n    const element = container.querySelector(selector) as HTMLElement | null;\r\n    return ok(element);\r\n  }\r\n\r\n  notify(message: string, type: \"info\" | \"warning\" | \"error\"): Result<void, FoundryError> {\r\n    if (typeof ui === \"undefined\" || !ui?.notifications) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry UI notifications not available\"));\r\n    }\r\n\r\n    try {\r\n      switch (type) {\r\n        case \"info\":\r\n          ui.notifications.info(message);\r\n          break;\r\n        case \"warning\":\r\n          ui.notifications.warn(message);\r\n          break;\r\n        case \"error\":\r\n          ui.notifications.error(message);\r\n          break;\r\n      }\r\n      return ok(undefined);\r\n    } catch (error) {\r\n      return err(\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          \"Failed to show notification\",\r\n          { message, type },\r\n          error\r\n        )\r\n      );\r\n    }\r\n  }\r\n}\r\n","import type { Result } from \"@/types/result\";\r\nimport type { FoundrySettings, SettingConfig } from \"@/foundry/interfaces/FoundrySettings\";\r\nimport type { FoundryError } from \"@/foundry/errors/FoundryErrors\";\r\nimport { tryCatch, err, fromPromise } from \"@/utils/result\";\r\nimport { createFoundryError } from \"@/foundry/errors/FoundryErrors\";\r\n\r\n/**\r\n * Type-safe interface for Foundry Settings with dynamic namespaces.\r\n * Avoids 'any' while working around fvtt-types namespace restrictions.\r\n */\r\ninterface DynamicSettingsApi {\r\n  register<T>(namespace: string, key: string, config: SettingConfig<T>): void;\r\n  get<T>(namespace: string, key: string): T;\r\n  set<T>(namespace: string, key: string, value: T): Promise<T>;\r\n}\r\n\r\n/**\r\n * v13 implementation of FoundrySettings interface.\r\n * Encapsulates Foundry v13-specific settings API access.\r\n *\r\n * Supports all three setting scopes:\r\n * - world: Shared across all users in the world\r\n * - client: Browser/device-specific\r\n * - user: User-specific within a world (new in v13)\r\n */\r\nexport class FoundrySettingsPortV13 implements FoundrySettings {\r\n  register<T>(\r\n    namespace: string,\r\n    key: string,\r\n    config: SettingConfig<T>\r\n  ): Result<void, FoundryError> {\r\n    if (typeof game === \"undefined\" || !game?.settings) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry settings API not available\"));\r\n    }\r\n\r\n    return tryCatch(\r\n      () => {\r\n        // Type-safe cast for dynamic namespaces\r\n        // Foundry's Settings API supports module namespaces, but fvtt-types\r\n        // restricts namespace to \"core\" only\r\n        (game.settings as DynamicSettingsApi).register(namespace, key, config);\r\n        return undefined;\r\n      },\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to register setting ${namespace}.${key}`,\r\n          { namespace, key },\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  get<T>(namespace: string, key: string): Result<T, FoundryError> {\r\n    if (typeof game === \"undefined\" || !game?.settings) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry settings API not available\"));\r\n    }\r\n\r\n    return tryCatch(\r\n      () => (game.settings.get as (ns: string, key: string) => unknown)(namespace, key) as T,\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to get setting ${namespace}.${key}`,\r\n          { namespace, key },\r\n          error\r\n        )\r\n    );\r\n  }\r\n\r\n  async set<T>(namespace: string, key: string, value: T): Promise<Result<void, FoundryError>> {\r\n    if (typeof game === \"undefined\" || !game?.settings) {\r\n      return err(createFoundryError(\"API_NOT_AVAILABLE\", \"Foundry settings API not available\"));\r\n    }\r\n\r\n    return fromPromise(\r\n      (game.settings.set as (ns: string, key: string, val: unknown) => Promise<unknown>)(\r\n        namespace,\r\n        key,\r\n        value\r\n      ).then(() => undefined),\r\n      (error) =>\r\n        createFoundryError(\r\n          \"OPERATION_FAILED\",\r\n          `Failed to set setting ${namespace}.${key}`,\r\n          { namespace, key, value },\r\n          error\r\n        )\r\n    );\r\n  }\r\n}\r\n","import { ServiceContainer } from \"@/di_infrastructure/container\";\r\nimport { loggerToken, journalVisibilityServiceToken } from \"@/tokens/tokenindex\";\r\nimport { ConsoleLoggerService } from \"@/services/consolelogger\";\r\nimport { JournalVisibilityService } from \"@/services/JournalVisibilityService\";\r\nimport { ServiceLifecycle } from \"@/di_infrastructure/types/servicelifecycle\";\r\nimport { ok, err, isErr } from \"@/utils/result\";\r\nimport type { Result } from \"@/types/result\";\r\nimport type { Logger } from \"@/interfaces/logger\";\r\nimport { ENV } from \"@/config/environment\";\r\nimport {\r\n  foundryGameToken,\r\n  foundryHooksToken,\r\n  foundryDocumentToken,\r\n  foundryUIToken,\r\n  foundrySettingsToken,\r\n  portSelectorToken,\r\n  foundryGamePortRegistryToken,\r\n  foundryHooksPortRegistryToken,\r\n  foundryDocumentPortRegistryToken,\r\n  foundryUIPortRegistryToken,\r\n  foundrySettingsPortRegistryToken,\r\n} from \"@/foundry/foundrytokens\";\r\nimport { PortSelector } from \"@/foundry/versioning/portselector\";\r\nimport { PortRegistry } from \"@/foundry/versioning/portregistry\";\r\nimport { FoundryGameService } from \"@/foundry/services/FoundryGameService\";\r\nimport { FoundryHooksService } from \"@/foundry/services/FoundryHooksService\";\r\nimport { FoundryDocumentService } from \"@/foundry/services/FoundryDocumentService\";\r\nimport { FoundryUIService } from \"@/foundry/services/FoundryUIService\";\r\nimport { FoundrySettingsService } from \"@/foundry/services/FoundrySettingsService\";\r\nimport { FoundryGamePortV13 } from \"@/foundry/ports/v13/FoundryGamePort\";\r\nimport { FoundryHooksPortV13 } from \"@/foundry/ports/v13/FoundryHooksPort\";\r\nimport { FoundryDocumentPortV13 } from \"@/foundry/ports/v13/FoundryDocumentPort\";\r\nimport { FoundryUIPortV13 } from \"@/foundry/ports/v13/FoundryUIPort\";\r\nimport { FoundrySettingsPortV13 } from \"@/foundry/ports/v13/FoundrySettingsPort\";\r\nimport type { FoundryGame } from \"@/foundry/interfaces/FoundryGame\";\r\nimport type { FoundryHooks } from \"@/foundry/interfaces/FoundryHooks\";\r\nimport type { FoundryDocument } from \"@/foundry/interfaces/FoundryDocument\";\r\nimport type { FoundryUI } from \"@/foundry/interfaces/FoundryUI\";\r\nimport type { FoundrySettings } from \"@/foundry/interfaces/FoundrySettings\";\r\n\r\n/**\r\n * Helper function for port registration.\r\n * Reduces duplication when registering multiple ports.\r\n *\r\n * @template T - The port type\r\n * @param registry - The port registry to register to\r\n * @param version - The Foundry version this port supports\r\n * @param factory - Factory function that creates the port instance\r\n * @param portName - Name of the port (for error messages)\r\n * @param errors - Array to collect error messages\r\n */\r\nfunction registerPortToRegistry<T>(\r\n  registry: PortRegistry<T>,\r\n  version: number,\r\n  factory: () => T,\r\n  portName: string,\r\n  errors: string[]\r\n): void {\r\n  const result = registry.register(version, factory);\r\n  /* c8 ignore next 3 -- Defensive: Port registration can only fail if version is duplicate, which is controlled by hardcoded port registrations */\r\n  if (isErr(result)) {\r\n    errors.push(`${portName} v${version}: ${result.error}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Configures all dependency injection mappings for the application.\r\n * This is the central place where tokens are connected to their factories.\r\n *\r\n * Also registers fallback factories for critical services that should always be available\r\n * even if container resolution fails.\r\n *\r\n * @param container - The service container to configure\r\n * @returns Result indicating success or configuration errors\r\n *\r\n * @example\r\n * ```typescript\r\n * const container = ServiceContainer.createRoot();\r\n * const result = configureDependencies(container);\r\n * if (isOk(result)) {\r\n *   const logger = container.resolve(loggerToken); // Direct resolution with fallback\r\n * }\r\n * ```\r\n */\r\nexport function configureDependencies(container: ServiceContainer): Result<void, string> {\r\n  // Register fallback factories for services that should always be available\r\n  container.registerFallback<Logger>(loggerToken, () => new ConsoleLoggerService());\r\n\r\n  // Register logger\r\n  const loggerResult = container.registerClass(\r\n    loggerToken,\r\n    ConsoleLoggerService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(loggerResult)) {\r\n    return err(`Failed to register logger: ${loggerResult.error.message}`);\r\n  }\r\n\r\n  // Register PortSelector as singleton\r\n  const portSelectorResult = container.registerFactory(\r\n    portSelectorToken,\r\n    () => new PortSelector(),\r\n    ServiceLifecycle.SINGLETON,\r\n    []\r\n  );\r\n\r\n  /* c8 ignore next 3 -- Defensive: Value registration can only fail if token is duplicate or container is in invalid state, which cannot happen during normal bootstrap */\r\n  if (isErr(portSelectorResult)) {\r\n    return err(`Failed to register PortSelector: ${portSelectorResult.error.message}`);\r\n  }\r\n\r\n  // Register PortRegistries\r\n  const portRegistrationErrors: string[] = [];\r\n\r\n  const gamePortRegistry = new PortRegistry<FoundryGame>();\r\n  registerPortToRegistry(\r\n    gamePortRegistry,\r\n    13,\r\n    () => new FoundryGamePortV13(),\r\n    \"FoundryGame\",\r\n    portRegistrationErrors\r\n  );\r\n\r\n  const hooksPortRegistry = new PortRegistry<FoundryHooks>();\r\n  registerPortToRegistry(\r\n    hooksPortRegistry,\r\n    13,\r\n    () => new FoundryHooksPortV13(),\r\n    \"FoundryHooks\",\r\n    portRegistrationErrors\r\n  );\r\n\r\n  const documentPortRegistry = new PortRegistry<FoundryDocument>();\r\n  registerPortToRegistry(\r\n    documentPortRegistry,\r\n    13,\r\n    () => new FoundryDocumentPortV13(),\r\n    \"FoundryDocument\",\r\n    portRegistrationErrors\r\n  );\r\n\r\n  const uiPortRegistry = new PortRegistry<FoundryUI>();\r\n  registerPortToRegistry(\r\n    uiPortRegistry,\r\n    13,\r\n    () => new FoundryUIPortV13(),\r\n    \"FoundryUI\",\r\n    portRegistrationErrors\r\n  );\r\n\r\n  const settingsPortRegistry = new PortRegistry<FoundrySettings>();\r\n  registerPortToRegistry(\r\n    settingsPortRegistry,\r\n    13,\r\n    () => new FoundrySettingsPortV13(),\r\n    \"FoundrySettings\",\r\n    portRegistrationErrors\r\n  );\r\n\r\n  // Return early if any port registration failed\r\n  /* c8 ignore next 3 -- Port registration errors already tested individually; aggregation is defensive */\r\n  if (portRegistrationErrors.length > 0) {\r\n    return err(`Port registration failed: ${portRegistrationErrors.join(\"; \")}`);\r\n  }\r\n\r\n  const gameRegistryResult = container.registerValue(\r\n    foundryGamePortRegistryToken,\r\n    gamePortRegistry\r\n  );\r\n  if (isErr(gameRegistryResult)) {\r\n    return err(`Failed to register FoundryGame PortRegistry: ${gameRegistryResult.error.message}`);\r\n  }\r\n\r\n  const hooksRegistryResult = container.registerValue(\r\n    foundryHooksPortRegistryToken,\r\n    hooksPortRegistry\r\n  );\r\n  /* c8 ignore next 5 -- Defensive: Value registration can only fail if token is duplicate or container is in invalid state, which cannot happen during normal bootstrap */\r\n  if (isErr(hooksRegistryResult)) {\r\n    return err(\r\n      `Failed to register FoundryHooks PortRegistry: ${hooksRegistryResult.error.message}`\r\n    );\r\n  }\r\n\r\n  const documentRegistryResult = container.registerValue(\r\n    foundryDocumentPortRegistryToken,\r\n    documentPortRegistry\r\n  );\r\n  /* c8 ignore next 5 -- Defensive: Value registration can only fail if token is duplicate or container is in invalid state, which cannot happen during normal bootstrap */\r\n  if (isErr(documentRegistryResult)) {\r\n    return err(\r\n      `Failed to register FoundryDocument PortRegistry: ${documentRegistryResult.error.message}`\r\n    );\r\n  }\r\n\r\n  const uiRegistryResult = container.registerValue(foundryUIPortRegistryToken, uiPortRegistry);\r\n  /* c8 ignore next 3 -- Defensive: Value registration can only fail if token is duplicate or container is in invalid state, which cannot happen during normal bootstrap */\r\n  if (isErr(uiRegistryResult)) {\r\n    return err(`Failed to register FoundryUI PortRegistry: ${uiRegistryResult.error.message}`);\r\n  }\r\n\r\n  const settingsRegistryResult = container.registerValue(\r\n    foundrySettingsPortRegistryToken,\r\n    settingsPortRegistry\r\n  );\r\n  if (isErr(settingsRegistryResult)) {\r\n    return err(\r\n      `Failed to register FoundrySettings PortRegistry: ${settingsRegistryResult.error.message}`\r\n    );\r\n  }\r\n\r\n  // Register Foundry Services using registerClass (with static dependencies)\r\n  const gameServiceResult = container.registerClass(\r\n    foundryGameToken,\r\n    FoundryGameService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(gameServiceResult)) {\r\n    return err(`Failed to register FoundryGame service: ${gameServiceResult.error.message}`);\r\n  }\r\n\r\n  const hooksServiceResult = container.registerClass(\r\n    foundryHooksToken,\r\n    FoundryHooksService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(hooksServiceResult)) {\r\n    return err(`Failed to register FoundryHooks service: ${hooksServiceResult.error.message}`);\r\n  }\r\n\r\n  const documentServiceResult = container.registerClass(\r\n    foundryDocumentToken,\r\n    FoundryDocumentService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(documentServiceResult)) {\r\n    return err(\r\n      `Failed to register FoundryDocument service: ${documentServiceResult.error.message}`\r\n    );\r\n  }\r\n\r\n  const uiServiceResult = container.registerClass(\r\n    foundryUIToken,\r\n    FoundryUIService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(uiServiceResult)) {\r\n    return err(`Failed to register FoundryUI service: ${uiServiceResult.error.message}`);\r\n  }\r\n\r\n  const settingsServiceResult = container.registerClass(\r\n    foundrySettingsToken,\r\n    FoundrySettingsService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(settingsServiceResult)) {\r\n    return err(\r\n      `Failed to register FoundrySettings service: ${settingsServiceResult.error.message}`\r\n    );\r\n  }\r\n\r\n  const journalVisibilityResult = container.registerClass(\r\n    journalVisibilityServiceToken,\r\n    JournalVisibilityService,\r\n    ServiceLifecycle.SINGLETON\r\n  );\r\n\r\n  if (isErr(journalVisibilityResult)) {\r\n    return err(\r\n      `Failed to register JournalVisibility service: ${journalVisibilityResult.error.message}`\r\n    );\r\n  }\r\n\r\n  // Phase 2: Validate\r\n  const validateResult = container.validate();\r\n  /* c8 ignore next 4 -- Defensive: Validation can only fail if dependencies are missing or circular, which cannot happen with hardcoded dependency graph */\r\n  if (isErr(validateResult)) {\r\n    const errorMessages = validateResult.error.map((e) => e.message).join(\", \");\r\n    return err(`Validation failed: ${errorMessages}`);\r\n  }\r\n\r\n  // Phase 3: Configure logger with ENV settings\r\n  const resolvedLoggerResult = container.resolveWithError(loggerToken);\r\n  if (resolvedLoggerResult.ok) {\r\n    const loggerInstance = resolvedLoggerResult.value;\r\n    if (loggerInstance.setMinLevel) {\r\n      loggerInstance.setMinLevel(ENV.logLevel);\r\n    }\r\n  }\r\n\r\n  return ok(undefined);\r\n}\r\n","import { MODULE_CONSTANTS } from \"@/constants\";\r\nimport type { Result } from \"@/types/result\";\r\nimport { ServiceContainer } from \"@/di_infrastructure/container\";\r\nimport { configureDependencies } from \"@/config/dependencyconfig\";\r\nimport type { InjectionToken } from \"@/di_infrastructure/types/injectiontoken\";\r\nimport { markAsApiSafe } from \"@/di_infrastructure/types/api-safe-token\";\r\nimport type { ModuleApi, ModuleApiTokens, TokenInfo, HealthStatus } from \"@/core/module-api\";\r\nimport type { ServiceType } from \"@/types/servicetypeindex\";\r\nimport { loggerToken, journalVisibilityServiceToken } from \"@/tokens/tokenindex\";\r\nimport {\r\n  foundryGameToken,\r\n  foundryHooksToken,\r\n  foundryDocumentToken,\r\n  foundryUIToken,\r\n  foundrySettingsToken,\r\n} from \"@/foundry/foundrytokens\";\r\nimport { PERFORMANCE_MARKS } from \"@/core/performance-constants\";\r\nimport { ENV } from \"@/config/environment\";\r\nimport { MetricsCollector } from \"@/observability/metrics-collector\";\r\n\r\n/**\r\n * CompositionRoot\r\n *\r\n * Zentraler Bootkernel: erstellt den DI-Container, f√ºhrt die Basis-Registrierungen\r\n * via configureDependencies aus und stellt die √∂ffentliche Modul-API (nur resolve)\r\n * unter game.modules.get(MODULE_ID).api bereit.\r\n *\r\n * Zweiphasiger Bootstrap:\r\n * - Phase 1 (vor Foundry init): Container erstellen und Grund-Registrierungen.\r\n * - Phase 2 (im Foundry init): Ports selektieren/binden und Hooks registrieren.\r\n */\r\nexport class CompositionRoot {\r\n  private container: ServiceContainer | null = null;\r\n\r\n  /**\r\n   * Erstellt den ServiceContainer und f√ºhrt Basis-Registrierungen aus.\r\n   * Misst Performance f√ºr Diagnose-Zwecke.\r\n   * @returns Result mit initialisiertem Container oder Fehlermeldung\r\n   */\r\n  bootstrap(): Result<ServiceContainer, string> {\r\n    // Performance-Messung starten (nur in Debug-Mode)\r\n    if (ENV.enableDebugMode || ENV.enablePerformanceTracking) {\r\n      performance.mark(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START);\r\n    }\r\n\r\n    const container = ServiceContainer.createRoot();\r\n    const configured = configureDependencies(container);\r\n\r\n    // Performance-Messung beenden und loggen (nur in Debug-Mode)\r\n    if (ENV.enableDebugMode || ENV.enablePerformanceTracking) {\r\n      performance.mark(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END);\r\n      performance.measure(\r\n        PERFORMANCE_MARKS.MODULE.BOOTSTRAP.DURATION,\r\n        PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START,\r\n        PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END\r\n      );\r\n\r\n      // Get the latest measurement entry (not the first one which could be stale)\r\n      const entries = performance.getEntriesByName(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.DURATION);\r\n      const measure = entries.at(-1);\r\n\r\n      if (measure && ENV.enableDebugMode) {\r\n        console.debug(\r\n          `${MODULE_CONSTANTS.LOG_PREFIX} Bootstrap completed in ${measure.duration.toFixed(2)}ms`\r\n        );\r\n      }\r\n\r\n      // Clean up performance marks/measures to prevent memory leaks\r\n      performance.clearMarks(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.START);\r\n      performance.clearMarks(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.END);\r\n      performance.clearMeasures(PERFORMANCE_MARKS.MODULE.BOOTSTRAP.DURATION);\r\n    }\r\n\r\n    if (configured.ok) {\r\n      this.container = container;\r\n      return { ok: true, value: container };\r\n    }\r\n    return { ok: false, error: configured.error };\r\n  }\r\n\r\n  /**\r\n   * Exponiert die √∂ffentliche Modul-API unter game.modules.get(MODULE_ID).api.\r\n   * Stellt resolve(), getAvailableTokens() und tokens bereit.\r\n   * Darf erst nach erfolgreichem Bootstrap aufgerufen werden.\r\n   * @throws Fehler, wenn das Foundry-Modul-Objekt nicht verf√ºgbar ist\r\n   */\r\n  /* c8 ignore next -- Requires Foundry game module globals */\r\n  exposeToModuleApi(): void {\r\n    const containerResult = this.getContainer();\r\n    if (!containerResult.ok) {\r\n      throw new Error(containerResult.error);\r\n    }\r\n    const container = containerResult.value;\r\n\r\n    // game.modules is typed as ModuleCollection (Map<string, Module>) by fvtt-types\r\n    if (typeof game === \"undefined\" || !game?.modules) {\r\n      throw new Error(`${MODULE_CONSTANTS.LOG_PREFIX} Game modules not available`);\r\n    }\r\n    const mod = game.modules.get(MODULE_CONSTANTS.MODULE.ID);\r\n    if (!mod) {\r\n      throw new Error(`${MODULE_CONSTANTS.LOG_PREFIX} Module not available to expose API`);\r\n    }\r\n\r\n    // Type-safe token collection - mark all tokens as API-safe for external consumption\r\n    const wellKnownTokens: ModuleApiTokens = {\r\n      loggerToken: markAsApiSafe(loggerToken),\r\n      journalVisibilityServiceToken: markAsApiSafe(journalVisibilityServiceToken),\r\n      foundryGameToken: markAsApiSafe(foundryGameToken),\r\n      foundryHooksToken: markAsApiSafe(foundryHooksToken),\r\n      foundryDocumentToken: markAsApiSafe(foundryDocumentToken),\r\n      foundryUIToken: markAsApiSafe(foundryUIToken),\r\n      foundrySettingsToken: markAsApiSafe(foundrySettingsToken),\r\n    };\r\n\r\n    const api: ModuleApi = {\r\n      version: \"1.0.0\",\r\n\r\n      // Bind container.resolve() directly (already typed as ApiSafeToken in ModuleApi interface)\r\n      // eslint-disable-next-line @typescript-eslint/no-deprecated -- API boundary: External modules use resolve()\r\n      resolve: container.resolve.bind(container),\r\n\r\n      getAvailableTokens: (): Map<symbol, TokenInfo> => {\r\n        const tokenMap = new Map<symbol, TokenInfo>();\r\n\r\n        // Add well-known tokens with their registration status\r\n        const tokenEntries: Array<[string, InjectionToken<ServiceType>]> = [\r\n          [\"loggerToken\", loggerToken],\r\n          [\"journalVisibilityServiceToken\", journalVisibilityServiceToken],\r\n          [\"foundryGameToken\", foundryGameToken],\r\n          [\"foundryHooksToken\", foundryHooksToken],\r\n          [\"foundryDocumentToken\", foundryDocumentToken],\r\n          [\"foundryUIToken\", foundryUIToken],\r\n          [\"foundrySettingsToken\", foundrySettingsToken],\r\n        ];\r\n\r\n        for (const [, token] of tokenEntries) {\r\n          const isRegisteredResult = container.isRegistered(token);\r\n          tokenMap.set(token, {\r\n            description: String(token).replace(\"Symbol(\", \"\").replace(\")\", \"\"),\r\n            /* c8 ignore next -- isRegistered never fails; ok check is defensive */\r\n            isRegistered: isRegisteredResult.ok ? isRegisteredResult.value : false,\r\n          });\r\n        }\r\n\r\n        return tokenMap;\r\n      },\r\n\r\n      tokens: wellKnownTokens,\r\n\r\n      getMetrics: () => MetricsCollector.getInstance().getSnapshot(),\r\n\r\n      getHealth: (): HealthStatus => {\r\n        /* c8 ignore next -- Container is always validated after bootstrap, unhealthy path requires internal state manipulation */\r\n        const containerValidated = this.container?.getValidationState() === \"validated\";\r\n        const metrics = MetricsCollector.getInstance().getSnapshot();\r\n        const hasPortSelections = Object.keys(metrics.portSelections).length > 0;\r\n        const hasPortFailures = Object.keys(metrics.portSelectionFailures).length > 0;\r\n\r\n        // Determine overall status\r\n        let status: \"healthy\" | \"degraded\" | \"unhealthy\";\r\n        /* c8 ignore next 3 -- Container is always validated after bootstrap; unhealthy status requires internal manipulation */\r\n        if (!containerValidated) {\r\n          status = \"unhealthy\";\r\n        } else if (hasPortFailures || metrics.resolutionErrors > 0) {\r\n          status = \"degraded\";\r\n        } else {\r\n          status = \"healthy\";\r\n        }\r\n\r\n        return {\r\n          status,\r\n          checks: {\r\n            containerValidated,\r\n            portsSelected: hasPortSelections,\r\n            lastError: hasPortFailures\r\n              ? `Port selection failures detected for versions: ${Object.keys(metrics.portSelectionFailures).join(\", \")}`\r\n              : null,\r\n          },\r\n          timestamp: new Date().toISOString(),\r\n        };\r\n      },\r\n    };\r\n\r\n    // Type-safe assignment thanks to Module augmentation in global.d.ts\r\n    mod.api = api;\r\n  }\r\n\r\n  /**\r\n   * Liefert den initialisierten Container als Result.\r\n   * @returns Result mit Container oder Fehlermeldung\r\n   */\r\n  getContainer(): Result<ServiceContainer, string> {\r\n    if (!this.container) {\r\n      return { ok: false, error: `${MODULE_CONSTANTS.LOG_PREFIX} Container not initialized` };\r\n    }\r\n    return { ok: true, value: this.container };\r\n  }\r\n}\r\n","import { MODULE_CONSTANTS } from \"@/constants\";\r\nimport { loggerToken, journalVisibilityServiceToken } from \"@/tokens/tokenindex\";\r\nimport { foundryHooksToken } from \"@/foundry/foundrytokens\";\r\nimport type { ServiceContainer } from \"@/di_infrastructure/container\";\r\n\r\n/**\r\n * Type guard for jQuery objects.\r\n * jQuery objects are array-like with numeric index and length property.\r\n */\r\nfunction isJQueryObject(value: unknown): value is { [index: number]: HTMLElement; length: number } {\r\n  if (value === null || typeof value !== \"object\") return false;\r\n\r\n  const obj = value as Record<string, unknown>;\r\n  return \"length\" in obj && typeof obj.length === \"number\" && obj.length > 0 && \"0\" in obj;\r\n}\r\n\r\n/**\r\n * ModuleHookRegistrar\r\n *\r\n * B√ºndelt die Registrierung aller Foundry-Hooks f√ºr dieses Modul. Muss NACH der\r\n * Port-Selektion im init-Hook aufgerufen werden, damit die finalen Ports aktiv sind.\r\n */\r\nexport class ModuleHookRegistrar {\r\n  /**\r\n   * Registriert alle ben√∂tigten Hooks.\r\n   * @param container DI-Container mit final gebundenen Ports und Services\r\n   */\r\n  registerAll(container: ServiceContainer): void {\r\n    const foundryHooksResult = container.resolveWithError(foundryHooksToken);\r\n    const loggerResult = container.resolveWithError(loggerToken);\r\n    const journalVisibilityResult = container.resolveWithError(journalVisibilityServiceToken);\r\n\r\n    // Early return if any resolution failed\r\n    /* c8 ignore next 4 -- Defensive: Service resolution can only fail if container is not validated or services are not registered, which cannot happen in normal flow */\r\n    if (!foundryHooksResult.ok || !loggerResult.ok || !journalVisibilityResult.ok) {\r\n      console.error(\"Failed to resolve required services for hook registration\");\r\n      return;\r\n    }\r\n\r\n    const foundryHooks = foundryHooksResult.value;\r\n    const logger = loggerResult.value;\r\n    const journalVisibility = journalVisibilityResult.value;\r\n\r\n    const hookResult = foundryHooks.on(\r\n      MODULE_CONSTANTS.HOOKS.RENDER_JOURNAL_DIRECTORY,\r\n      (app, html) => {\r\n        logger.debug(`${MODULE_CONSTANTS.HOOKS.RENDER_JOURNAL_DIRECTORY} fired`);\r\n\r\n        // FIX: Extract HTMLElement from either jQuery or native DOM\r\n        const htmlElement = this.extractHtmlElement(html);\r\n        if (!htmlElement) {\r\n          logger.error(\"Failed to get HTMLElement from hook - incompatible format\");\r\n          return;\r\n        }\r\n\r\n        journalVisibility.processJournalDirectory(htmlElement);\r\n      }\r\n    );\r\n\r\n    if (!hookResult.ok) {\r\n      logger.error(\r\n        `Failed to register ${MODULE_CONSTANTS.HOOKS.RENDER_JOURNAL_DIRECTORY} hook: ${hookResult.error.message}`,\r\n        {\r\n          code: hookResult.error.code,\r\n          details: hookResult.error.details,\r\n          cause: hookResult.error.cause,\r\n        }\r\n      );\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Extracts HTMLElement from hook argument (jQuery or native DOM).\r\n   *\r\n   * Foundry v10-12: hooks pass jQuery wrapper objects\r\n   * Foundry v13+: hooks pass native HTMLElement\r\n   *\r\n   * @param html - Hook argument (HTMLElement, jQuery, or unknown)\r\n   * @returns HTMLElement or null if extraction failed\r\n   */\r\n  private extractHtmlElement(html: unknown): HTMLElement | null {\r\n    // Case 1: Native HTMLElement (Foundry v13+)\r\n    if (html instanceof HTMLElement) {\r\n      return html;\r\n    }\r\n\r\n    // Case 2: jQuery object with numeric index (Foundry v10-12)\r\n    if (isJQueryObject(html) && html[0] instanceof HTMLElement) {\r\n      return html[0];\r\n    }\r\n\r\n    // Case 3: jQuery with .get() method (additional safety)\r\n    if (html && typeof html === \"object\" && \"get\" in html) {\r\n      const obj = html as Record<string, unknown>;\r\n      if (typeof obj.get === \"function\") {\r\n        try {\r\n          const element = (obj.get as (index: number) => unknown)(0);\r\n          if (element instanceof HTMLElement) {\r\n            return element;\r\n          }\r\n          /* c8 ignore next 3 -- Defensive: Ignore errors from accessing journal entry properties that may not exist */\r\n        } catch {\r\n          // Intentionally empty catch block\r\n        }\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n","import { MODULE_CONSTANTS } from \"@/constants\";\r\nimport { LogLevel } from \"@/config/environment\";\r\nimport { loggerToken } from \"@/tokens/tokenindex\";\r\nimport { foundrySettingsToken } from \"@/foundry/foundrytokens\";\r\nimport type { ServiceContainer } from \"@/di_infrastructure/container\";\r\n\r\n/**\r\n * ModuleSettingsRegistrar\r\n *\r\n * Registers all Foundry module settings during the init hook.\r\n * Provides onChange handlers for reactive setting updates.\r\n */\r\nexport class ModuleSettingsRegistrar {\r\n  /**\r\n   * Registers all module settings.\r\n   * Must be called during or after the 'init' hook.\r\n   *\r\n   * @param container DI-Container with registered services\r\n   */\r\n  registerAll(container: ServiceContainer): void {\r\n    const settingsResult = container.resolveWithError(foundrySettingsToken);\r\n    const loggerResult = container.resolveWithError(loggerToken);\r\n\r\n    // Early return if any resolution failed\r\n    /* c8 ignore next 4 -- Defensive: Service resolution can only fail if container is not validated or services are not registered, which cannot happen in normal flow */\r\n    if (!settingsResult.ok || !loggerResult.ok) {\r\n      console.error(\"Failed to resolve required services for settings registration\");\r\n      return;\r\n    }\r\n\r\n    const settings = settingsResult.value;\r\n    const logger = loggerResult.value;\r\n\r\n    // Register log level setting\r\n    const result = settings.register(\r\n      MODULE_CONSTANTS.MODULE.ID,\r\n      MODULE_CONSTANTS.SETTINGS.LOG_LEVEL,\r\n      {\r\n        name: \"Log Level\",\r\n        hint: \"Mindest-Log-Level f√ºr Modul-Ausgaben. DEBUG zeigt alle Logs, ERROR nur kritische Fehler.\",\r\n        scope: \"world\",\r\n        config: true,\r\n        type: Number,\r\n        choices: {\r\n          [LogLevel.DEBUG]: \"DEBUG (Alle Logs - f√ºr Debugging)\",\r\n          [LogLevel.INFO]: \"INFO (Standard)\",\r\n          [LogLevel.WARN]: \"WARN (Nur Warnungen und Fehler)\",\r\n          [LogLevel.ERROR]: \"ERROR (Nur kritische Fehler)\",\r\n        },\r\n        default: LogLevel.INFO,\r\n        onChange: (value: number) => {\r\n          // Logger dynamisch neu konfigurieren wenn Setting ge√§ndert wird\r\n          if (logger.setMinLevel) {\r\n            logger.setMinLevel(value as LogLevel);\r\n            logger.info(`Log-Level ge√§ndert zu: ${LogLevel[value]}`);\r\n          }\r\n        },\r\n      }\r\n    );\r\n\r\n    if (!result.ok) {\r\n      logger.error(\"Failed to register log level setting\", result.error);\r\n    }\r\n  }\r\n}\r\n","import { MODULE_CONSTANTS } from \"@/constants\";\r\n\r\n/**\r\n * Context information for error logging.\r\n * Provides structured metadata about where and when an error occurred.\r\n */\r\nexport interface ErrorContext {\r\n  /** Phase of module lifecycle when error occurred */\r\n  phase: \"bootstrap\" | \"initialization\" | \"runtime\";\r\n  /** Component or service where error originated */\r\n  component?: string;\r\n  /** Additional contextual metadata */\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\n/**\r\n * Centralized error handler for bootstrap and initialization errors.\r\n *\r\n * Provides structured, grouped error logging in the browser console.\r\n * Uses console.group() for clear, collapsible output that's easy to\r\n * screenshot and share for debugging.\r\n *\r\n * @remarks\r\n * Foundry v13 does not write module console logs to error.log files,\r\n * so this handler optimizes for browser console readability.\r\n *\r\n * @example\r\n * ```typescript\r\n * BootstrapErrorHandler.logError(error, {\r\n *   phase: 'bootstrap',\r\n *   component: 'CompositionRoot',\r\n *   metadata: { foundryVersion: 13 }\r\n * });\r\n * ```\r\n */\r\nexport class BootstrapErrorHandler {\r\n  /**\r\n   * Logs an error with structured context in the browser console.\r\n   *\r\n   * Creates a collapsible group with timestamp, phase, component,\r\n   * error details, and metadata for easy debugging and screenshotting.\r\n   *\r\n   * @param error - The error that occurred (Error object, string, or unknown)\r\n   * @param context - Context information about the error\r\n   */\r\n  static logError(error: unknown, context: ErrorContext): void {\r\n    const timestamp = new Date().toISOString();\r\n\r\n    console.group(`[${timestamp}] ${MODULE_CONSTANTS.LOG_PREFIX} Error in ${context.phase}`);\r\n\r\n    if (context.component) {\r\n      console.error(\"Component:\", context.component);\r\n    }\r\n\r\n    console.error(\"Error:\", error);\r\n\r\n    if (context.metadata && Object.keys(context.metadata).length > 0) {\r\n      console.error(\"Metadata:\", context.metadata);\r\n    }\r\n\r\n    console.groupEnd();\r\n  }\r\n}\r\n","import { MODULE_CONSTANTS } from \"../constants\";\r\nimport { isOk } from \"@/utils/result\";\r\nimport { loggerToken } from \"@/tokens/tokenindex\";\r\nimport { CompositionRoot } from \"@/core/composition-root\";\r\nimport { ModuleHookRegistrar } from \"@/core/module-hook-registrar\";\r\nimport { ModuleSettingsRegistrar } from \"@/core/module-settings-registrar\";\r\nimport { tryGetFoundryVersion } from \"@/foundry/versioning/versiondetector\";\r\nimport { foundrySettingsToken } from \"@/foundry/foundrytokens\";\r\nimport { LogLevel } from \"@/config/environment\";\r\nimport { BootstrapErrorHandler } from \"@/core/bootstrap-error-handler\";\r\n\r\n/**\r\n * Boot-Orchestrierung f√ºr das Modul.\r\n *\r\n * Ablauf:\r\n * - Vor init: DI-Container erstellen (CompositionRoot.bootstrap) und bei Fehler abbrechen\r\n * - In init: API (resolve) exponieren, Ports selektieren/binden (via externem Selector), Hooks registrieren\r\n * - In ready: nur Logging o.√§. ‚Äì Services sind √ºber api.resolve nutzbar\r\n */\r\n\r\n/**\r\n * Function to encapsulate initialization logic.\r\n * This allows us to use return statements for soft aborts.\r\n */\r\n/* c8 ignore start -- Entire function requires Foundry Hooks globals to be present */\r\nfunction initializeFoundryModule(): void {\r\n  const containerResult = root.getContainer();\r\n  /* c8 ignore next 4 -- Bootstrap failure path tested in init-solid.test.ts bootstrap failure tests */\r\n  if (!containerResult.ok) {\r\n    console.error(`${MODULE_CONSTANTS.LOG_PREFIX} ${containerResult.error}`);\r\n    return;\r\n  }\r\n\r\n  const loggerResult = containerResult.value.resolveWithError(loggerToken);\r\n  /* c8 ignore next 6 -- Defensive: Logger resolution can only fail if container is not validated, which is checked in bootstrap */\r\n  if (!loggerResult.ok) {\r\n    console.error(\r\n      `${MODULE_CONSTANTS.LOG_PREFIX} Failed to resolve logger: ${loggerResult.error.message}`\r\n    );\r\n    return;\r\n  }\r\n  const logger = loggerResult.value;\r\n\r\n  // Guard: Ensure Foundry Hooks API is available\r\n  /* c8 ignore next -- Requires Foundry Hooks global */\r\n  if (typeof Hooks === \"undefined\") {\r\n    logger.warn(\"Foundry Hooks API not available - module initialization skipped\");\r\n    return; // Soft abort - OK inside function\r\n  }\r\n\r\n  /* c8 ignore next -- Registers Foundry hook callbacks */\r\n  Hooks.on(\"init\", () => {\r\n    logger.info(\"init-phase\");\r\n    root.exposeToModuleApi();\r\n\r\n    const initContainerResult = root.getContainer();\r\n    /* c8 ignore next 4 -- Defensive: Container is available after successful bootstrap */\r\n    if (!initContainerResult.ok) {\r\n      logger.error(`Failed to get container in init hook: ${initContainerResult.error}`);\r\n      return;\r\n    }\r\n\r\n    // Register module settings (must be done before settings are read)\r\n    new ModuleSettingsRegistrar().registerAll(initContainerResult.value);\r\n\r\n    // Configure logger with current setting value\r\n    const settingsResult = initContainerResult.value.resolveWithError(foundrySettingsToken);\r\n    if (settingsResult.ok) {\r\n      const settings = settingsResult.value;\r\n      const logLevelResult = settings.get<number>(\r\n        MODULE_CONSTANTS.MODULE.ID,\r\n        MODULE_CONSTANTS.SETTINGS.LOG_LEVEL\r\n      );\r\n\r\n      /* c8 ignore next 4 -- Logger configuration: setMinLevel is optional method, and log level setting may not be configured yet */\r\n      if (logLevelResult.ok && logger.setMinLevel) {\r\n        logger.setMinLevel(logLevelResult.value as LogLevel);\r\n        logger.debug(`Logger configured with level: ${LogLevel[logLevelResult.value]}`);\r\n      }\r\n    }\r\n\r\n    // Register module hooks\r\n    new ModuleHookRegistrar().registerAll(initContainerResult.value);\r\n    logger.info(\"init-phase completed\");\r\n  });\r\n\r\n  /* c8 ignore next -- Registers Foundry hook callbacks */\r\n  Hooks.on(\"ready\", () => {\r\n    logger.info(\"ready-phase\");\r\n    logger.info(\"ready-phase completed\");\r\n  });\r\n}\r\n/* c8 ignore stop */\r\n\r\n// Eager bootstrap DI before Foundry init\r\nconst root = new CompositionRoot();\r\nconst bootstrapResult = root.bootstrap();\r\nconst bootstrapOk = isOk(bootstrapResult);\r\n\r\n/* c8 ignore next -- Branch depends on Foundry UI notifications */\r\nif (!bootstrapOk) {\r\n  BootstrapErrorHandler.logError(bootstrapResult.error, {\r\n    phase: \"bootstrap\",\r\n    component: \"CompositionRoot\",\r\n    metadata: {\r\n      foundryVersion: tryGetFoundryVersion(),\r\n    },\r\n  });\r\n\r\n  // Check if error is due to old Foundry version\r\n  let isOldFoundryVersion = false;\r\n  /* c8 ignore next -- Requires Foundry version detection context */\r\n  if (\r\n    typeof bootstrapResult.error === \"string\" &&\r\n    bootstrapResult.error.includes(\"PORT_SELECTION_FAILED\")\r\n  ) {\r\n    const foundryVersion = tryGetFoundryVersion();\r\n    if (foundryVersion !== undefined && foundryVersion < 13) {\r\n      isOldFoundryVersion = true;\r\n      /* c8 ignore next -- Displays Foundry notification */\r\n      if (typeof ui !== \"undefined\" && ui?.notifications) {\r\n        ui.notifications.error(\r\n          `${MODULE_CONSTANTS.MODULE.NAME} ben√∂tigt mindestens Foundry VTT Version 13. ` +\r\n            `Ihre Version: ${foundryVersion}. Bitte aktualisieren Sie Foundry VTT.`,\r\n          { permanent: true }\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  // Show generic error notification (only if not old Foundry version)\r\n  /* c8 ignore next -- Displays Foundry notification */\r\n  if (!isOldFoundryVersion && typeof ui !== \"undefined\" && ui?.notifications) {\r\n    ui.notifications?.error(\r\n      `${MODULE_CONSTANTS.MODULE.NAME} failed to initialize. Check console for details.`,\r\n      { permanent: true }\r\n    );\r\n  }\r\n\r\n  // Soft abort: Don't proceed with initialization\r\n  // (no throw, no return - just don't call initializeFoundryModule)\r\n} else {\r\n  // Only initialize if bootstrap succeeded\r\n  initializeFoundryModule();\r\n}\r\n"],"names":["value","map","transform","getFallback","promise","description","ServiceLifecycle","SL","instance","LogLevel","result","fallback","message","v.object","v.string","v.optional","v.record","v.unknown","v.custom","entries","v.safeParse","v.array","game","document","ui","match","config"],"mappings":"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","x_google_ignoreList":[18]}