# Release Notes - Version 0.43.15

**Veröffentlichungsdatum:** 2025-12-12

## Hinzugefügt
- **MetricDefinition Interface**: Neues Interface für dynamische Metrik-Definitionen mit Reducer, Initialwert und Serializer ([Details](docs/refactoring/16-ocp-metrics-collector.md))
- **MetricDefinitionRegistry**: Neue Registry-Klasse für Verwaltung von Metrik-Definitionen mit Key-Kollisionsschutz ([Details](docs/refactoring/16-ocp-metrics-collector.md))
- **Default Metric Definitions**: Alle bestehenden Metriken als MetricDefinition-Einträge migriert (containerResolutions, resolutionErrors, cacheHits, cacheMisses, portSelections, portSelectionFailures, resolutionTimes) ([Details](docs/refactoring/16-ocp-metrics-collector.md))
- **createDefaultMetricDefinitionRegistry Factory**: Factory-Funktion für Standard-Metrik-Definition-Registry
- **OCP-Tests für MetricsCollector**: Tests für dynamische Metrik-Registrierung ohne Codeänderungen

## Geändert
- **MetricsCollector OCP-Refactoring**: MetricsCollector wurde nach Open/Closed Principle (OCP) refactored ([Details](docs/refactoring/16-ocp-metrics-collector.md))
- `MetricsCollector`: Verwendet jetzt generische `Map<string, MetricState>` statt fester Properties
- `MetricsCollector`: Interne Struktur basiert auf `MetricDefinitionRegistry` statt hartkodierter Metrik-Felder
- `MetricsCollector`: Neue Metriken können jetzt ausschließlich über Registry-Einträge ergänzt werden, ohne den Collector zu modifizieren
- `MetricsCollector`: Unterstützt jetzt Constructor-Injection für Registry (mit Default-Fallback)
- Snapshot/Persistence iterieren über registrierte Definitionen und sind damit erweiterbar
- Keine Breaking Changes: Public API bleibt unverändert, bestehende Funktionalität bleibt erhalten
- Backward Compatibility: `getRawMetrics()` konvertiert von generischer Map zu `IRawMetrics` Interface

## Fehlerbehebungen
- **Type-Coverage**: Entfernung von verbotenen `type-coverage:ignore` Direktiven in `MetricsCollector` und `MetricDefinitionRegistry` - Type Assertions wurden in separate Helper-Datei `metric-casts.ts` ausgelagert, wo sie erlaubt sind
- **Type-Coverage 100%**: Runtime-safe Cast-Funktionen in `src/infrastructure/observability/metrics-definition/metric-casts.ts` ausgelagert und in `type-coverage.json` global ausgenommen - Type-Coverage erreicht jetzt 100%
- **Test-Coverage**: Erweiterte Test-Suite für `MetricsCollector` um fehlende Branches abzudecken (Edge Cases für `getRawMetrics`, `applyRawMetrics`, `setMetricValue` mit fehlenden Metriken)
- **Test-Coverage metric-casts.ts**: Vollständige Test-Suite für `metric-casts.ts` erstellt - alle Edge Cases für `isValidMetricDefinition`, `castToMetricDefinition` und `castMetricValue` abgedeckt (100% Coverage)

## Bekannte Probleme
- Keine bekannten Probleme

## Upgrade-Hinweise
- Keine besonderen Maßnahmen erforderlich
